<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="webpack5, 听雨少年的博客">
    <meta name="description" content="Java,Spring,SpringBoot,Vue.js,Node.js,JUC,数据结构和算法,TypeScript,JavaScript">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>webpack5 | 听雨少年的博客</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="听雨少年的博客" type="application/atom+xml">
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">听雨少年的博客</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">听雨少年的博客</div>
        <div class="logo-desc">
            
            Java,Spring,SpringBoot,Vue.js,Node.js,JUC,数据结构和算法,TypeScript,JavaScript
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/maolovecoding/" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/maolovecoding/" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/16.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">webpack5</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/vue3/">
                                <span class="chip bg-color">vue3</span>
                            </a>
                        
                            <a href="/tags/ts/">
                                <span class="chip bg-color">ts</span>
                            </a>
                        
                            <a href="/tags/webpack/">
                                <span class="chip bg-color">webpack</span>
                            </a>
                        
                            <a href="/tags/loader/">
                                <span class="chip bg-color">loader</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/webpack/" class="post-category">
                                webpack
                            </a>
                        
                            <a href="/categories/webpack/vue/" class="post-category">
                                vue
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-11-05
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="webpack-学习之旅"><a href="#webpack-学习之旅" class="headerlink" title="webpack 学习之旅"></a>webpack 学习之旅</h1><h2 id="webpack-基础打包"><a href="#webpack-基础打包" class="headerlink" title="webpack 基础打包"></a>webpack 基础打包</h2><h3 id="认识-webpack"><a href="#认识-webpack" class="headerlink" title="认识 webpack"></a>认识 webpack</h3><p><strong>事实上随着前端的快速发展，目前前端的开发已经变的越来越复杂了：</strong></p>
<ol>
<li>比如开发过程中我们需要通过模块化的方式来开发；</li>
<li>比如也会使用一些高级的特性来加快我们的开发效率或者安全性，比如通过 ES6+、TypeScript 开发脚本逻辑， 通过 sass、less 等方式来编写 css 样式代码；</li>
<li>比如开发过程中，我们还希望实时的监听文件的变化来并且反映到浏览器上，提高开发的效率；</li>
<li>比如开发完成后我们还需要将代码进行压缩、合并以及其他相关的优化；</li>
<li>等等….</li>
</ol>
<p>但是对于很多的<strong>前端开发者</strong>来说，并不需要思考这些问题，日常的开发中根本就没有面临这些问题：</p>
<ol>
<li>这是因为目前前端开发我们通常都会直接使用三大框架来开发：Vue、React、Angular；</li>
<li>但是事实上，这三大框架的创建过程我们都是借助于脚手架（CLI）的；</li>
<li>事实上 Vue-CLI、create-react-app、Angular-CLI 都是基于 webpack 来帮助我们支持模块化、less、 TypeScript、打包优化等的；</li>
</ol>
<h4 id="脚手架依赖-webpack"><a href="#脚手架依赖-webpack" class="headerlink" title="脚手架依赖 webpack"></a>脚手架依赖 webpack</h4><p><strong>事实上我们上面提到的所有脚手架都是依赖于 webpack 的：</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726131437248.png" alt="image-20210726131437248"></p>
<h4 id="webpack-是什么"><a href="#webpack-是什么" class="headerlink" title="webpack 是什么"></a>webpack 是什么</h4><p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726131238052.png" alt="image-20210726131238052"></p>
<p><strong>我们先来看一下官方的解释：</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726131459921.png" alt="image-20210726131459921"></p>
<p>webpack 是一个<strong>静态的模块化打包工具</strong>，为现代的 JavaScript 应用程序；</p>
<p><strong>我们来对上面的解释进行拆解：</strong></p>
<ol>
<li><strong>打包 bundler</strong>：webpack 可以将帮助我们进行打包，所以它是一个打包工具</li>
<li><strong>静态的 static</strong>：这样表述的原因是我们最终可以将代码打包成最终的静态资源（部署到静态服务器）；</li>
<li><strong>模块化 module</strong>：webpack 默认支持各种模块化开发，ES Module、CommonJS、AMD 等；</li>
<li><strong>现代的 modern</strong>：我们前端说过，正是因为现代前端开发面临各种各样的问题，才催生了 webpack 的出现和发展；</li>
</ol>
<h4 id="Vue-项目加载的文件有哪些"><a href="#Vue-项目加载的文件有哪些" class="headerlink" title="Vue 项目加载的文件有哪些"></a>Vue 项目加载的文件有哪些</h4><p><strong>JavaScript 的打包：</strong></p>
<ul>
<li><p>将 ES6 转换成 ES5 的语法；</p>
</li>
<li><p>TypeScript 的处理，将其转换成 JavaScript；</p>
<p><strong>Css 的处理：</strong></p>
</li>
<li><p>CSS 文件模块的加载、提取；</p>
</li>
<li><p>Less、Sass 等预处理器的处理；</p>
</li>
</ul>
<p><strong>资源文件 img、font：</strong></p>
<ul>
<li>图片 img 文件的加载；</li>
<li>字体 font 文件的加载；</li>
</ul>
<p><strong>HTML 资源的处理：</strong></p>
<ul>
<li>打包 HTML 资源文件；</li>
<li>处理 vue 项目的 SFC 文件.vue 文件；</li>
</ul>
<h4 id="webpack-使用前提"><a href="#webpack-使用前提" class="headerlink" title="webpack 使用前提"></a>webpack 使用前提</h4><p>webpack 的官方文档是<a target="_blank" rel="noopener" href="https://webpack.js.org/">https://webpack.js.org/</a> ；</p>
<p>webpack 的中文官方文档是<a target="_blank" rel="noopener" href="https://webpack.docschina.org/">https://webpack.docschina.org/</a> ；</p>
<p>DOCUMENTATION：文档详情，也是我们最关注的</p>
<p><strong>Webpack 的运行是依赖 Node 环境的，所以我们电脑上必须有 Node 环境</strong></p>
<p>所以我们需要先安装 Node.js，并且同时会安装 npm；</p>
<p>Node 官方网站：<a target="_blank" rel="noopener" href="https://nodejs.org/">https://nodejs.org/</a></p>
<p><strong>推荐安装 LTS 版本，也就是稳定版</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726131906643.png" alt="image-20210726131906643"></p>
<h4 id="webpack-的安装"><a href="#webpack-的安装" class="headerlink" title="webpack 的安装"></a>webpack 的安装</h4><p>webpack 的安装目前分为两个：webpack、webpack-cli。</p>
<p>前期我们多以命令行的方式使用 webpack，因此 webpack-cli 也是必须安装的。但是在实际项目中，一般不需要安装 webpack-cli。</p>
<p><strong>那么它们是什么关系呢？</strong></p>
<ol>
<li>执行 webpack 命令，会执行 node_modules 下的.bin 目录下的 webpack；</li>
<li>webpack 在执行时是依赖 webpack-cli 的，如果没有安装就会报错；</li>
<li>而 webpack-cli 中代码执行时，才是真正利用 webpack 进行编译和打包的过程；</li>
<li>所以在安装 webpack 时，我们需要同时安装 webpack-cli（第三方的脚手架事实上是没有使用 webpack-cli 的，而是类似于自 己的 vue-service-cli 的东西）</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210725232410531.png" alt="image-20210725232410531"></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install webpack webpack-cli -g # -g 表示全局安装
npm install webpack webpack-cli -D # -D 表示局部安装<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210725232640075.png" alt="image-20210725232640075"></p>
<p>在命令行输入上面的命令，会默认安装最新的版本。如果没有报错则安装成功。</p>
<p>我们可以在命令行输入 <code>webpack -v</code>查看我们安装的版本。</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210725232812911.png" alt="image-20210725232812911"></p>
<h3 id="webpack-的打包方式"><a href="#webpack-的打包方式" class="headerlink" title="webpack 的打包方式"></a>webpack 的打包方式</h3><h4 id="1-默认打包"><a href="#1-默认打包" class="headerlink" title="1. 默认打包"></a>1. 默认打包</h4><p>我们可以通过 webpack 进行打包，之后运行打包之后的代码</p>
<p>在<strong>项目根目录下</strong>直接执行 webpack 命令；</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">webpack<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>只要没报错，就执行成功了。警告暂时我们可以先忽略</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726132343482.png" alt="image-20210726132343482"></p>
<p>我们发现：</p>
<p><strong>生成一个 dist 文件夹，里面存放一个 main.js 的文件</strong>，就是我们打包之后的文件：</p>
<ol>
<li>这个文件中的代码被压缩和丑化了；</li>
<li>另外我们发现代码中依然存在 ES6 的语法，比如箭头函数、const 等，这是因为默认情况下 webpack 并不清楚我们打包后的文 件是否需要转成 ES5 之前的语法，后续我们需要通过 babel 来进行转换和设置；</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726132601754.png" alt="image-20210726132601754"></p>
<p><strong>我们发现是可以正常进行打包的，但是有一个问题，webpack 是如何确定我们的入口的呢？</strong></p>
<ol>
<li>事实上，当我们运行 webpack 时，webpack 会查找当前目录下的 src/index.js 作为入口；</li>
<li>所以，如果当前项目中没有存在 src/index.js 文件，那么会报错</li>
</ol>
<p><strong>当然，我们也可以通过配置来指定入口和出口</strong></p>
<p>安装好局部的 webpack，但是我们又安装了全局的 webpack 了，这时候如果在命令行直接输入 webpack 命令进行打包。默认使用的还是全局安装的 webpack。</p>
<p><strong>如何使用局部的 webpack 进行打包呢？</strong></p>
<p>可以使用 <code>npx webpack</code><strong>使用该命令打包的时候就会使用局部的 webpack</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># 调用当前项目的webpack，并指定打包的入口文件和出口目录和文件
npx webpack --entry ./src/main.js --output-path ./build<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="2-创建局部的-webpack"><a href="#2-创建局部的-webpack" class="headerlink" title="2. 创建局部的 webpack"></a>2. 创建局部的 webpack</h4><p>前面我们直接执行 webpack 命令使用的是全局的 webpack，如果希望使用局部的可以按照下面的步骤来操作。</p>
<p>第一步：创建 package.json 文件，用于管理项目的信息、库依赖等</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm init -y # -y 表示按照默认参数进行初始化<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>第二步：安装局部的 webpack</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install webpack webpack-cli -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>第三步：使用局部的 webpack</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npx webpack # 会去调用node_moudles目录下bin里面的webpack目录<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>第四步：在 package.json 中创建 scripts 脚本，执行脚本打包即可</p>
<p><strong>虽然第三步也可以使用局部的 webpack 进行打包。但是我们一般很少使用</strong>。<em>我们可以在<code>package.json</code>文件里面的<code>script</code>属性里面配置</em></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"webpack"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>**然后执行 <code>npm run build</code>**目录进行打包</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm run build<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>会自动去我们的 node_modules 文件夹下面找命令，也就是局部的 webpack</p>
<h4 id="3-Webpack-配置文件"><a href="#3-Webpack-配置文件" class="headerlink" title="3. Webpack 配置文件"></a>3. Webpack 配置文件</h4><p>在通常情况下，webpack 需要打包的项目是非常复杂的，并且我们需要一系列的配置来满足要求，默认配置必然 是不可以的。我们可以在根目录下创建一个<strong>webpack.config.js</strong>文件，来作为<strong>webpack 的配置文件</strong>：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 配置webpack</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 导出配置必须使用commonjs规范。因为webpack是运行在nodejs环境上的</span>
<span class="token comment">// 读取导出的配置肯定是使用nodejs默认的规范的。</span>
<span class="token comment">// 如果想要使用ES6的规范进行导出，需要进行额外的配置。比较麻烦</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 入口 entry  打包文件时的入口文件</span>
  entry<span class="token operator">:</span> <span class="token string">"./src/index.js"</span><span class="token punctuation">,</span>
  <span class="token comment">// 出口 打包好文件存放的位置，路径</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// path属性 需要指定绝对路径</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"./build"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 打包后文件的名称</span>
    filename<span class="token operator">:</span> <span class="token string">"bundle.js"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>继续执行 webpack 命令，依然可以正常打包</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm run build<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="4-指定配置文件"><a href="#4-指定配置文件" class="headerlink" title="4. 指定配置文件"></a>4. 指定配置文件</h4><p>但是如果我们的配置文件并不是 webpack.config.js 的名字，而是其他的名字呢？</p>
<ol>
<li><p>比如我们将 webpack.config.js 修改成了 wk.config.js</p>
</li>
<li><p>这个时候我们可以通过 –config 来指定对应的配置文件；</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">wepack --config wk.config.js<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>但是每次这样执行命令来对源码进行编译，会非常繁琐，所以我们可以在 package.json 中增加一个新的脚本：</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726134001052.png" alt="image-20210726134001052"></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"srcipt"</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">"build"</span><span class="token operator">:</span><span class="token string">"wepack --config wk.config.js"</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p><strong>之后我们执行 <code>npm run build</code>来打包即可。</strong></p>
<h4 id="5-Webpack-的依赖图"><a href="#5-Webpack-的依赖图" class="headerlink" title="5. Webpack 的依赖图"></a>5. Webpack 的依赖图</h4><p>webpack 到底是如何对我们的项目进行打包的呢？</p>
<ol>
<li><p>事实上 webpack 在处理应用程序时，它会根据命令或者配置文件找到入口文件；</p>
</li>
<li><p>从入口开始，会生成一个 依赖关系图，这个依赖关系图会包含应用程序中所需的所有模块（比如.js 文件、css 文件、图片、字 体等）；</p>
</li>
<li><p>然后遍历图结构，打包一个个模块（根据文件的不同使用不同的 loader 来解析）；</p>
</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726134147625.png" alt="image-20210726134147625"></p>
<h3 id="webpack-打包其他文件"><a href="#webpack-打包其他文件" class="headerlink" title="webpack 打包其他文件"></a>webpack 打包其他文件</h3><p>这里我们创建一个 <code>element.js</code> 文件，以及一个 <code>index.css</code>文件。通过 JavaScript 创建了一个元素，并且希望给它设置一些样式；</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// element.js</span>

<span class="token keyword">import</span> <span class="token string">"../css/index.css"</span><span class="token punctuation">;</span>
<span class="token comment">// 创建一个div</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置样式</span>
div<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">"title1"</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">"title"</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"&lt;h2&gt;你好!!!!!!&lt;/h2&gt;"</span><span class="token punctuation">;</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">.title</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> aqua<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> bisque<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>执行编译打包命令（<code>npm run build</code>）时：</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726134628990.png" alt="image-20210726134628990"></p>
<h4 id="1-css-loader-的使用"><a href="#1-css-loader-的使用" class="headerlink" title="1. css-loader 的使用"></a>1. css-loader 的使用</h4><p>上面的错误信息告诉我们需要一个<strong>loader 来加载这个 css 文件</strong>，但是 loader 是什么呢？</p>
<ol>
<li>loader 可以用于对模块的源代码进行转换；</li>
<li>我们可以将 css 文件也看成是一个模块，我们是通过 import 来加载这个模块的；</li>
<li>在加载这个模块时，webpack 其实并不知道如何对其进行加载，我们必须制定对应的 loader 来完成这个功能；</li>
</ol>
<p>那么我们需要一个什么样的 loader 呢？</p>
<ol>
<li><p>对于加载 css 文件来说，我们需要一个可以读取 css 文件的 loader；</p>
</li>
<li><p>这个 loader 最常用的是 css-loader。</p>
</li>
</ol>
<p><strong>css-loader 的安装：</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install css-loader -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="css-loader-的使用方案"><a href="#css-loader-的使用方案" class="headerlink" title="css-loader 的使用方案"></a>css-loader 的使用方案</h5><p>如何使用这个 loader 来加载 css 文件呢？有三种方式：</p>
<ol>
<li>内联方式；</li>
<li>CLI 方式（webpack5 中不再使用）；</li>
<li>配置方式</li>
</ol>
<h6 id="内联方式"><a href="#内联方式" class="headerlink" title="内联方式"></a>内联方式</h6><p>内联方式使用较少，因为不方便管理；</p>
<p><strong>在引入的样式前加上使用的 loader，并且使用!分割</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 导入css</span>
<span class="token comment">// 内联样式指定加载文件时使用的loader (了解)</span>
<span class="token comment">// 语法： import 'loader!文件路径'  要注意loader后面有一个叹号 是用来分割加载器和文件的 必须有</span>
<span class="token keyword">import</span> <span class="token string">"css-loader!../css/index.css"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="CLI-方式"><a href="#CLI-方式" class="headerlink" title="CLI 方式"></a>CLI 方式</h6><ol>
<li>在 webpack5 的文档中已经没有了–module-bind；</li>
<li>实际应用中也比较少使用，因为不方便管理；</li>
</ol>
<h6 id="loader-配置方式-重点"><a href="#loader-配置方式-重点" class="headerlink" title="loader 配置方式(重点)"></a>loader 配置方式(重点)</h6><p><strong>配置方式表示的意思是在我们的 webpack.config.js 文件中写明配置信息：</strong></p>
<ol>
<li>module.rules 中允许我们配置多个 loader（因为我们也会继续使用其他的 loader，来完成其他文件的加载）；</li>
<li>这种方式可以更好的表示 loader 的配置，也方便后期的维护，同时也让你对各个 Loader 有一个全局的概览；</li>
</ol>
<p><strong>module.rules 的配置如下：</strong></p>
<ul>
<li>rules 属性对应的值是一个数组：[Rule]</li>
<li>数组中存放的是一个个的 Rule，Rule 是一个对象，对象中可以设置多个属性：<ul>
<li><strong>test 属性：</strong>用于对 resource（资源）进行匹配的，通常会设置成正则表达式；</li>
<li><strong>use 属性：</strong>对应的值时一个数组：[UseEntry]<ul>
<li>UseEntry 是一个对象，可以通过对象的属性来设置一些其他属性<ul>
<li>oader：必须有一个 loader 属性，对应的值是一个字符串；</li>
<li>options：可选的属性，值是一个字符串或者对象，值会被传入到 loader 中； Ø</li>
<li>query：目前已经使用 options 来替代；</li>
</ul>
</li>
<li>传递字符串（如：use: [ ‘style-loader’ ]）是 loader 属性的简写方式（如：use: [ { loader: ‘style-loader’} ]）；</li>
</ul>
</li>
<li><strong>loader 属性</strong>： Rule.use: [ { loader } ] 的简写。</li>
</ul>
</li>
</ul>
<p><strong>具体的相关配置如下展示：</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726135426942.png" alt="image-20210726135426942"></p>
<h4 id="2-style-loader"><a href="#2-style-loader" class="headerlink" title="2. style-loader"></a>2. style-loader</h4><p>我们已经可以通过 css-loader 来加载 css 文件了 。但是你会发现这个 css 在我们的代码中并没有生效（页面没有效果）。</p>
<p><strong>这是为什么呢？</strong></p>
<ol>
<li>因为 css-loader 只是负责将.css 文件进行解析，并不会将解析之后的 css 插入到页面中；</li>
<li>如果我们希望再完成插入 style 的操作，那么我们还需要另外一个 loader，就是 style-loader；</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726135858149.png" alt="image-20210726135858149"></p>
<p><strong>安装 style-loader</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm i style-loader -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="配置-style-loader"><a href="#配置-style-loader" class="headerlink" title="配置 style-loader"></a>配置 style-loader</h5><p>那么我们应该如何使用 style-loader：</p>
<ol>
<li>在配置文件中，添加 style-loader；</li>
<li>注意：因为 loader 的执行顺序是从右向左（或者说从下到上，或者说从后到前的），所以我们需要将 styleloader 写到 css-loader 的前面</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726135651286.png" alt="image-20210726135651286"></p>
<p>重新执行编译 npm run build，可以发现打包后的 css 已经生效了：</p>
<ol>
<li>当前目前我们的 css 是通过页内样式的方式添加进来的；</li>
<li>后续我们也会讲如何将 css 抽取到单独的文件中，并且进行压缩等操作；</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726135948555.png" alt="image-20210726135948555"></p>
<h4 id="3-如何处理-less-文件"><a href="#3-如何处理-less-文件" class="headerlink" title="3. 如何处理 less 文件"></a>3. 如何处理 less 文件</h4><p>在我们开发中，我们可能会使用 less、sass、stylus 的预处理器来编写 css 样式，效率会更高。</p>
<p>那么，如何可以让我们的环境支持这些<strong>预处理器</strong>呢？</p>
<p>首先我们需要确定，less、sass 等编写的 css 需要通过工具转换成普通的 css；</p>
<p>比如我们编写如下的 less 样式：</p>
<pre class="line-numbers language-less" data-language="less"><code class="language-less"><span class="token variable">@bgColor<span class="token punctuation">:</span></span> #aca<span class="token punctuation">;</span>
<span class="token variable">@textDecoration<span class="token punctuation">:</span></span> underline<span class="token punctuation">;</span>

<span class="token selector">.title</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token variable">@bgColor</span><span class="token punctuation">;</span>
  <span class="token property">text-decoration</span><span class="token punctuation">:</span> <span class="token variable">@textDecoration</span><span class="token punctuation">;</span>
  <span class="token property">user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="Less-工具处理"><a href="#Less-工具处理" class="headerlink" title="Less 工具处理"></a>Less 工具处理</h5><p>我们可以使用 less 工具来完成它的编译转换：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install less -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>执行如下命令：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npx lessc ./src/less/index.less index.css<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726140253295.png" alt="image-20210726140253295"></p>
<h5 id="less-loader"><a href="#less-loader" class="headerlink" title="less-loader"></a>less-loader</h5><p>但是在项目中我们会编写大量的 css，它们如何可以自动转换呢？</p>
<p>这个时候我们就可以使用 less-loader，来自动使用 less 工具转换 less 到 css；</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install less-loader -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>配置 webpack.config.js</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726140357318.png" alt="image-20210726140357318"></p>
<p>执行 npm run build less 就可以自动转换成 css，并且页面也会生效了</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726140554154.png" alt="image-20210726140554154"></p>
<h4 id="4-PostCSS-工具"><a href="#4-PostCSS-工具" class="headerlink" title="4. PostCSS 工具"></a>4. PostCSS 工具</h4><h5 id="1-认识-postcss"><a href="#1-认识-postcss" class="headerlink" title="1. 认识 postcss"></a>1. 认识 postcss</h5><ol>
<li><p>什么是 PostCSS 呢？</p>
<ul>
<li>PostCSS 是一个通过 JavaScript 来转换样式的工具；</li>
<li>这个工具可以帮助我们进行一些 CSS 的转换和适配，比如自动添加浏览器前缀、css 样式的重置；</li>
<li>但是实现这些功能，我们需要借助于 PostCSS 对应的插件；</li>
</ul>
</li>
<li><p>如何使用 PostCSS 呢？主要就是两个步骤：</p>
<ol>
<li>第一步：查找 PostCSS 在构建工具中的扩展，比如 webpack 中的 postcss-loader；</li>
<li>第二步：选择可以添加你需要的 PostCSS 相关的插件；</li>
</ol>
</li>
</ol>
<h5 id="2-命令行使用-postcss"><a href="#2-命令行使用-postcss" class="headerlink" title="2. 命令行使用 postcss"></a>2. 命令行使用 postcss</h5><p>当然，我们能不能也直接在终端使用 PostCSS 呢？</p>
<p>也是可以的，但是我们需要单独安装一个工具 postcss-cli；</p>
<p>我们可以安装一下它们：postcss、postcss-cli：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install postcss postcss-cli -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>我们编写一个需要添加前缀的 css：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://autoprefixer.github.io/">https://autoprefixer.github.io/</a></li>
<li>我们可以在上面的网站中查询一些添加 css 属性的样式</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726140956883.png" alt="image-20210726140956883"></p>
<h5 id="3-插件-autoprefixer"><a href="#3-插件-autoprefixer" class="headerlink" title="3. 插件 autoprefixer"></a>3. 插件 autoprefixer</h5><p>因为我们需要添加前缀，所以要安装 autoprefixer：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install autoprefixer -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>直接使用使用 postcss 工具，并且指定使用 autoprefixer</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npx postcss --use autoprefixer -o end.css ./src/css/style.css<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>转化之后的 css 样式如下：</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726141124302.png" alt="image-20210726141124302"></p>
<h5 id="4-postcss-loader-重点"><a href="#4-postcss-loader-重点" class="headerlink" title="4. postcss-loader(重点)"></a>4. postcss-loader(重点)</h5><p>真实开发中我们必然不会直接使用命令行工具来对 css 进行处理，而是可以借助于构建工具：</p>
<p>在 webpack 中使用<strong>postcss</strong>就是使用<strong>postcss-loader</strong>来处理的；</p>
<p>我们来安装 postcss-loader：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install postcss-loader -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>我们修改加载 less 的 loader:</p>
<p><strong>注意：</strong>因为 postcss 需要有对应的插件才会起效果，所以我们需要配置它的 plugin；</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726141409491.png" alt="image-20210726141409491"></p>
<h5 id="5-单独的-postcss-配置文件"><a href="#5-单独的-postcss-配置文件" class="headerlink" title="5. 单独的 postcss 配置文件"></a>5. 单独的 postcss 配置文件</h5><p>当然，我们也可以将这些配置信息放到一个单独的文件中进行管理：</p>
<p><strong>在根目录下创建 postcss.config.js</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 配置plugins 插件</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"autoprefixer"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726141556045.png" alt="image-20210726141556045"></p>
<h5 id="6-postcss-preset-env"><a href="#6-postcss-preset-env" class="headerlink" title="6. postcss-preset-env"></a>6. postcss-preset-env</h5><p>事实上，在配置 postcss-loader 时，我们配置插件并不需要使用 autoprefixer。</p>
<p>我们可以使用另外一个插件：postcss-preset-env</p>
<ol>
<li>postcss-preset-env 也是一个 postcss 的插件；</li>
<li>它可以帮助我们将一些现代的 CSS 特性，转成大多数浏览器认识的 CSS，并且会根据目标浏览器或者运行时环境 添加所需的 polyfill；</li>
<li>也包括会自动帮助我们添加 autoprefixer（所以相当于已经内置了 autoprefixer）；</li>
</ol>
<p>首先，我们需要<strong>安装 postcss-preset-env</strong>：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install postcss-preset-env -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>之后，我们直接修改掉之前的 autoprefixer 即可：</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726141730953.png" alt="image-20210726141730953"></p>
<p><strong>注意：我们在使用某些 postcss 插件时，也可以直接传入字符串</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210726141811408.png" alt="image-20210726141811408"></p>
<h3 id="webpack-config-js-本次配置展示"><a href="#webpack-config-js-本次配置展示" class="headerlink" title="webpack.config.js 本次配置展示"></a>webpack.config.js 本次配置展示</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 配置webpack</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">"./src/index.js"</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"./build"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">"bundle.js"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 配置打包时所有模块的配置 在 module属性下配置</span>
  <span class="token comment">// 一个文件也看成一个模块</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 模块打包时的规则</span>
    <span class="token comment">// 不同文件有不同的规则，所以规则是一个数组，可以配置不同文件不同的规则</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 配置打包css文件（模块）时的规则</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// 指定文件后缀  正则表达式</span>
        <span class="token comment">// 指定loader (语法糖)</span>
        <span class="token comment">// loader: 'css-loader'</span>

        <span class="token comment">// 只有一个loader时可以不使用数组，直接指定就行</span>
        <span class="token comment">// use: 'css-loader'</span>
        <span class="token comment">// 没有其他参数时：只有loader时，直接使用数组，里面放的默认都是loader</span>
        <span class="token comment">// use: ['css-loader']</span>
        <span class="token comment">// 如果当前使用的loader有相关的其他配置，需要在数组里面将元素指定为对象</span>
        <span class="token comment">//use: [</span>
        <span class="token comment">// 多个loader就是多个对象，一个对象里面一个loader，以及loader的配置 options</span>
        <span class="token comment">//{ loader: 'css-loader', options: { modules: true } }</span>
        <span class="token comment">//]</span>

        <span class="token comment">// 多个loader的加载顺序 从后往前（最先加载数组最后一个loader）</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"style-loader"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> loader<span class="token operator">:</span> <span class="token string">"css-loader"</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 处理less文件的配置</span>
      <span class="token comment">// postcss 工具 增加浏览器前缀 postcss-loader</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">"style-loader"</span><span class="token punctuation">,</span>
          <span class="token string">"css-loader"</span><span class="token punctuation">,</span>
          <span class="token comment">// 如果我们指定了postcss的配置文件（默认情况下叫做 postcss.config.js）</span>
          <span class="token comment">// 则不需要再这里指定相关的配置了，直接写postcss-loader就可以了</span>
          <span class="token comment">// 优先读取本文件里面的配置，然后去 postcss.config.js 配置文件里面读取导出的配置</span>
          <span class="token string">"postcss-loader"</span><span class="token punctuation">,</span>
          <span class="token comment">/* {
            loader: 'postcss-loader',
            // 配置postcss-loader的加载时的参数，选项
            options: {
              postcssOptions: {
                // 插件可以指定多个 数组形式
                plugins: [
                  // 导入使用的插件 使用require(插件)
                  require('autoprefixer')
                ]
              }
            }
          }, */</span>
          <span class="token string">"less-loader"</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="postcss-config-js-本次配置展示"><a href="#postcss-config-js-本次配置展示" class="headerlink" title="postcss.config.js 本次配置展示"></a>postcss.config.js 本次配置展示</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// postcss 的配置</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 配置plugins 插件</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 实际开发中，我们很少使用 autoprefixer 这个插件</span>
    <span class="token comment">// 我们会使用 更好的插件 postcss-prefix-env</span>
    <span class="token comment">// require('autoprefixer')</span>
    <span class="token comment">// 这个插件的功能更强，切也具有 autoprefixer 插件的功能</span>
    <span class="token comment">// 可以理解为具备了 autoprefixer 的功能</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"postcss-preset-env"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Webpack-打包其他资源"><a href="#Webpack-打包其他资源" class="headerlink" title="Webpack 打包其他资源"></a>Webpack 打包其他资源</h2><p><strong>加载图片案例准备</strong></p>
<p>为了演示我们项目中可以加载图片，我们需要在项目中使用图片，比较常见的使用图片的方式是两种：</p>
<ol>
<li>img 元素，设置 src 属性；</li>
<li>其他元素（比如 div），设置 background-image 的 css 属性；</li>
</ol>
<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">.image-bg</span> <span class="token punctuation">{</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">"../image/3.jpg"</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 导入背景图片的样式</span>
<span class="token keyword">import</span> <span class="token string">"../css/index.css"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> myImg <span class="token keyword">from</span> <span class="token string">"../image/1.JPG"</span><span class="token punctuation">;</span>
<span class="token comment">// 设置背景图片</span>
<span class="token keyword">const</span> bgDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bgDiv<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">"image-bg"</span><span class="token punctuation">;</span>

<span class="token comment">// 设置img标签的src属性</span>
<span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> myImg<span class="token punctuation">;</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>bgDiv<span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>这个时候，打包会报错</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728191425399.png" alt="image-20210728191425399"></p>
<p>报错了，并且提示我们可以需要一个 loader 来解决图片的问题。</p>
<h3 id="file-loader"><a href="#file-loader" class="headerlink" title="file-loader"></a>file-loader</h3><p>要处理 jpg、png 等格式的图片，我们也需要有对应的<strong>loader：file-loader</strong></p>
<ol>
<li>file-loader 的作用就是帮助我们处理 import/require()方式引入的一个文件资源，并且会将它放到我们输出的文 件夹中；</li>
<li>当然我们待会儿可以学习如何修改它的名字和所在文件夹；</li>
</ol>
<p><strong>安装 file-loader：</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm i file-loader -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>配置处理图片的 Rule：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 配置打包图片资源的规则</span>
<span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(jpg|png|jpeg|JPG)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token string">'file-loader'</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728191711488.png" alt="image-20210728191711488"></p>
<p>我们会发现图片也被打包了。</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728191748775.png" alt="image-20210728191748775"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728191838557.png" alt="image-20210728191838557"></p>
<h4 id="文件的命名规则"><a href="#文件的命名规则" class="headerlink" title="文件的命名规则"></a>文件的命名规则</h4><p>有时候我们处理后的<strong>文件名</strong>称按照一定的规则进行显示：</p>
<ul>
<li>比如保留原来的文件名、扩展名，同时为了防止重复，包含一个 hash 值等；</li>
</ul>
<p>这个时候我们可以使用 PlaceHolders 来完成，webpack 给我们提供了大量的 PlaceHolders 来显示不同的内容：</p>
<ol>
<li> <a target="_blank" rel="noopener" href="https://webpack.js.org/loaders/file-loader/#placeholders">https://webpack.js.org/loaders/file-loader/#placeholders</a></li>
<li> 我们可以在文档中查阅自己需要的 placeholder；</li>
</ol>
<p>我们这里介绍几个最常用的 placeholder：</p>
<ul>
<li>**[ext]**： 处理文件的扩展名；</li>
<li>**[name]**：处理文件的名称；</li>
<li>**[hash]**：文件的内容，使用 MD4 的散列函数处理，生成的一个 128 位的 hash 值（32 个十六进制）；</li>
<li>[contentHash]：在 file-loader 中和[hash]结果是一致的（在 webpack 的一些其他地方不一样，后面会讲到）；</li>
<li>**[hash:length]**：截图 hash 的长度，默认 32 个字符太长了；</li>
<li>**[path]**：文件相对于 webpack 配置文件的路径；</li>
</ul>
<h4 id="设置文件的名称"><a href="#设置文件的名称" class="headerlink" title="设置文件的名称"></a>设置文件的名称</h4><p>那么我们可以按照如下的格式编写：<strong>这个也是 vue 的写法；</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(jpg|png|jpeg|JPG)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
          <span class="token comment">// file-loader的参数配置</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// 打包后图片文件所在的路径</span>
            <span class="token comment">// outputPath: 'image',</span>
            <span class="token comment">// 打包后生成文件的名称</span>
            <span class="token comment">// [name] 源文件的名称（不含拓展名）</span>
            <span class="token comment">// 我们发现不写配置时，文件的名称过长（且文件名是通过hash算法算出来的，为了防止重名）</span>
            <span class="token comment">// [hash:6] 默认生成文件名称的hash算法，32位，取前六位</span>
            <span class="token comment">// [ext] 使用原来文件的拓展名</span>
            <span class="token comment">// name: '[name]_[hash:6].[ext]'</span>

            <span class="token comment">// 当然：我们也可以把图片存放的路径和图片名称合在一起</span>
            name<span class="token operator">:</span> <span class="token string">'image/[name]-[hash:6].[ext]'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728192329730.png" alt="image-20210728192329730"></p>
<h4 id="设置文件的存放路径"><a href="#设置文件的存放路径" class="headerlink" title="设置文件的存放路径"></a>设置文件的存放路径</h4><p>当然，我们刚才通过 img/ 已经设置了文件夹，这个也是 vue、react 脚手架中常见的设置方式：</p>
<ol>
<li>其实按照这种设置方式就可以了；</li>
<li>当然我们也可以通过<strong>outputPath</strong>来设置输出的文件夹；</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728192445432.png" alt="image-20210728192445432"></p>
<h3 id="url-loader"><a href="#url-loader" class="headerlink" title="url-loader"></a>url-loader</h3><p><strong>url-loader 和 file-loader</strong>的工作方式是相似的，但是可以将较小的文件，转成 base64 的 URI。</p>
<p><strong>安装 url-loader：</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm i url-loader -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(jpe?g|JPG|png)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'image/[name]-[hash:6].[ext]'</span><span class="token punctuation">,</span>
            <span class="token comment">// 设置图片大小的限制，只有小于多少kb的图片我们才会转为base64格式</span>
            <span class="token comment">// 如果大于这个限制 我们就不会转为base64格式。而是继续采用上面的path和name的形式打包，还是保持图片的形式不变</span>
            limit<span class="token operator">:</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token comment">// 小于100kb的文件才会转为base64格式</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728192652383.png" alt="image-20210728192652383"></p>
<p><strong>显示结果是一样的，并且图片可以正常显示；</strong></p>
<p>但是在 dist 文件夹中，我们会看不到 <strong>大于 100kb</strong> 图片文件：</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728192839738.png" alt="image-20210728192839738"></p>
<ol>
<li>这是因为我的两张图片的大小分别是 38kb 和 129kb；</li>
<li>默认情况下 url-loader 会将所有的图片文件转成 base64 编码。但是配置了 limit 以后就可以限制小于多少 kb 的图片才会转为 base64 格式。</li>
</ol>
<p><strong>可以看见 bundle.js 文件里面的确有 base64 格式的字符串</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728193159584.png" alt="image-20210728193159584"></p>
<h3 id="url-loader-的-limit"><a href="#url-loader-的-limit" class="headerlink" title="url-loader 的 limit"></a>url-loader 的 limit</h3><p>但是开发中我们往往是小的图片需要转换，但是<strong>大的图片直接使用图片即可</strong></p>
<ol>
<li>这是因为小的图片转换 base64 之后可以和页面一起被请求，减少不必要的请求过程；</li>
<li>而大的图片也进行转换，反而会影响页面的请求速度；</li>
</ol>
<p>那么，我们如何可以<strong>限制哪些大小的图片</strong>转换和不转换呢？</p>
<ol>
<li>url-loader 有一个 options 属性 limit，可以用于设置转换的限制；</li>
<li>下面的代码 38kb 的图片会进行 base64 编码，而 129kb 的不会；</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728193333744.png" alt="image-20210728193333744"></p>
<h3 id="asset-module-type"><a href="#asset-module-type" class="headerlink" title="asset module type"></a>asset module type</h3><h4 id="认识-asset-module-type"><a href="#认识-asset-module-type" class="headerlink" title="认识 asset module type"></a>认识 asset module type</h4><p><strong>我们当前使用的 webpack 版本是 webpack5：</strong></p>
<ol>
<li>在 webpack5 之前，加载这些资源我们需要使用一些 loader，比如<strong>raw-loader 、url-loader、file-loader；</strong></li>
<li>在 webpack5 开始，我们可以直接使用<strong>资源模块类型</strong>（asset module type），来替代上面的这些 loader；</li>
</ol>
<p><strong>资源模块类型(asset module type)，通过添加 4 种新的模块类型，来替换所有这些 loader：</strong></p>
<ol>
<li><strong>asset/resource</strong> ：发送一个单独的文件并导出 URL。之前通过使用 file-loader 实现；</li>
<li><strong>asset/inline</strong> ：导出一个资源的 data URI。之前通过使用 url-loader 实现；</li>
<li><strong>asset/source</strong> ：导出资源的源代码。之前通过使用 raw-loader 实现；</li>
<li><strong>asset</strong>： 在导出一个 data URI 和发送一个单独的文件之间自动选择。之前通过使用 url-loader，并且配置资源体 积限制实现；</li>
</ol>
<h4 id="asset-module-type-的使用"><a href="#asset-module-type-的使用" class="headerlink" title="asset module type 的使用"></a>asset module type 的使用</h4><p>比如加载图片，我们可以使用下面的方式：</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728193636774.png" alt="image-20210728193636774"></p>
<p><strong>发现依然打包成功！</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728193748026.png" alt="image-20210728193748026"></p>
<p><strong>但是，如何可以自定义文件的输出路径和文件名呢？</strong></p>
<p>方式一：修改 output，添加 assetModuleFilename 属性； <strong>（了解即可）</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728193854459.png" alt="image-20210728193854459"></p>
<p>方式二：在 Rule 中，添加一个 generator 属性，并且设置 filename；</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(JPG|jpe?g|png)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token comment">// 这里不在使用use属性 而是type属性</span>
        <span class="token comment">// 使用asset/resource 来代替 file-loader</span>
        <span class="token comment">// type:'asset/resource'</span>

        <span class="token comment">// 比较常用的我们一般直接写成 asset</span>
        type<span class="token operator">:</span> <span class="token string">'asset'</span><span class="token punctuation">,</span>
        <span class="token comment">// 下面的配置也可以放在 output里面（了解）</span>
        <span class="token comment">// generator属性 生成 也就是打包后的图片存放时相关的配置</span>
        generator<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 配置图片名称和图片位置</span>
          <span class="token comment">// 这里的 [ext] 拿到的文件拓展名包含 .</span>
          filename<span class="token operator">:</span> <span class="token string">'image/[name]-[hash:6][ext]'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728194023352.png" alt="image-20210728194023352"></p>
<h4 id="url-loader-的-limit-效果"><a href="#url-loader-的-limit-效果" class="headerlink" title="url-loader 的 limit 效果"></a>url-loader 的 limit 效果</h4><p>我们需要两个步骤来实现：</p>
<ol>
<li>将 type 必须使用 asset 属性值；</li>
<li>添加一个 parser 属性，并且制定 dataUrl 的条件，添加 maxSize 属性；</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(JPG|jpe?g|png)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token comment">// 比较常用的我们一般直接写成 asset</span>
        type<span class="token operator">:</span> <span class="token string">'asset'</span><span class="token punctuation">,</span>
        <span class="token comment">// 配置相关的asset参数 使用parser属性</span>
        parser<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 数据url条件</span>
          dataUrlCondition<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// 最大不超过多少kb的图片 我们转为 base64格式</span>
            maxSize<span class="token operator">:</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token number">1024</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        generator<span class="token operator">:</span> <span class="token punctuation">{</span>
          filename<span class="token operator">:</span> <span class="token string">'image/[name]-[hash:6][ext]'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728194251709.png" alt="image-20210728194251709"></p>
<p><strong>发现打包的只有一个图片文件了。较小的那个已经转为 base64 格式了</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728194347840.png" alt="image-20210728194347840"></p>
<h3 id="加载字体文件"><a href="#加载字体文件" class="headerlink" title="加载字体文件"></a>加载字体文件</h3><p>如果我们需要使用某些<strong>特殊的字体或者字体图标</strong>，那么我们会引入很多字体相关的文件，这些文件的处理也是一样 的</p>
<p><strong>首先，我从阿里图标库中下载了几个字体图标：</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728195048166.png" alt="image-20210728195048166"></p>
<p><strong>然后在 font.js 里面引入</strong>，并设置一个 <code>i</code>标签用于显示字体图标</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 引入并使用字体图标</span>

<span class="token comment">// 加载字体图标的文件</span>
<span class="token keyword">import</span> <span class="token string">"../font/iconfont.css"</span><span class="token punctuation">;</span>

<span class="token comment">// i标签</span>
<span class="token keyword">const</span> i <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
i<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">"iconfont icon-ashbin"</span><span class="token punctuation">;</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>然后我们开始打包</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728195219912.png" alt="image-20210728195219912"></p>
<p><strong>毫无疑问，必然报错，因为我们使用了 webpack 并不认识的模块。并且 webpack 也提醒我们需要使用一个 loader 来解决。</strong></p>
<h4 id="字体的打包"><a href="#字体的打包" class="headerlink" title="字体的打包"></a>字体的打包</h4><p>这个时候打包会报错，因为<strong>无法正确的处理 eot、ttf、woff 等文件</strong>：</p>
<p>我们可以选择使用<strong>file-loader</strong>来处理，也可以选择直接使用<strong>webpack5 的资源模块类型</strong>来处理；</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 配置字体和字体图标等文件打包时的规则</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(eot|ttf|woff2?)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span><span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span><span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'font/[name]-[hash:6].[ext]'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>打包之后，发现不会报错，字体图标正常显示。</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728200328258.png" alt="image-20210728200328258"></p>
<p><strong>使用 webpack5 提供的资源模块类型也可以。</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 也可以使用webpack提供的资源模块类型</span>
<span class="token punctuation">{</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(eot|ttf|woff2?)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">'asset/resource'</span><span class="token punctuation">,</span>
    generator<span class="token operator">:</span><span class="token punctuation">{</span>
        filename<span class="token operator">:</span> <span class="token string">'font/[name]-[hash:6][ext]'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="webpack-的-plugin"><a href="#webpack-的-plugin" class="headerlink" title="webpack 的 plugin"></a>webpack 的 plugin</h3><h4 id="认识-plugin"><a href="#认识-plugin" class="headerlink" title="认识 plugin"></a>认识 plugin</h4><p>Webpack 的另一个核心是 Plugin，官方有这样一段对 Plugin 的描述：</p>
<p><strong>While loaders are used to transform certain types of modules, plugins can be leveraged to perform a wider range of tasks like bundle optimization, asset management and injection of environment variables.</strong></p>
<p>上面表达的含义翻译过来就是：</p>
<ol>
<li>Loader 是用于<strong>特定的模块类型进行转换</strong>；</li>
<li>Plugin 可以用于<strong>执行更加广泛的任务</strong>，比如打包优化、资源管理、环境变量注入等；</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728205205354.png" alt="image-20210728205205354"></p>
<h4 id="CleanWebpackPlugin"><a href="#CleanWebpackPlugin" class="headerlink" title="CleanWebpackPlugin"></a>CleanWebpackPlugin</h4><p>前面我们演示的过程中，每次修改了一些配置，重新打包时，都需要手动删除 dist 文件夹：</p>
<p>我们可以借助于一个插件来帮助我们完成，这个插件就是<strong>CleanWebpackPlugin；</strong></p>
<p><strong>首先，我们先安装这个插件：</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm i clean-webpack-plugin -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>之后在插件中配置：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"clean-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 提供 plugins属性来配置插件</span>
  <span class="token comment">// plugins属性是数组，数组元素是一个个的插件对象</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728205459482.png" alt="image-20210728205459482"></p>
<p><strong>然后可以发现每次都会帮我们把上次打包的文件夹先删除，然后在进行重新打包。</strong></p>
<h4 id="HtmlWebpackPlugin"><a href="#HtmlWebpackPlugin" class="headerlink" title="HtmlWebpackPlugin"></a>HtmlWebpackPlugin</h4><p>另外还有一个<strong>不太规范</strong>的地方：</p>
<ol>
<li>我们的 HTML 文件是编写在根目录下的，而最终打包的 dist 文件夹中是没有 index.html 文件的。</li>
<li>在进行项目部署的时，必然也是需要有对应的入口文件 index.html；</li>
<li>所以我们也需要对 index.html 进行打包处理；</li>
</ol>
<p>对 HTML 进行打包处理我们可以使用另外一个插件：<strong>HtmlWebpackPlugin；</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm i html-webpack-plugin -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728205744529.png" alt="image-20210728205744529"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728205754385.png" alt="image-20210728205754385"></p>
<h5 id="生成-index-html-分析"><a href="#生成-index-html-分析" class="headerlink" title="生成 index.html 分析"></a>生成 index.html 分析</h5><p>我们会发现，现在自动在 build 文件夹中，生成了一个<strong>index.html</strong>的文件：</p>
<p>该文件中也自动添加了我们打包的 bundle.js 文件；</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728210054115.png" alt="image-20210728210054115"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728205905823.png" alt="image-20210728205905823"></p>
<p><strong>这个文件是如何生成的呢？</strong></p>
<ol>
<li><strong>默认情况</strong>下是根据<strong>ejs 的一个模板</strong>来生成的；</li>
<li>在 html-webpack-plugin 的源码中，有一个 default_index.ejs 模块；</li>
</ol>
<h5 id="自定义-HTML-模板"><a href="#自定义-HTML-模板" class="headerlink" title="自定义 HTML 模板"></a>自定义 HTML 模板</h5><p>如果我们想在自己的模块中加入一些比较特别的内容：</p>
<ol>
<li><p>比如添加一个 noscript 标签，在用户的 JavaScript 被关闭时，给予响应的提示；</p>
</li>
<li><p>比如在开发 vue 或者 react 项目时，我们需要一个可以挂载后续组件的根标签</p>
<p>；</p>
</li>
</ol>
<p><strong>这个我们需要一个属于自己的 index.html 模块：</strong></p>
<p><strong>下面是模板代码（使用 Vue-cli 脚手架开发时的默认的模板就是这个）</strong></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>IE=edge<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width,initial-scale=1.0<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&lt;%= BASE_URL %&gt;favicon.ico<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>&lt;%= htmlWebpackPlugin.options.title %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>noscript</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span>
        <span class="token punctuation">&gt;</span></span>We're sorry but &lt;%= htmlWebpackPlugin.options.title %&gt; doesn't work
        properly without JavaScript enabled. Please enable it to
        continue.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span>
      <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>noscript</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- built files will be auto injected --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>但是：使用这个模板直接进行打包的时候：会发现打包失败！！（使用 html-webpack-plugin 插件的时候需要指定该模板）</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728211538093.png" alt="image-20210728211538093"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728212035161.png" alt="image-20210728212035161"></p>
<h5 id="自定义模板数据填充"><a href="#自定义模板数据填充" class="headerlink" title="自定义模板数据填充"></a>自定义模板数据填充</h5><p>上面的代码中，会有一些类似这样的语法**&lt;% 变量 %&gt;**，这个是 EJS 模块填充数据的方式。</p>
<p>在配置 HtmlWebpackPlugin 时，我们可以添加如下配置：</p>
<ol>
<li><strong>template</strong>：指定我们要使用的模块所在的路径；</li>
<li><strong>title</strong>：在进行 htmlWebpackPlugin.options.title 读取时，就会读到该信息；</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728212132479.png" alt="image-20210728212132479"></p>
<p><strong>但是，我们会发现，即使配置了模板啊，标题啊，仍然打包还是报错。</strong></p>
<p>不要着急，我们可以使用 webpack 内置的一个插件来进行解决。</p>
<h4 id="DefinePlugin"><a href="#DefinePlugin" class="headerlink" title="DefinePlugin"></a>DefinePlugin</h4><h5 id="DefinePlugin-的介绍"><a href="#DefinePlugin-的介绍" class="headerlink" title="DefinePlugin 的介绍"></a>DefinePlugin 的介绍</h5><p>我们上面指定了模板以后，发现仍然还是报错。报错的原因是什么呢？</p>
<p><strong>因为在我们的模块中还使用到一个 BASE_URL 的常量：</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728212410783.png" alt="image-20210728212410783"></p>
<p>这是因为在编译 template 模块时，有一个<strong>BASE_URL</strong>：</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&lt;%= BASE_URL %&gt;favicon.ico<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>但是我们并没有设置过这个常量值，所以会出现没有定义的错误；</p>
<p>这个时候我们可以使用<strong>DefinePlugin 插件</strong>；</p>
<h5 id="DefinePlugin-的使用"><a href="#DefinePlugin-的使用" class="headerlink" title="DefinePlugin 的使用"></a>DefinePlugin 的使用</h5><p>DefinePlugin 允许在编译时创建配置的<strong>全局常量</strong>，是一个 webpack 内置的插件（不需要单独安装）：</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728213427918.png" alt="image-20210728213427918"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728213438757.png" alt="image-20210728213438757"></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 导入 DefinePlugin 插件 解决常量 BASE_URL 的问题</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> DefinePlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 提供 plugins属性来配置插件</span>
  <span class="token comment">// plugins属性是数组，数组元素是一个个的插件对象</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 使用 DefinePlugin 插件来定义 常量</span>
    <span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token constant">BASE_URL</span><span class="token operator">:</span> <span class="token string">"'./'"</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这个时候，编译 template 就可以正确的编译了，会读取到<strong>BASE_URL</strong>的值；</p>
<h5 id="DefinePlugin-的注意点"><a href="#DefinePlugin-的注意点" class="headerlink" title="DefinePlugin 的注意点"></a>DefinePlugin 的注意点</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// BASE_URL 会根据后面给的属性值 去本文件上下文中找这个变量</span>
  <span class="token comment">// 比如我这里给的是字符串 "filepath"</span>
  <span class="token comment">// 也会去上下文中找叫做 filepath 的变量</span>
  <span class="token comment">// 如果我们想直接给一个字符串的值</span>
  <span class="token comment">// 我们需要在双引号里面嵌套单引号赋值</span>
  <span class="token comment">// 当然 单引号里面嵌套双引号赋值也是可以的</span>
  <span class="token comment">// BASE_URL: "filepath",</span>
  <span class="token constant">BASE_URL</span><span class="token operator">:</span> <span class="token string">"'./'"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="CopyWebpackPlugin"><a href="#CopyWebpackPlugin" class="headerlink" title="CopyWebpackPlugin"></a>CopyWebpackPlugin</h3><p>在 vue 的打包过程中，如果我们将一些文件放到 public 的目录下，那么这个目录会被复制到 dist 文件夹中。这个复制的功能，我们可以使用 CopyWebpackPlugin 来完成；</p>
<p><strong>安装 CopyWebpackPlugin 插件：</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm i copy-webpack-plugin -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>接下来配置 CopyWebpackPlugin 即可：</strong></p>
<ol>
<li>复制的规则在 patterns 中设置；</li>
<li><strong>from</strong>：设置从哪一个源中开始复制；</li>
<li><strong>to</strong>：复制到的位置，可以省略，会默认复制到打包的目录下；</li>
<li><strong>globOptions</strong>：设置一些额外的选项，其中可以编写需要忽略的文件：<ul>
<li>.DS_Store：mac 目录下回自动生成的一个文件；</li>
<li>index.html：也不需要复制，因为我们已经通过 HtmlWebpackPlugin 完成了 index.html 的生成；</li>
</ul>
</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"copy-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 其他省略</span>
    <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      patterns<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token comment">// 复制的来源</span>
          from<span class="token operator">:</span> <span class="token string">"public"</span><span class="token punctuation">,</span>
          to<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
          <span class="token comment">// 全局配置  globOptions</span>
          globOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
            ignore<span class="token operator">:</span> <span class="token string">"**/index.html"</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>可以看到效果和我们的配置的一样。</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728215659702.png" alt="image-20210728215659702"></p>
<h3 id="Mode-配置"><a href="#Mode-配置" class="headerlink" title="Mode 配置"></a>Mode 配置</h3><p><strong>前面我们一直没有讲 mode。</strong></p>
<p>Mode 配置选项，可以告知 webpack 使用<strong>响应模式</strong>的内置优化：</p>
<ol>
<li>默认值是 production（什么都不设置的情况下）；</li>
<li>可选值有：’none’ | ‘development’ | ‘production’；</li>
</ol>
<table>
<thead>
<tr>
<th align="center">选项</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">development</td>
<td align="center">会将 <code>DefinePlugin</code> 中 <code>process.env.NODE_ENV</code> 的值设置为 <code>development</code>. 为模块和 chunk 启用有效的名。</td>
</tr>
<tr>
<td align="center">production</td>
<td align="center">会将 <code>DefinePlugin</code> 中 <code>process.env.NODE_ENV</code> 的值设置为 <code>production</code>。为模块和 chunk 启用确定性的混淆名称，<code>FlagDependencyUsagePlugin</code>，<code>FlagIncludedChunksPlugin</code>，<code>ModuleConcatenationPlugin</code>，<code>NoEmitOnErrorsPlugin</code> 和 <code>TerserPlugin</code> 。</td>
</tr>
<tr>
<td align="center">none</td>
<td align="center">不使用任何默认优化选项</td>
</tr>
</tbody></table>
<p><strong>如果没有设置，webpack 会给 <code>mode</code> 的默认值设置为 <code>production</code>。</strong></p>
<p>如果 <code>mode</code> 未通过配置或 CLI 赋值，CLI 将使用可能有效的 <code>NODE_ENV</code> 值作为 <code>mode</code>。当然这是后话了。我们学习 CLI 的时候再来说。</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728221004362.png" alt="image-20210728221004362"></p>
<h4 id="Mode-配置代表更多"><a href="#Mode-配置代表更多" class="headerlink" title="Mode 配置代表更多"></a>Mode 配置代表更多</h4><p><strong>只要设置了 mode 属性，webpack 就会默认帮我们设置很多属性。不需要我们手动再去配置。</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728221656536.png" alt="image-20210728221656536"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728221716634.png" alt="image-20210728221716634"></p>
<h3 id="devtool-配置"><a href="#devtool-配置" class="headerlink" title="devtool 配置"></a>devtool 配置</h3><p><strong>这里顺手补充一波 devtool</strong>。</p>
<p><strong>devtool</strong>也是和<strong>mode</strong>同级别的配置。默认值是 eval。<em>设置开发时的工具</em></p>
<p>此选项控制是否生成，以及如何生成 <strong>source map</strong>。</p>
<h5 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h5><p>在默认值的情况下：<em>默认会使用 eval 函数对源代码进行包裹</em></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// devtool 属性 ：设置开发时的工具 默认值是 eval</span>
<span class="token comment">// 默认会使用 eval函数对源代码进行包裹</span>
devtool<span class="token operator">:</span> <span class="token string">"eval"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728223031699.png"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728223158431.png" alt="image-20210728223158431"></p>
<p><strong>发现我们的打包后的代码全都被 eval 函数包裹</strong></p>
<h5 id="source-map"><a href="#source-map" class="headerlink" title="source-map"></a>source-map</h5><p><strong>把属性设置为 source-map</strong>。出现错误就可以定位源码。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 如果想查看源码：可以设置值为 source-map</span>
<span class="token comment">// 设置为这个属性 会生成对应的打包后的代码和源码映射的文件</span>
<span class="token comment">// 出现错误可以映射到我们书写的源代码</span>
devtool<span class="token operator">:</span> <span class="token string">"source-map"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728223248505.png" alt="image-20210728223248505"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728223306610.png" alt="image-20210728223306610"></p>
<h5 id="两种方式出现错误后的对比"><a href="#两种方式出现错误后的对比" class="headerlink" title="两种方式出现错误后的对比"></a>两种方式出现错误后的对比</h5><h6 id="eval-配置代码出现错误时"><a href="#eval-配置代码出现错误时" class="headerlink" title="eval 配置代码出现错误时"></a>eval 配置代码出现错误时</h6><p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728223827751.png" alt="image-20210728223827751"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728223842559.png" alt="image-20210728223842559"></p>
<p><strong>发现代码并不是我们自己写的源码。不好辨别具体是那个文件出现错误。</strong></p>
<h6 id="source-map-配置代码出现错误时"><a href="#source-map-配置代码出现错误时" class="headerlink" title="source-map 配置代码出现错误时"></a>source-map 配置代码出现错误时</h6><p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728223957836.png" alt="image-20210728223957836"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210728224005593.png" alt="image-20210728224005593"></p>
<p><strong>出现错误，可以直接定位到具体是哪一个源文件。很 nice。</strong></p>
<h5 id="附上-devtool-的各种配置"><a href="#附上-devtool-的各种配置" class="headerlink" title="附上 devtool 的各种配置"></a>附上 devtool 的各种配置</h5><table>
<thead>
<tr>
<th align="left">devtool</th>
<th align="left">performance</th>
<th align="left">production</th>
<th align="left">quality</th>
<th align="left">comment</th>
</tr>
</thead>
<tbody><tr>
<td align="left">(none)</td>
<td align="left"><strong>build</strong>: fastest <strong>rebuild</strong>: fastest</td>
<td align="left">yes</td>
<td align="left">bundle</td>
<td align="left">Recommended choice for production builds with maximum performance.</td>
</tr>
<tr>
<td align="left"><strong><code>eval</code></strong></td>
<td align="left"><strong>build</strong>: fast <strong>rebuild</strong>: fastest</td>
<td align="left">no</td>
<td align="left">generated</td>
<td align="left">Recommended choice for development builds with maximum performance.</td>
</tr>
<tr>
<td align="left"><code>eval-cheap-source-map</code></td>
<td align="left"><strong>build</strong>: ok <strong>rebuild</strong>: fast</td>
<td align="left">no</td>
<td align="left">transformed</td>
<td align="left">Tradeoff choice for development builds.</td>
</tr>
<tr>
<td align="left"><code>eval-cheap-module-source-map</code></td>
<td align="left"><strong>build</strong>: slow <strong>rebuild</strong>: fast</td>
<td align="left">no</td>
<td align="left">original lines</td>
<td align="left">Tradeoff choice for development builds.</td>
</tr>
<tr>
<td align="left"><strong><code>eval-source-map</code></strong></td>
<td align="left"><strong>build</strong>: slowest <strong>rebuild</strong>: ok</td>
<td align="left">no</td>
<td align="left">original</td>
<td align="left">Recommended choice for development builds with high quality SourceMaps.</td>
</tr>
<tr>
<td align="left"><code>cheap-source-map</code></td>
<td align="left"><strong>build</strong>: ok <strong>rebuild</strong>: slow</td>
<td align="left">no</td>
<td align="left">transformed</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>cheap-module-source-map</code></td>
<td align="left"><strong>build</strong>: slow <strong>rebuild</strong>: slow</td>
<td align="left">no</td>
<td align="left">original lines</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong><code>source-map</code></strong></td>
<td align="left"><strong>build</strong>: slowest <strong>rebuild</strong>: slowest</td>
<td align="left">yes</td>
<td align="left">original</td>
<td align="left">Recommended choice for production builds with high quality SourceMaps.</td>
</tr>
<tr>
<td align="left"><code>inline-cheap-source-map</code></td>
<td align="left"><strong>build</strong>: ok <strong>rebuild</strong>: slow</td>
<td align="left">no</td>
<td align="left">transformed</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>inline-cheap-module-source-map</code></td>
<td align="left"><strong>build</strong>: slow <strong>rebuild</strong>: slow</td>
<td align="left">no</td>
<td align="left">original lines</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>inline-source-map</code></td>
<td align="left"><strong>build</strong>: slowest <strong>rebuild</strong>: slowest</td>
<td align="left">no</td>
<td align="left">original</td>
<td align="left">Possible choice when publishing a single file</td>
</tr>
<tr>
<td align="left"><code>eval-nosources-cheap-source-map</code></td>
<td align="left"><strong>build</strong>: ok <strong>rebuild</strong>: fast</td>
<td align="left">no</td>
<td align="left">transformed</td>
<td align="left">source code not included</td>
</tr>
<tr>
<td align="left"><code>eval-nosources-cheap-module-source-map</code></td>
<td align="left"><strong>build</strong>: slow <strong>rebuild</strong>: fast</td>
<td align="left">no</td>
<td align="left">original lines</td>
<td align="left">source code not included</td>
</tr>
<tr>
<td align="left"><code>eval-nosources-source-map</code></td>
<td align="left"><strong>build</strong>: slowest <strong>rebuild</strong>: ok</td>
<td align="left">no</td>
<td align="left">original</td>
<td align="left">source code not included</td>
</tr>
<tr>
<td align="left"><code>inline-nosources-cheap-source-map</code></td>
<td align="left"><strong>build</strong>: ok <strong>rebuild</strong>: slow</td>
<td align="left">no</td>
<td align="left">transformed</td>
<td align="left">source code not included</td>
</tr>
<tr>
<td align="left"><code>inline-nosources-cheap-module-source-map</code></td>
<td align="left"><strong>build</strong>: slow <strong>rebuild</strong>: slow</td>
<td align="left">no</td>
<td align="left">original lines</td>
<td align="left">source code not included</td>
</tr>
<tr>
<td align="left"><code>inline-nosources-source-map</code></td>
<td align="left"><strong>build</strong>: slowest <strong>rebuild</strong>: slowest</td>
<td align="left">no</td>
<td align="left">original</td>
<td align="left">source code not included</td>
</tr>
<tr>
<td align="left"><code>nosources-cheap-source-map</code></td>
<td align="left"><strong>build</strong>: ok <strong>rebuild</strong>: slow</td>
<td align="left">no</td>
<td align="left">transformed</td>
<td align="left">source code not included</td>
</tr>
<tr>
<td align="left"><code>nosources-cheap-module-source-map</code></td>
<td align="left"><strong>build</strong>: slow <strong>rebuild</strong>: slow</td>
<td align="left">no</td>
<td align="left">original lines</td>
<td align="left">source code not included</td>
</tr>
<tr>
<td align="left"><code>nosources-source-map</code></td>
<td align="left"><strong>build</strong>: slowest <strong>rebuild</strong>: slowest</td>
<td align="left">yes</td>
<td align="left">original</td>
<td align="left">source code not included</td>
</tr>
<tr>
<td align="left"><code>hidden-nosources-cheap-source-map</code></td>
<td align="left"><strong>build</strong>: ok <strong>rebuild</strong>: slow</td>
<td align="left">no</td>
<td align="left">transformed</td>
<td align="left">no reference, source code not included</td>
</tr>
<tr>
<td align="left"><code>hidden-nosources-cheap-module-source-map</code></td>
<td align="left"><strong>build</strong>: slow <strong>rebuild</strong>: slow</td>
<td align="left">no</td>
<td align="left">original lines</td>
<td align="left">no reference, source code not included</td>
</tr>
<tr>
<td align="left"><code>hidden-nosources-source-map</code></td>
<td align="left"><strong>build</strong>: slowest <strong>rebuild</strong>: slowest</td>
<td align="left">yes</td>
<td align="left">original</td>
<td align="left">no reference, source code not included</td>
</tr>
<tr>
<td align="left"><code>hidden-cheap-source-map</code></td>
<td align="left"><strong>build</strong>: ok <strong>rebuild</strong>: slow</td>
<td align="left">no</td>
<td align="left">transformed</td>
<td align="left">no reference</td>
</tr>
<tr>
<td align="left"><code>hidden-cheap-module-source-map</code></td>
<td align="left"><strong>build</strong>: slow <strong>rebuild</strong>: slow</td>
<td align="left">no</td>
<td align="left">original lines</td>
<td align="left">no reference</td>
</tr>
<tr>
<td align="left"><code>hidden-source-map</code></td>
<td align="left"><strong>build</strong>: slowest <strong>rebuild</strong>: slowest</td>
<td align="left">yes</td>
<td align="left">original</td>
<td align="left">no reference. Possible choice when using SourceMap only for error reporting purposes.</td>
</tr>
</tbody></table>
<h3 id="本次使用过的配置代码展示"><a href="#本次使用过的配置代码展示" class="headerlink" title="本次使用过的配置代码展示"></a>本次使用过的配置代码展示</h3><h4 id="plugin-以前的配置"><a href="#plugin-以前的配置" class="headerlink" title="plugin 以前的配置"></a>plugin 以前的配置</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"./src/index.js"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"./build"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">"bundle.js"</span><span class="token punctuation">,</span>
    <span class="token comment">// 使用asset打包的图片不转为base64格式的时候，图片存放的位置以及名称</span>
    <span class="token comment">// assetModuleFilename: 'image/[name]-[hash:6][ext]'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"style-loader"</span><span class="token punctuation">,</span> <span class="token string">"css-loader"</span><span class="token punctuation">,</span> <span class="token string">"postcss-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"style-loader"</span><span class="token punctuation">,</span> <span class="token string">"css-loader"</span><span class="token punctuation">,</span> <span class="token string">"postcss-loader"</span><span class="token punctuation">,</span> <span class="token string">"less-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 配置打包图片资源的规则</span>
      <span class="token comment">// {</span>
      <span class="token comment">//   test: /\.(jpg|png|jpeg|JPG)$/,</span>
      <span class="token comment">//   use: 'file-loader'</span>
      <span class="token comment">// }</span>
      <span class="token comment">/* {
        test: /\.(jpg|png|jpeg|JPG)$/,
        use: {
          loader: 'file-loader',
          // file-loader的参数配置
          options: {
            // 打包后图片文件所在的路径
            // outputPath: 'image',
            // 打包后生成文件的名称
            // [name] 源文件的名称（不含拓展名）
            // 我们发现不写配置时，文件的名称过长（且文件名是通过hash算法算出来的，为了防止重名）
            // [hash:6] 默认生成文件名称的hash算法，32位，取前六位
            // [ext] 使用原来文件的拓展名
            // name: '[name]_[hash:6].[ext]'

            // 当然：我们也可以把图片存放的路径和图片名称合在一起
            name: 'image/[name]-[hash:6].[ext]'
          }
        }
      } , */</span>

      <span class="token comment">// 注意： 使用file-loader就不要使用url-loader</span>
      <span class="token comment">// 使用url-loader也不需要使用file-loader</span>
      <span class="token comment">// 配置url-loader 设置图片大小的限制，小于某个范围的图片转为base64格式</span>
      <span class="token comment">// {</span>
      <span class="token comment">//   test: /\.(jpe?g|JPG|png)$/,</span>
      <span class="token comment">//   use: {</span>
      <span class="token comment">//     loader: 'url-loader',</span>
      <span class="token comment">//     options: {</span>
      <span class="token comment">//       name: 'image/[name]-[hash:6].[ext]',</span>
      <span class="token comment">//       // 设置图片大小的限制，只有小于多少kb的图片我们才会转为base64格式</span>
      <span class="token comment">//       // 如果大于这个限制 我们就不会转为base64格式。而是继续采用上面的path和name的形式打包，还是保持图片的形式不变</span>
      <span class="token comment">//       limit: 100 * 1024 // 小于100kb的文件才会转为base64格式</span>
      <span class="token comment">//     }</span>
      <span class="token comment">//   }</span>
      <span class="token comment">// }</span>

      <span class="token comment">// webpack5开始 可以不在使用file-loader和url-loader来进行打包图片了</span>
      <span class="token comment">// 我们直接使用 asset module type 资源模块类型 来替换上面loader</span>
      <span class="token comment">// 注意：asset是webpack5自带的</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(JPG|jpe?g|png)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token comment">// 这里不在使用use属性 而是type属性</span>
        <span class="token comment">// 使用asset/resource 来代替 file-loader</span>
        <span class="token comment">// type:'asset/resource'</span>

        <span class="token comment">// 比较常用的我们一般直接写成 asset</span>
        type<span class="token operator">:</span> <span class="token string">"asset"</span><span class="token punctuation">,</span>
        <span class="token comment">// 配置相关的asset参数 使用parser属性</span>
        parser<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 数据url条件</span>
          dataUrlCondition<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// 最大不超过多少kb的图片 我们转为 base64格式</span>
            maxSize<span class="token operator">:</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 下面的配置也可以放在 output里面（了解）</span>
        <span class="token comment">// generator属性 生成 也就是打包后的图片存放时相关的配置</span>
        generator<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 配置图片名称和图片位置</span>
          <span class="token comment">// 这里的 [ext] 拿到的文件拓展名包含 .</span>
          filename<span class="token operator">:</span> <span class="token string">"image/[name]-[hash:6][ext]"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 配置字体和字体图标等文件打包时的规则</span>
      <span class="token comment">// {</span>
      <span class="token comment">//   test: /\.(eot|ttf|woff2?)$/,</span>
      <span class="token comment">//   use:{</span>
      <span class="token comment">//     loader: 'file-loader',</span>
      <span class="token comment">//     options:{</span>
      <span class="token comment">//       // 这里是name属性 不是filename</span>
      <span class="token comment">//       name: 'font/[name]-[hash:6].[ext]'</span>
      <span class="token comment">//     }</span>
      <span class="token comment">//   }</span>
      <span class="token comment">// },</span>

      <span class="token comment">// 也可以使用webpack提供的资源模块类型</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(eot|ttf|woff2?)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">"asset/resource"</span><span class="token punctuation">,</span>
        generator<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 这里使用的是filename属性 别忘了！！！！！</span>
          filename<span class="token operator">:</span> <span class="token string">"font/[name]-[hash:6][ext]"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="plugin-开始及以后的配置"><a href="#plugin-开始及以后的配置" class="headerlink" title="plugin 开始及以后的配置"></a>plugin 开始及以后的配置</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 注意：所有的插件都需要导入的，loader不需要</span>
<span class="token comment">// 导入 clean-webpack-plugin 插件</span>
<span class="token comment">// 该插件导出的是一个对象，我们需要从对象里面按需获取 CleanWebpackPlugin 这个类</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"clean-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 导入 html-webpack-plugin插件 这个插件导出的就是一个类 不需要解构</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"html-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 导入 DefinePlugin 插件 解决常量 BASE_URL 的问题</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> DefinePlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"webpack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 导入 CopyWebpackPlugin 插件 该插件导出的也是一个类</span>
<span class="token comment">// 用来完成文件的复制工作</span>
<span class="token keyword">const</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"copy-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 模式配置 mode</span>
  <span class="token comment">// development 生产模式 打包的代码不会压缩 易于阅读</span>
  mode<span class="token operator">:</span> <span class="token string">"development"</span><span class="token punctuation">,</span>
  <span class="token comment">// 开发模式 代码会被压缩 减小体积</span>
  <span class="token comment">// mode:"production",</span>

  <span class="token comment">// devtool 属性 ：设置开发时的工具 默认值是 eval</span>
  <span class="token comment">// 默认会使用 eval函数对源代码进行包裹</span>
  <span class="token comment">// devtool: 'eval',</span>
  <span class="token comment">// 如果想查看源码：可以设置值为 source-map</span>
  <span class="token comment">// 设置为这个属性 会生成对应的打包后的代码和源码映射的文件</span>
  <span class="token comment">// 出现错误可以映射到我们书写的源代码</span>
  devtool<span class="token operator">:</span> <span class="token string">"source-map"</span><span class="token punctuation">,</span>

  <span class="token comment">// 提供 plugins属性来配置插件</span>
  <span class="token comment">// plugins属性是数组，数组元素是一个个的插件对象</span>
  <span class="token comment">// 插件是书写没有先后顺序！！！！！！！！！！</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 使用 CleanWebpackPlugin 插件对象</span>
    <span class="token comment">// 因为 CleanWebpackPlugin 是一个class类，我们需要 new 实例化成对象</span>
    <span class="token comment">// CleanWebpackPlugin 插件会删除我们生成的打包后的那么文件夹，然后重新打包</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 使用 HtmlWebpackPlugin 插件</span>
    <span class="token comment">// new HtmlWebpackPlugin(),</span>

    <span class="token comment">// 使用 HtmlWebpackPlugin 插件 并指定html的模板</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 按照这个html文件的模板来进行打包，生成的index.html和这个模板一样</span>
      template<span class="token operator">:</span> <span class="token string">"./public/index.html"</span><span class="token punctuation">,</span>
      title<span class="token operator">:</span> <span class="token string">"webpack-plugin 的学习"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 使用 DefinePlugin 插件来定义 常量</span>
    <span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// BASE_URL 会根据后面给的属性值 去本文件上下文中找这个变量</span>
      <span class="token comment">// 比如我这里给的是字符串 "filepath"</span>
      <span class="token comment">// 也会去上下文中找叫做 filepath 的变量</span>
      <span class="token comment">// 如果我们想直接给一个字符串的值</span>
      <span class="token comment">// 我们需要在双引号里面嵌套单引号赋值</span>
      <span class="token comment">// 当然 单引号里面嵌套双引号赋值也是可以的</span>
      <span class="token comment">// BASE_URL: "filepath",</span>
      <span class="token constant">BASE_URL</span><span class="token operator">:</span> <span class="token string">"'./'"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token comment">// 使用 CopyWebpackPlugin 插件</span>
    <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// patterns属性： 匹配规则 数组</span>
      patterns<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token comment">// 复制的来源</span>
          from<span class="token operator">:</span> <span class="token string">"public"</span><span class="token punctuation">,</span>
          <span class="token comment">// 复制后放到哪里</span>
          <span class="token comment">// 不写，或者给空字符串 最后都是把拷贝的文件放在打包后的根目录下</span>
          to<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
          <span class="token comment">// 全局配置  globOptions</span>
          globOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// 忽略那些文件</span>
            <span class="token comment">// ignore: ['**/index.html'],</span>
            <span class="token comment">// 只有一个忽略的规则时 可以直接写一个字符串</span>
            ignore<span class="token operator">:</span> <span class="token string">"**/index.html"</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"./src/index.js"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"./build"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">"bundle.js"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"style-loader"</span><span class="token punctuation">,</span> <span class="token string">"css-loader"</span><span class="token punctuation">,</span> <span class="token string">"postcss-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"style-loader"</span><span class="token punctuation">,</span> <span class="token string">"css-loader"</span><span class="token punctuation">,</span> <span class="token string">"postcss-loader"</span><span class="token punctuation">,</span> <span class="token string">"less-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// webpack5开始 可以不在使用file-loader和url-loader来进行打包图片了</span>
      <span class="token comment">// 我们直接使用 asset module type 资源模块类型 来替换上面loader</span>
      <span class="token comment">// 注意：asset是webpack5自带的</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(JPG|jpe?g|png)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token comment">// 这里不在使用use属性 而是type属性</span>
        <span class="token comment">// 使用asset/resource 来代替 file-loader</span>
        <span class="token comment">// type:'asset/resource'</span>

        <span class="token comment">// 比较常用的我们一般直接写成 asset</span>
        type<span class="token operator">:</span> <span class="token string">"asset"</span><span class="token punctuation">,</span>
        <span class="token comment">// 配置相关的asset参数 使用parser属性</span>
        parser<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 数据url条件</span>
          dataUrlCondition<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// 最大不超过多少kb的图片 我们转为 base64格式</span>
            maxSize<span class="token operator">:</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 下面的配置也可以放在 output里面（了解）</span>
        <span class="token comment">// generator属性 生成 也就是打包后的图片存放时相关的配置</span>
        generator<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 配置图片名称和图片位置</span>
          <span class="token comment">// 这里的 [ext] 拿到的文件拓展名包含 .</span>
          filename<span class="token operator">:</span> <span class="token string">"image/[name]-[hash:6][ext]"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token comment">// 也可以使用webpack提供的资源模块类型</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(eot|ttf|woff2?)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">"asset/resource"</span><span class="token punctuation">,</span>
        generator<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 这里使用的是filename属性 别忘了！！！！！</span>
          filename<span class="token operator">:</span> <span class="token string">"font/[name]-[hash:6][ext]"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Babel-和-Vue-的-sfc"><a href="#Babel-和-Vue-的-sfc" class="headerlink" title="Babel 和 Vue 的 sfc"></a>Babel 和 Vue 的 sfc</h2><h3 id="Babel"><a href="#Babel" class="headerlink" title="Babel"></a>Babel</h3><h4 id="为什么需要-babel？"><a href="#为什么需要-babel？" class="headerlink" title="为什么需要 babel？"></a>为什么需要 babel？</h4><p>事实上，在开发中我们很少<strong>直接去接触 babel</strong>，但是 babel 对于前端开发来说，目前是不可缺少的一部分：</p>
<ol>
<li>开发中，我们想要使用<strong>ES6+<strong>的语法，想要使用</strong>TypeScrip</strong>t，开发<strong>React</strong>项目，它们都是离不开 Babel 的；</li>
<li>所以，<strong>学习 Babel</strong>对于我们理解代码从编写到线上的转变过程至关重要；</li>
</ol>
<p><strong>那么，Babel 到底是什么呢？</strong></p>
<p>Babel 是一个<strong>工具链</strong>，主要用于旧浏览器或者环境中将 ECMAScript 2015+代码转换为向后兼容版本的 JavaScript；</p>
<p><strong>包括：语法转换、源代码转换等；</strong></p>
<h4 id="Babel-命令行使用"><a href="#Babel-命令行使用" class="headerlink" title="Babel 命令行使用"></a>Babel 命令行使用</h4><p>babel 本身可以作为一个<strong>独立的工具</strong>（和 postcss 一样），不和 webpack 等构建工具配置来单独使用。</p>
<p>如果我们希望在命令行尝试使用 babel，需要安装如下库：</p>
<ul>
<li>@babel/core：babel 的核心代码，必须安装；</li>
<li>@babel/cli：可以让我们在命令行使用 babel；</li>
</ul>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm i @babel/core @babel/cli -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>使用 babel 来处理我们的源代码：</strong></p>
<ul>
<li>src：是源文件的目录；也可以直接指定文件</li>
<li>–out-dir：指定要输出的文件夹 dist；</li>
</ul>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npx babel src --out-dir dict<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="插件的使用"><a href="#插件的使用" class="headerlink" title="插件的使用"></a>插件的使用</h4><p>比如我们需要转换<strong>箭头函数</strong>，那么我们就可以使用箭头函数转换相关的插件：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install @babel/plugin-transform-arrow-functions -D

npx babel src --out-dir dist --plugins=@babel/plugin-transform-arrow-functions<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731084446775.png" alt="image-20210731084446775"></p>
<p><strong>源代码：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">"毛毛"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arr<span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>目标代码：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">"毛毛"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arr<span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731084619271.png" alt="image-20210731084619271"></p>
<p>查看转换后的结果：我们会发现 <strong>const</strong> 并没有转成 <strong>var</strong></p>
<ul>
<li>这是因为 plugin-transform-arrow-functions，并没有提供这样的功能；</li>
<li>我们需要使用 plugin-transform-block-scoping 来完成这样的功能；</li>
</ul>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install @babel/plugin-transform-block-scoping -D

npx babel src --out-dir dist --plugins=@babel/plugin-transform-block-scoping
,@babel/plugin-transform-arrow-functions
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731084842846.png" alt="image-20210731084842846"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731084854742.png" alt="image-20210731084854742"></p>
<h4 id="Babel-的预设-preset"><a href="#Babel-的预设-preset" class="headerlink" title="Babel 的预设 preset"></a>Babel 的预设 preset</h4><p>但是如果要转换的内容过多，一个个设置是比较麻烦的，我们可以使用预设（preset）：<strong>后面我们再具体来讲预设代表的含义；</strong></p>
<p>安装@babel/preset-env 预设：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install @babel/preset-env -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>执行如下命令：</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npx babel src --out-dir dist --presets=@babel/preset-env<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731085152844.png" alt="image-20210731085152844"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731085201827.png" alt="image-20210731085201827"></p>
<h4 id="Babel-的底层原理"><a href="#Babel-的底层原理" class="headerlink" title="Babel 的底层原理"></a>Babel 的底层原理</h4><p>babel 是如何做到将我们的一段代码（<strong>ES6、TypeScript、Reac</strong>t）转成另外一段代码（ES5）的呢？</p>
<p>从一种源代码（原生语言）转换成另一种源代码（目标语言），这是什么的工作呢？</p>
<p><strong>就是编译器，事实上我们可以将 babel 看成就是一个编译器</strong>；Babel 编译器的作用就是将我们的源代码，转换成浏览器可以直接识别的另外一段源代码；</p>
<p><strong>Babel 也拥有编译器的工作流程：</strong></p>
<ol>
<li>解析阶段（Parsing）</li>
<li>转换阶段（Transformation）</li>
<li>生成阶段（Code Generation）</li>
</ol>
<h4 id="Babel-编译器执行原理"><a href="#Babel-编译器执行原理" class="headerlink" title="Babel 编译器执行原理"></a>Babel 编译器执行原理</h4><h5 id="Babel-的执行阶段"><a href="#Babel-的执行阶段" class="headerlink" title="Babel 的执行阶段"></a>Babel 的执行阶段</h5><p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731085400687.png" alt="image-20210731085400687"></p>
<p><strong>当然，这只是一个简化版的编译器工具流程，在每个阶段又会有自己具体的工作：</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731085426851.png" alt="image-20210731085426851"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731085436745.png" alt="image-20210731085436745"></p>
<h4 id="babel-loader"><a href="#babel-loader" class="headerlink" title="babel-loader"></a>babel-loader</h4><p>在实际开发中，我们通常会在构建工具中通过配置 babel 来对其进行使用的，比如在 webpack 中</p>
<p>那么我们就需要去安装相关的依赖：如果之前已经安装了@babel/core，那么这里不需要再次安装；</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install babel-loader @babel/core -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>我们可以设置一个规则，在加载 js 文件时，使用我们的 babel：</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731094048189.png" alt="image-20210731094048189"></p>
<h5 id="指定使用的插件"><a href="#指定使用的插件" class="headerlink" title="指定使用的插件"></a>指定使用的插件</h5><p>我们必须指定使用的插件才会生效:</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731094141175.png" alt="image-20210731094141175"></p>
<h5 id="babel-preset"><a href="#babel-preset" class="headerlink" title="babel-preset"></a>babel-preset</h5><p>如果我们一个个去安装使用插件，那么需要手动来管理大量的 babel 插件，我们可以直接给 webpack 提供一个 preset，webpack 会根据我们的预设来加载对应的插件列表，并且将其传递给 babel</p>
<p><strong>比如常见的预设有三个：</strong></p>
<ol>
<li>env</li>
<li>react</li>
<li>TypeScript</li>
</ol>
<p><strong>安装 preset-env：</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install @babel/preset-env<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731094336858.png" alt="image-20210731094336858"></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 对js代码进行转换</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">"babel-loader"</span><span class="token punctuation">,</span>
          <span class="token comment">// loader的选项</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// 使用babel-loader的时候，babel需要的插件</span>
            plugins<span class="token operator">:</span><span class="token punctuation">[</span>
              <span class="token string">"@babel/plugin-transform-arrow-functions"</span><span class="token punctuation">,</span>
              <span class="token string">"@babel/plugin-transform-block-scoping"</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>

            <span class="token comment">// 使用预设</span>
            presets<span class="token operator">:</span><span class="token punctuation">[</span>
              <span class="token comment">// 没有参数直接这样写预设，</span>
              <span class="token string">"@babel/preset-env"</span><span class="token punctuation">,</span>
              <span class="token comment">// 有参数时：</span>
              <span class="token punctuation">[</span><span class="token string">"@babel/preset-env"</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="Babel-的配置文件"><a href="#Babel-的配置文件" class="headerlink" title="Babel 的配置文件"></a>Babel 的配置文件</h5><p>像之前一样，我们可以将 babel 的配置信息放到一个独立的文件中，babel 给我们提供了两种配置文件的编写：</p>
<ol>
<li>babel.config.json（或者.js，.cjs，.mjs）文件；</li>
<li>.babelrc.json（或者.babelrc，.js，.cjs，.mjs）文件；</li>
</ol>
<p>它们两个有什么区别呢？目前很多的项目都采用了多包管理的方式（babel 本身、element-plus、umi 等）；</p>
<ul>
<li>.babelrc.json：早期使用较多的配置方式，但是对于配置 Monorepos 项目是比较麻烦的；</li>
<li>babel.config.json（babel7）：可以直接作用于 Monorepos 项目的子包，更加推荐；</li>
</ul>
<p><strong>我这里采取的 babel.config.js 的方式</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// babel 配置文件</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"@babel/preset-env"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// plugins:[]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h3><h4 id="Vue-源码的打包"><a href="#Vue-源码的打包" class="headerlink" title="Vue 源码的打包"></a>Vue 源码的打包</h4><p>我们主要是学习 Vue 的，那么我们应该包含 Vue 相关的代码：</p>
<p><strong>安装 vue</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm i vue@next # 安装的是vue3，且是生产依赖<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>书写使用 vue 的代码</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 使用vue</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  template<span class="token operator">:</span> <span class="token string">"&lt;h2&gt;我是vue渲染出来的！&lt;/h2&gt;"</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">"啊哈哈！"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">"#app"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>使用 webpack 进行打包</strong></p>
<p>发现：<strong>界面上是没有效果的：</strong></p>
<p>并且我们查看运行的控制台，会发现如下的警告信息；</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731095804576.png" alt="image-20210731095804576"></p>
<h4 id="Vue-打包后不同版本解析"><a href="#Vue-打包后不同版本解析" class="headerlink" title="Vue 打包后不同版本解析"></a>Vue 打包后不同版本解析</h4><h5 id="vue-runtime-global-prod-js："><a href="#vue-runtime-global-prod-js：" class="headerlink" title="vue(.runtime).global(.prod).js："></a><strong>vue(.runtime).global(.prod).js：</strong></h5><ol>
<li>通过浏览器中的 <code>&lt;srcipt src="..."&gt;</code>直接引入</li>
<li>我们之前通过 CDN 引入和下载的 Vue 版本就是这个版本；</li>
<li>会暴露一个全局的 Vue 来使用；</li>
</ol>
<h5 id="vue-runtime-esm-browser-prod-js："><a href="#vue-runtime-esm-browser-prod-js：" class="headerlink" title="vue(.runtime).esm-browser(.prod).js："></a>vue(.runtime).esm-browser(.prod).js：</h5><p>用于通过原生 ES 模块导入使用 (在浏览器中通过</p>
<h5 id="vue-runtime-esm-bundler-js："><a href="#vue-runtime-esm-bundler-js：" class="headerlink" title="vue(.runtime).esm-bundler.js："></a>vue(.runtime).esm-bundler.js：</h5><ol>
<li>用于 <strong>webpack，rollup 和 parcel</strong> 等构建工具；</li>
<li>构建工具中默认是<strong>vue.runtime.esm-bundler.js</strong>；</li>
<li>如果我们需要解析模板 template，那么需要手动指定 vue.esm-bundler.js；</li>
</ol>
<h5 id="vue-cjs-prod-js："><a href="#vue-cjs-prod-js：" class="headerlink" title="vue.cjs(.prod).js："></a>vue.cjs(.prod).js：</h5><ol>
<li>服务器端渲染使用；</li>
<li>通过 require()在 Node.js 中使用；</li>
</ol>
<h4 id="运行时-编译器-vs-仅运行时"><a href="#运行时-编译器-vs-仅运行时" class="headerlink" title="运行时+编译器 vs 仅运行时"></a>运行时+编译器 vs 仅运行时</h4><p>在 Vue 的开发过程中我们有三种方式来编写 DOM 元素：</p>
<ul>
<li>方式一：template 模板的方式（之前经常使用的方式）；</li>
<li>方式二：render 函数的方式，使用 h 函数来编写渲染的内容；</li>
<li>方式三：通过.vue 文件中的 template 来编写模板；</li>
</ul>
<p>它们的模板分别是如何处理的呢？</p>
<p><strong>方式二</strong>中的 h 函数可以直接返回一个虚拟节点，也就是 Vnode 节点；</p>
<p><strong>方式一和方式三</strong>的 template 都需要有<strong>特定的代码</strong>来对其进行解析：</p>
<ul>
<li>方式三.vue 文件中的 template 可以通过在 vue-loader 对其进行编译和处理；</li>
<li>方式一种的 template 我们必须要通过源码中一部分代码来进行编译；</li>
</ul>
<p>所以，Vue 在让我们选择版本的时候分为 <strong>运行时+编译器 vs 仅运行时</strong></p>
<ol>
<li>运行时+编译器包含了对 template 模板的编译代码，更加完整，但是也更大一些；</li>
<li>仅运行时没有包含对 template 版本的编译代码，相对更小一些；</li>
</ol>
<p><strong>所以我们引入 vue3 应使用如下方式：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue/dist/vue.esm-bundler"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731102206823.png" alt="image-20210731102206823"></p>
<h4 id="全局标识的配置"><a href="#全局标识的配置" class="headerlink" title="全局标识的配置"></a>全局标识的配置</h4><p><strong>我们会发现控制台还有另外的一个警告：</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731101951525.png" alt="image-20210731101951525"></p>
<p>在 GitHub 上的文档中我们可以找到说明：</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731102019738.png" alt="image-20210731102019738"></p>
<p>这是两个特性的标识，一个是使用 Vue 的 Options，一个是 Production 模式下是否支持 devtools 工具；</p>
<p>虽然他们都有默认值，但是强烈建议我们手动对他们进行配置；</p>
<p><strong>可以使用 DefinePlugin 插件配置这两个常量</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token constant">BASE_URL</span><span class="token operator">:</span> <span class="token string">"'./'"</span><span class="token punctuation">,</span>
  __VUE_OPTIONS_API__<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  __VUE_PROD_DEVTOOLS__<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="编写-App-vue-代码"><a href="#编写-App-vue-代码" class="headerlink" title="编写 App.vue 代码"></a>编写 App.vue 代码</h4><p>在前面我们提到过，真实开发中多数情况下我们都是使用<strong>SFC（ single-file components (单文件组件) ）</strong>。</p>
<pre class="line-numbers language-vue" data-language="vue"><code class="language-vue">&lt;template lang=""&gt;
  &lt;h2&gt;你好 vue3 哈哈哈哈 sfc&lt;/h2&gt;
  &lt;h3&gt;{{ message }}&lt;/h3&gt;
&lt;/template&gt;
&lt;script&gt;
export default {
  data() {
    return {
      message: "哈哈",
    };
  },
};
&lt;/script&gt;
&lt;style scoped&gt;
h2,
h3 {
  color: aquamarine;
}
&lt;/style&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 使用 .vue单文件组件的方式</span>
<span class="token comment">// 可以直接导入vue就可以了。不需要上面的那种导入方式，来解决template模板的解析问题</span>
<span class="token comment">// 因为现在已经没有template了。而vue文件里面的template会被vue-loader解析</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">"../vue/App.vue"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">"#app"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="App-vue-的打包过程"><a href="#App-vue-的打包过程" class="headerlink" title="App.vue 的打包过程"></a>App.vue 的打包过程</h5><p>我们对代码打包会报错：提示我们需要合适的 Loader 来处理文件。</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731110600146.png" alt="image-20210731110600146"></p>
<p><strong>这个时候我们需要使用 vue-loader：</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install vue-loader@next -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>在 webpack 的模板规则中进行配置：</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210731110659522.png" alt="image-20210731110659522"></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 配置 .vue文件的加载打包规则</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">"vue-loader"</span>
      <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="vue-compiler-sfc"><a href="#vue-compiler-sfc" class="headerlink" title="@vue/compiler-sfc"></a>@vue/compiler-sfc</h5><p>打包依然会报错，这是因为我们必须添加**@vue/compiler-sfc**来对 template 进行解析：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install @vue/compiler-sfc -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>另外我们需要配置对应的 Vue 插件：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 引入Vue-loader的插件 帮助loader做一些事情</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> VueLoaderPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"vue-loader/dist/index"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>重新打包即可支持 App.vue 的写法</strong></p>
<p>另外，我们也可以编写其他的.vue 文件来编写自己的组件；</p>
<h2 id="webpack-devServer-和-Vue-CLI"><a href="#webpack-devServer-和-Vue-CLI" class="headerlink" title="webpack-devServer 和 Vue-CLI"></a>webpack-devServer 和 Vue-CLI</h2><h3 id="devServer-热部署"><a href="#devServer-热部署" class="headerlink" title="devServer(热部署)"></a>devServer(热部署)</h3><p><strong>目前我们开发的代码，为了运行需要有两个操作：</strong></p>
<p><strong>操作一</strong>：npm run build，编译相关的代码；</p>
<p><strong>操作二</strong>：通过 live server 或者直接通过浏览器，打开 index.html 代码，查看效果；</p>
<p>这个过程经常操作会影响我们的开发效率，我们希望可以做到，当文件发生变化时，可以自动的完成 <strong>编译 和 展示</strong>；</p>
<p><strong>为了完成自动编译，webpack 提供了几种可选的方式：</strong></p>
<ol>
<li>webpack watch mode；</li>
<li>webpack-dev-server（常用）；</li>
<li>webpack-dev-middleware；</li>
</ol>
<h4 id="Webpack-watch"><a href="#Webpack-watch" class="headerlink" title="Webpack watch"></a>Webpack watch</h4><p>webpack 给我们提供了<strong>watch 模式</strong>：</p>
<ol>
<li>在该模式下，webpack 依赖图中的所有文件，只要有一个发生了更新，那么代码将被重新编译；</li>
<li>我们不需要手动去运行 <strong>npm run build</strong>指令了；</li>
</ol>
<h5 id="如何开启-watch-呢？两种方式："><a href="#如何开启-watch-呢？两种方式：" class="headerlink" title="如何开启 watch 呢？两种方式："></a><strong>如何开启 watch 呢？两种方式：</strong></h5><p>方式一：在导出的配置中，添加 watch: true；</p>
<p>方式二：在启动 webpack 的命令中，添加 <strong>–watch 的标识</strong>；</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802172245108.png" alt="image-20210802172245108"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802172200638.png" alt="image-20210802172200638"></p>
<p><strong>方式二</strong>是在 package.json 的 scripts 中添加一个 watch 的脚本。</p>
<h4 id="webpack-dev-server"><a href="#webpack-dev-server" class="headerlink" title="webpack-dev-server"></a>webpack-dev-server</h4><p>上面的方式可以监听到文件的变化，但是事实上它本身是没有自动刷新浏览器的功能的：</p>
<ol>
<li>当然，目前我们可以在 VSCode 中使用<strong>live-server</strong>来完成这样的功能；</li>
<li>但是，我们希望在不使用 live-server 的情况下，可以具备<strong>live reloading</strong>（<strong>实时重新加载</strong>）的功能；</li>
</ol>
<p><strong>安装 webpack-dev-server</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm i webpack-dev-server -D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>修改配置文件，告知 dev server，从什么位置查找文件：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 其他配置均省略</span>

  <span class="token comment">// 热部署（热更新）的配置</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果需要的资源没有在webpack里面加载到，会去contentBase指定的文件夹里面寻找</span>
    contentBase<span class="token operator">:</span> <span class="token string">"./public"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 打包的是node环境 还是 web 环境</span>
  target<span class="token operator">:</span> <span class="token string">"web"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802172713684.png" alt="image-20210802172713684"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802172725403.png" alt="image-20210802172725403"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802172828915.png" alt="image-20210802172828915"></p>
<h4 id="认识模块热替换"><a href="#认识模块热替换" class="headerlink" title="认识模块热替换"></a>认识模块热替换</h4><p><strong>什么是 HMR 呢？</strong></p>
<ol>
<li>HMR 的全称是 Hot Module Replacement，翻译为模块热替换；</li>
<li>模块热替换是指在 应用程序运行过程中，替换、添加、删除模块，而无需重新刷新整个页面；</li>
</ol>
<p><strong>HMR 通过如下几种方式，来提高开发的速度：</strong></p>
<ol>
<li>不重新加载整个页面，这样可以保留某些应用程序的状态不丢失；</li>
<li>只更新需要变化的内容，节省开发的时间；</li>
<li>修改了 css、js 源代码，会立即在浏览器更新，相当于直接在浏览器的 devtools 中直接修改样式；</li>
</ol>
<p><strong>如何使用 HMR 呢？</strong></p>
<ol>
<li>默认情况下，webpack-dev-server 已经支持 HMR，我们只需要开启即可；</li>
<li>在不开启 HMR 的情况下，当我们修改了源代码之后，整个页面会自动刷新，使用的是 live reloading；</li>
</ol>
<h5 id="开启-HMR"><a href="#开启-HMR" class="headerlink" title="开启 HMR"></a>开启 HMR</h5><p><strong>修改 webpack 的配置：</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802173037587.png" alt="image-20210802173037587"></p>
<p><strong>浏览器可以看到如下效果：</strong></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802173057967.png" alt="image-20210802173057967"></p>
<p>但是你会发现，当我们修改了某一个模块的代码时，依然是刷新的整个页面：</p>
<p>这是因为我们需要去<strong>指定哪些模块</strong>发生更新时，<strong>进行 HMR</strong>；</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802173232460.png" alt="image-20210802173232460"></p>
<h4 id="框架的-HMR"><a href="#框架的-HMR" class="headerlink" title="框架的 HMR"></a>框架的 HMR</h4><p><strong>有一个问题：在开发其他项目时，我们是否需要经常手动去写入 module.hot.accpet 相关的 API 呢？</strong></p>
<ol>
<li>比如开发 Vue、React 项目，我们修改了组件，希望进行热更新，这个时候应该如何去操作呢？</li>
<li>事实上社区已经针对这些有很成熟的解决方案了；</li>
<li>比如 vue 开发中，我们使用 vue-loader，此 loader 支持 vue 组件的 HMR，提供开箱即用的体验；</li>
<li>比如 react 开发中，有 React Hot Loader，实时调整 react 组件（目前 React 官方已经弃用了，改成使用 reactrefresh）；</li>
</ol>
<h4 id="HMR-的原理"><a href="#HMR-的原理" class="headerlink" title="HMR 的原理"></a>HMR 的原理</h4><p><strong>那么 HMR 的原理是什么呢？如何可以做到只更新一个模块中的内容呢？</strong></p>
<ol>
<li>webpack-dev-server 会创建两个服务：提供静态资源的服务（express）和 Socket 服务（net.Socket）；</li>
<li>express server 负责直接提供静态资源的服务（打包后的资源直接被浏览器请求和解析）；</li>
</ol>
<p><strong>HMR Socket Server，是一个 socket 的长连接：</strong></p>
<ol>
<li>长连接有一个最好的好处是建立连接后双方可以通信（服务器可以直接发送文件到客户端）；</li>
<li>当服务器监听到对应的模块发生变化时，会生成两个文件.json（manifest 文件）和.js 文件（update chunk）；</li>
<li>通过长连接，可以直接将这两个文件主动发送给客户端（浏览器）；</li>
<li>浏览器拿到两个新的文件后，通过 HMR runtime 机制，加载这两个文件，并且针对修改的模块进行更新；</li>
</ol>
<h5 id="HMR-的原理图"><a href="#HMR-的原理图" class="headerlink" title="HMR 的原理图"></a>HMR 的原理图</h5><p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802173450624.png" alt="image-20210802173450624"></p>
<h5 id="hotOnly、host-配置"><a href="#hotOnly、host-配置" class="headerlink" title="hotOnly、host 配置"></a>hotOnly、host 配置</h5><h6 id="host-设置主机地址："><a href="#host-设置主机地址：" class="headerlink" title="host 设置主机地址："></a><strong>host 设置主机地址：</strong></h6><p>默认值是 localhost；如果希望其他地方也可以访问，可以设置为 0.0.0.0；</p>
<h6 id="localhost-和-0-0-0-0-的区别："><a href="#localhost-和-0-0-0-0-的区别：" class="headerlink" title="localhost 和 0.0.0.0 的区别："></a><strong>localhost 和 0.0.0.0 的区别</strong>：</h6><ol>
<li>localhost：本质上是一个域名，通常情况下会被解析成 127.0.0.1;</li>
<li>127.0.0.1：回环地址(Loop Back Address)，表达的意思其实是我们主机自己发出去的包，直接被自己接收;<ul>
<li>正常的数据库包经常 应用层 - 传输层 - 网络层 - 数据链路层 - 物理层 ;</li>
<li>而回环地址，是在网络层直接就被获取到了，是不会经常数据链路层和物理层的;</li>
<li>比如我们监听 127.0.0.1 时，在同一个网段下的主机中，通过 ip 地址是不能访问的;</li>
</ul>
</li>
<li>0.0.0.0：监听 IPV4 上所有的地址，再根据端口找到不同的应用程序；比如我们监听 0.0.0.0 时，在同一个网段下的主机中，通过 ip 地址是可以访问的;</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802174005433.png" alt="image-20210802174005433"></p>
<h5 id="port、open、compress"><a href="#port、open、compress" class="headerlink" title="port、open、compress"></a>port、open、compress</h5><h6 id="prot"><a href="#prot" class="headerlink" title="prot"></a>prot</h6><p><strong>port 设置监听的端口，默认情况下是 8080</strong></p>
<h6 id="open"><a href="#open" class="headerlink" title="open"></a>open</h6><p><strong>open 是否打开浏览器：</strong></p>
<ol>
<li>默认值是 false，设置为 true 会打开浏览器；</li>
<li>也可以设置为类似于 Google Chrome 等值；</li>
</ol>
<h6 id="compress"><a href="#compress" class="headerlink" title="compress"></a>compress</h6><p><strong>compress 是否为静态文件开启 gzip compression：</strong></p>
<p>默认值是 false，可以设置为 true；</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802174040312.png" alt="image-20210802174040312"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802174054174.png" alt="image-20210802174054174"></p>
<h4 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h4><p><strong>proxy 是我们开发中非常常用的一个配置选项，它的目的设置代理来解决跨域访问的问题：</strong></p>
<p>比如我们的一个 api 请求是 <a href="http://localhost:8888，但是本地启动服务器的域名是">http://localhost:8888，但是本地启动服务器的域名是</a> <a href="http://localhost:8000，这">http://localhost:8000，这</a> 个时候发送网络请求就会出现跨域的问题；</p>
<p>那么我们可以将请求先发送到一个代理服务器，代理服务器和 API 服务器没有跨域的问题，就可以解决我们的跨 域问题了；</p>
<p><strong>我们可以进行如下的设置</strong></p>
<p><strong>target</strong>：表示的是代理到的目标地址，比如 /api-hy/moment 会被代理到 <a target="_blank" rel="noopener" href="http://localhost:8888/api-mhy/moment">http://localhost:8888/api-mhy/moment</a></p>
<p><strong>pathRewrite</strong>：默认情况下，我们的 /api-hy 也会被写入到 URL 中，如果希望删除，可以使用 pathRewrite；</p>
<p><strong>secure</strong>：默认情况下不接收转发到 https 的服务器上，如果希望支持，可以设置为 false；</p>
<p><strong>changeOrigin</strong>：它表示是否更新代理后请求的 headers 中 host 地址</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802174327012.png" alt="image-20210802174327012"></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 配置 proxy 代理 解决跨域问题</span>
    <span class="token comment">// 只适用于开发阶段</span>
    <span class="token comment">// 相当于请求交给本地服务器发送给远程的服务器</span>
    <span class="token comment">// 然后请求到的数据在给页面的请求</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 配置映射关系</span>
      <span class="token comment">// 相当于在项目中请求 /api地址 就是请求后面配置的地址</span>
      <span class="token string">"/api"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">"http://www.baidu.com"</span><span class="token punctuation">,</span>
        <span class="token comment">// 路径重写 将 /api开头的请求地址的 /api 给替换为 "" 空字符串</span>
        pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">"^/api"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 默认不支持 转发到https的服务器上，如果需要，设置 secure为false</span>
        secure<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token comment">// 是否更新代理后请求的headers中的host地址</span>
        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="changeOrigin-的解析"><a href="#changeOrigin-的解析" class="headerlink" title="changeOrigin 的解析"></a>changeOrigin 的解析</h4><p>这个 changeOrigin 官方说的非常模糊，通过查看源码我发现其实是要修改代理请求中的 headers 中的 host 属性：</p>
<ol>
<li>因为我们真实的请求，其实是需要通过 <a target="_blank" rel="noopener" href="http://localhost:8888/">http://localhost:8888</a> 来请求的；</li>
<li>但是因为使用了代码，默认情况下它的值时 <a href="http://localhost:8000；">http://localhost:8000；</a></li>
<li>如果我们需要修改，那么可以将 changeOrigin 设置为 true 即可；</li>
</ol>
<h3 id="resolve-模块解析"><a href="#resolve-模块解析" class="headerlink" title="resolve 模块解析"></a>resolve 模块解析</h3><p><strong>resolve 用于设置模块如何被解析：</strong></p>
<ol>
<li>在开发中我们会有各种各样的模块依赖，这些模块可能来自于自己编写的代码，也可能来自第三方库；</li>
<li>resolve 可以帮助 webpack 从每个 require/import 语句中，找到需要引入到合适的模块代码；</li>
<li>webpack 使用 enhanced-resolve 来解析文件路径；</li>
</ol>
<p><strong>webpack 能解析三种文件路径：</strong></p>
<p><strong>绝对路径</strong> :由于已经获得文件的绝对路径，因此不需要再做进一步解析。</p>
<p><strong>相对路径</strong></p>
<ol>
<li>在这种情况下，使用 import 或 require 的资源文件所处的目录，被认为是上下文目录；</li>
<li>在 import/require 中给定的相对路径，会拼接此上下文路径，来生成模块的绝对路径；</li>
</ol>
<p><strong>模块路径</strong></p>
<p>在 resolve.modules 中指定的所有目录检索模块；</p>
<ol>
<li>默认值是 [‘node_modules’]，所以默认会从 node_modules 中查找文件；</li>
<li>我们可以通过设置别名的方式来替换初识模块路径，具体后面讲解 alias 的配置；</li>
</ol>
<h5 id="确实文件还是文件夹"><a href="#确实文件还是文件夹" class="headerlink" title="确实文件还是文件夹"></a>确实文件还是文件夹</h5><p>如果是一个文件：</p>
<ol>
<li>如果文件具有扩展名，则直接打包文件；</li>
<li>否则，将使用 resolve.extensions 选项作为文件扩展名解析；</li>
</ol>
<p><strong>如果是一个文件夹：</strong></p>
<p>会在文件夹中根据 resolve.mainFiles 配置选项中指定的文件顺序查找；</p>
<ol>
<li>resolve.mainFiles 的默认值是 [‘index’]；</li>
<li>再根据 resolve.extensions 来解析扩展名</li>
</ol>
<h4 id="extensions-和-alias-配置"><a href="#extensions-和-alias-配置" class="headerlink" title="extensions 和 alias 配置"></a><strong>extensions 和 alias 配置</strong></h4><h5 id="extentions"><a href="#extentions" class="headerlink" title="extentions"></a>extentions</h5><p>extensions 是解析到文件时自动添加扩展名：</p>
<ol>
<li>默认值是 [‘.wasm’, ‘.mjs’, ‘.js’, ‘.json’]；</li>
<li>所以如果我们代码中想要添加加载 .vue 或者 jsx 或者 ts 等文件时，我们必须自己写上扩展名；</li>
</ol>
<h5 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h5><p><strong>另一个非常好用的功能是配置别名 alias</strong></p>
<ol>
<li>特别是当我们项目的目录结构比较深的时候，或者一个文件的路径可能需要 ../../../这种路径片段；</li>
<li>我们可以给某些常见的路径起一个别名；</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802174852517.png" alt="image-20210802174852517"></p>
<h3 id="如何区分开发环境"><a href="#如何区分开发环境" class="headerlink" title="如何区分开发环境"></a>如何区分开发环境</h3><p><strong>目前我们所有的 webpack 配置信息都是放到一个配置文件中的：webpack.config.js</strong></p>
<ol>
<li>当配置越来越多时，这个文件会变得越来越不容易维护；</li>
<li>并且某些配置是在开发环境需要使用的，某些配置是在生成环境需要使用的，当然某些配置是在开发和生成环 境都会使用的；</li>
<li>所以，我们最好对配置进行划分，方便我们维护和管理；</li>
</ol>
<p>那么，在启动时如何可以区分不同的配置呢？</p>
<ol>
<li><strong>方案一</strong>：编写两个不同的配置文件，开发和生成时，分别加载不同的配置文件即可；</li>
<li><strong>方式二</strong>：使用相同的一个入口配置文件，通过设置参数来区分它们；</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802175011294.png" alt="image-20210802175011294"></p>
<h4 id="入口文件解析"><a href="#入口文件解析" class="headerlink" title="入口文件解析"></a>入口文件解析</h4><p>我们之前编写入口文件的规则是这样的：./src/index.js，但是如果我们的配置文件所在的位置变成了 config 目录， 我们是否应该变成 ../src/index.js 呢</p>
<ol>
<li>如果我们这样编写，会发现是报错的，依然要写成 ./src/index.js；</li>
<li>这是因为入口文件其实是和另一个属性时有关的 context</li>
</ol>
<p>context 的作用是用于解析入口（entry point）和加载器（loader）：</p>
<p>官方说法：默认是当前路径（但是经过我测试，默认应该是 webpack 的启动目录）</p>
<p>另外推荐在配置中传入一个值；</p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802175152242.png" alt="image-20210802175152242"></p>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802175158275.png" alt="image-20210802175158275"></p>
<h4 id="区分开发和生成环境配置"><a href="#区分开发和生成环境配置" class="headerlink" title="区分开发和生成环境配置"></a>区分开发和生成环境配置</h4><p><strong>这里我们创建三个文件：</strong></p>
<ol>
<li>webpack.common.js</li>
<li>webpack.prod.js</li>
<li>webpack.dev.js</li>
</ol>
<p><img src="https://gitee.com/mao0826/picture/raw/master/images/web/vue/image-20210802175252457.png" alt="image-20210802175252457"></p>
<p><strong>将公共代码和生产环境的配置以及开发时的配置分开，然后使用 webpack-merge 插件进行配置文件的合并。</strong></p>
<p><strong>webpack.common.js</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 公共的环境</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"html-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> DefinePlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"webpack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 引入Vue-loader的插件 帮助loader做一些事情</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> VueLoaderPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"vue-loader/dist/index"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">"./src/index.js"</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"../build"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">"bundle.js"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"style-loader"</span><span class="token punctuation">,</span> <span class="token string">"css-loader"</span><span class="token punctuation">,</span> <span class="token string">"postcss-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"style-loader"</span><span class="token punctuation">,</span> <span class="token string">"css-loader"</span><span class="token punctuation">,</span> <span class="token string">"postcss-loader"</span><span class="token punctuation">,</span> <span class="token string">"less-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 处理图片</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpe?g|JPG)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">"asset"</span><span class="token punctuation">,</span>
        generator<span class="token operator">:</span> <span class="token punctuation">{</span>
          filename<span class="token operator">:</span> <span class="token string">"image/[name]-[hash:6][ext]"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        parser<span class="token operator">:</span> <span class="token punctuation">{</span>
          dataUrlCondition<span class="token operator">:</span> <span class="token punctuation">{</span>
            maxSize<span class="token operator">:</span> <span class="token number">40</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(eot|ttf|woff2?)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">"asset/resource"</span><span class="token punctuation">,</span>
        generator<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 这里使用的是filename属性 别忘了！！！！！</span>
          filename<span class="token operator">:</span> <span class="token string">"font/[name]-[hash:6][ext]"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 对js代码进行转换</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">"babel-loader"</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 配置 .vue文件的加载打包规则</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">"vue-loader"</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 要注意：相对路径是从项目根路径出发的，！！！！！！！！！！！</span>
      template<span class="token operator">:</span> <span class="token string">"./public/index.html"</span><span class="token punctuation">,</span>
      title<span class="token operator">:</span> <span class="token string">"babel 学习！"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token constant">BASE_URL</span><span class="token operator">:</span> <span class="token string">"'./'"</span><span class="token punctuation">,</span>
      __VUE_OPTIONS_API__<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      __VUE_PROD_DEVTOOLS__<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// resolve 模块解析</span>
  <span class="token comment">// 用于设置模块如何被解析</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 默认值就是 node_modules</span>
    modules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"node_modules"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// 文件拓展名 默认值有js mjs json wasm</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">".js"</span><span class="token punctuation">,</span> <span class="token string">".ts"</span><span class="token punctuation">,</span> <span class="token string">".json"</span><span class="token punctuation">,</span> <span class="token string">".vue"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// 如果加载的模块是一个文件夹 会自动去文件夹里面的 index.xx 文件来加载</span>
    mainFiles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"index"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// 配置路径的别名</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 在路径的地方使用的js，就代表后面的这个路径</span>
      js<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"../src/js"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 打包的是node环境 还是 web 环境</span>
  target<span class="token operator">:</span> <span class="token string">"web"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>webpack.prod.js</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 生产环境</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"clean-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> CopyPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"copy-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 合并当前环境和公共的common环境 使用 webpack-merge插件</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> merge <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"webpack-merge"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 导入 公共环境的配置</span>
<span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./webpack.common"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">"production"</span><span class="token punctuation">,</span>
  devtool<span class="token operator">:</span> <span class="token string">"eval"</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CopyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      patterns<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          from<span class="token operator">:</span> <span class="token string">"public"</span><span class="token punctuation">,</span>
          globOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
            ignore<span class="token operator">:</span> <span class="token string">"**/index.html"</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>webpack.dev.js</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 开发环境</span>

<span class="token comment">// 合并当前环境和公共的common环境 使用 webpack-merge插件</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> merge <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"webpack-merge"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 导入 公共环境的配置</span>
<span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./webpack.common"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">"development"</span><span class="token punctuation">,</span>
  devtool<span class="token operator">:</span> <span class="token string">"source-map"</span><span class="token punctuation">,</span>

  <span class="token comment">// 热部署（热更新）的配置</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果需要的资源没有在webpack里面加载到，会去contentBase指定的文件夹里面寻找</span>
    contentBase<span class="token operator">:</span> <span class="token string">"../public"</span><span class="token punctuation">,</span>
    <span class="token comment">// 开启HMR 热模块替换 (最好配置一下target属性，跟DevServer同级)</span>
    hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 设置ip地址 主机</span>
    host<span class="token operator">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>
    <span class="token comment">// 端口号</span>
    port<span class="token operator">:</span> <span class="token number">8800</span><span class="token punctuation">,</span>
    <span class="token comment">// 是否在服务启动时打开浏览器</span>
    open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 开启 gzip压缩 传输速率提高(一般html这种文件不会压缩)</span>
    compress<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

    <span class="token comment">// 配置 proxy 代理 解决跨域问题</span>
    <span class="token comment">// 只适用于开发阶段</span>
    <span class="token comment">// 相当于请求交给本地服务器发送给远程的服务器</span>
    <span class="token comment">// 然后请求到的数据在给页面的请求</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 配置映射关系</span>
      <span class="token comment">// 相当于在项目中请求 /api地址 就是请求后面配置的地址</span>
      <span class="token string">"/api"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">"http://www.baidu.com"</span><span class="token punctuation">,</span>
        <span class="token comment">// 路径重写 将 /api开头的请求地址的 /api 给替换为 "" 空字符串</span>
        pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">"^/api"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 默认不支持 转发到https的服务器上，如果需要，设置 secure为false</span>
        secure<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token comment">// 是否更新代理后请求的headers中的host地址</span>
        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">毛毛</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://maolovecoding.github.io/2021/11/05/src/vue/webpack/">https://maolovecoding.github.io/2021/11/05/src/vue/webpack/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">毛毛</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/vue3/">
                                    <span class="chip bg-color">vue3</span>
                                </a>
                            
                                <a href="/tags/ts/">
                                    <span class="chip bg-color">ts</span>
                                </a>
                            
                                <a href="/tags/webpack/">
                                    <span class="chip bg-color">webpack</span>
                                </a>
                            
                                <a href="/tags/loader/">
                                    <span class="chip bg-color">loader</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2021/11/06/src/vue/vuex/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/3.jpg" class="responsive-img" alt="vuex--状态管理篇">
                        
                        <span class="card-title">vuex--状态管理篇</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-11-06
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/vue/" class="post-category">
                                    vue
                                </a>
                            
                            <a href="/categories/vue/vuex/" class="post-category">
                                    vuex
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/vue3/">
                        <span class="chip bg-color">vue3</span>
                    </a>
                    
                    <a href="/tags/ts/">
                        <span class="chip bg-color">ts</span>
                    </a>
                    
                    <a href="/tags/webpack/">
                        <span class="chip bg-color">webpack</span>
                    </a>
                    
                    <a href="/tags/vuex/">
                        <span class="chip bg-color">vuex</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/11/05/src/vue/vuecli-vite/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/23.jpg" class="responsive-img" alt="Vue-CLI 和 Vite &amp; 尤大大新宠">
                        
                        <span class="card-title">Vue-CLI 和 Vite &amp; 尤大大新宠</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-11-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/vue/" class="post-category">
                                    vue
                                </a>
                            
                            <a href="/categories/vue/vite/" class="post-category">
                                    vite
                                </a>
                            
                            <a href="/categories/vue/vite/vue-cli/" class="post-category">
                                    vue-cli
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/vue3/">
                        <span class="chip bg-color">vue3</span>
                    </a>
                    
                    <a href="/tags/ts/">
                        <span class="chip bg-color">ts</span>
                    </a>
                    
                    <a href="/tags/webpack/">
                        <span class="chip bg-color">webpack</span>
                    </a>
                    
                    <a href="/tags/vueCli/">
                        <span class="chip bg-color">vueCli</span>
                    </a>
                    
                    <a href="/tags/vite/">
                        <span class="chip bg-color">vite</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('80')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 听雨少年的博客<br />'
            + '文章作者: 毛毛<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('1'),
            headingSelector: 'h2, h3, h4, H5'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4, H5').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
  
  <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

  
  <div class="container row center-align"
    style="margin-bottom: 0px !important;">
    <div class="col s12 m8 l8 copy-right">
      Copyright&nbsp;&copy;
      
      <span id="year">2019-2021</span>
      
      <span id="year">2019</span>
      <a href="/about" target="_blank">毛毛</a>
      |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
      |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
      <br>
      
      
      
      
      
      
      <span id="busuanzi_container_site_pv">
        |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
          class="white-color"></span>&nbsp;次
      </span>
      
      
      <span id="busuanzi_container_site_uv">
        |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
          class="white-color"></span>&nbsp;人
      </span>
      
      <br>
      
      <br>
      
    </div>
    <div class="col s12 m4 l4 social-link social-statis">
  <!-- https://github.com/maolovecoding -->
    <a href="https://github.com/maolovecoding/" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto: 1339065735@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>


<!-- 

 -->


    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1339065735" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1339065735" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>

<!-- 
 -->

<!--  -->


    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
  </div>
</footer>

<div class="progress-bar"></div>

    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
