<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="微信小程序--入门篇, 毛毛的博客">
    <meta name="description" content="Java,Spring,SpringBoot,Vue.js,Node.js,JUC,数据结构和算法,TypeScript,JavaScript">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>微信小程序--入门篇 | 毛毛的博客</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="毛毛的博客" type="application/atom+xml">
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/favicon.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">毛毛的博客</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/favicon.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">毛毛的博客</div>
        <div class="logo-desc">
            
            Java,Spring,SpringBoot,Vue.js,Node.js,JUC,数据结构和算法,TypeScript,JavaScript
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/maolovecoding/" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/maolovecoding/" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/photo1/5.jpeg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">微信小程序--入门篇</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/JavaScript/">
                                <span class="chip bg-color">JavaScript</span>
                            </a>
                        
                            <a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/">
                                <span class="chip bg-color">微信小程序</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" class="post-category">
                                微信小程序
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-11-02
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="微信小程序入门-一"><a href="#微信小程序入门-一" class="headerlink" title="微信小程序入门(一)"></a>微信小程序入门(一)</h1><h2 id="项目结构解读"><a href="#项目结构解读" class="headerlink" title="项目结构解读"></a>项目结构解读</h2><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210823172509428.png" alt="image-20210823172509428"></p>
<p><strong>我们发现，页面页面一般有 4 个文件组成</strong></p>
<h3 id="每个文件的功能"><a href="#每个文件的功能" class="headerlink" title="每个文件的功能"></a>每个文件的功能</h3><h4 id="xxx-js-index-js-文件"><a href="#xxx-js-index-js-文件" class="headerlink" title="xxx.js(index.js)文件"></a>xxx.js(index.js)文件</h4><p>该文件完成业务逻辑的书写。</p>
<h4 id="xxx-json-index-json"><a href="#xxx-json-index-json" class="headerlink" title="xxx.json(index.json)"></a>xxx.json(index.json)</h4><p>该文件用来进行一些页面的配置。<strong>有些时候我们不需要书写样式等代码，而是在 json 文件里面进行一定的配置，就可以达到我们想要的效果。比如：我们修改一下顶部导航栏的颜色，就可以在 JSON 文件里面配置。这种配置机制在我们前端的开发中不常见。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210823173430156.png" alt="image-20210823173430156"></p>
<h4 id="xxx-wxml-index-wxml"><a href="#xxx-wxml-index-wxml" class="headerlink" title="xxx.wxml(index.wxml)"></a>xxx.wxml(index.wxml)</h4><p>该文件用来书写页面的骨架。类似于 html。</p>
<h4 id="xxx-wxss-index-wxss"><a href="#xxx-wxss-index-wxss" class="headerlink" title="xxx.wxss(index.wxss)"></a>xxx.wxss(index.wxss)</h4><p>该文件用来书写页面的样式。类似于 css。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p><strong>其实，这四个文件并不都是必须都要存在的，比如我们的页面每页样式，那么 wxss 文件就不是必须的。所以说，除了页面的骨架 wxml，其他文件都不是必须的。</strong></p>
<h4 id="文件约定"><a href="#文件约定" class="headerlink" title="文件约定"></a>文件约定</h4><p>如果我们这个页面的四个文件的<strong>名称相同（后缀不同）</strong>，都是 index.后缀的文件，那么我们文件之间的相互调用是不需要进行导入的。而是可以直接使用其他文件的内容。</p>
<p><strong>综上所述：我们建立一个新的页面最好也采用这种约定速成的方式。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210823194921750.png" alt="image-20210823194921750"></p>
<h2 id="文档结构解读"><a href="#文档结构解读" class="headerlink" title="文档结构解读"></a>文档结构解读</h2><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210823195321883.png" alt="image-20210823195321883"></p>
<p><strong>文件 app.js,app.json,app.wxss</strong>这三个文件的名称是不能修改的。作用和上面相同文件类型的作用一样。但是这三个文件可以控制整个微信小程序（也就是应用程序级别的）的样式和业务逻辑等。而上面介绍的文件只能控制所属的页面。</p>
<p><strong>虽然这三个文件配置的样式等是全局的，但是如果配置的全局样式和局部样式有冲突，以页面的局部样式为主。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210823201416273.png" alt="image-20210823201416273"></p>
<p><strong>文件 project.config.json 是用来记录当前项目的配置，设置的。</strong></p>
<p><strong>sitemap.json 是来做微信小程序搜索的。暂时不做了解。</strong></p>
<h2 id="小程序入门"><a href="#小程序入门" class="headerlink" title="小程序入门"></a>小程序入门</h2><h3 id="删除项目结构"><a href="#删除项目结构" class="headerlink" title="删除项目结构"></a>删除项目结构</h3><p>首先我们删除项目中的其他文件，只保留 <strong>project.config.json，sitemap.json</strong>这两个文件</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824194736652.png" alt="image-20210824194736652"></p>
<h3 id="小程序页面的搭建技巧和规则"><a href="#小程序页面的搭建技巧和规则" class="headerlink" title="小程序页面的搭建技巧和规则"></a>小程序页面的搭建技巧和规则</h3><p><strong>当我们删除项目结构，只保留这两个文件以后，发现在调试区域会报错。提醒我们没有 app.json 文件。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824194937369.png" alt="image-20210824194937369"></p>
<p>上面我们说过，app.json 文件是在微信小程序开发项目中，必须存在的文件。</p>
<h4 id="新建-app-json"><a href="#新建-app-json" class="headerlink" title="新建 app.json"></a>新建 app.json</h4><ol>
<li>新建 json 文件以后，会提醒我们 json 文件不能为空</li>
</ol>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824195055273.png" alt="image-20210824195055273"></p>
<ol start="2">
<li>写一个空的花括号以后，会报错提醒我们，必须有 pages 属性，且 pages 属性必须为数组。（页面肯定不止一个，注意：json 文件里面不可写注释。小程序的页面<strong>只有在 app.json 里面注册</strong>以后才能被访问。）</li>
</ol>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824195147707.png" alt="image-20210824195147707"></p>
<ol start="3">
<li><p>有该属性后，一样报错。很明显，找不到页面。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824195611804.png" alt="image-20210824195611804"></p>
</li>
<li><p>新建页面，新建 pages 文件夹，在下面再建 index 文件夹。我们知道了每个页面都有四个文件，但是我们需要一个个新建吗？不需要的。只需要邮件单击 index 文件夹，然后点新建 page，填写文件名称即可，不需要写后缀，自动帮我们建好四个文件。且在 app.json 文件的 pages 属性里面完成了页面的注册。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824195817986.png" alt="image-20210824195817986"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824195918872.png" alt="image-20210824195918872"></p>
</li>
</ol>
<p><strong>注意：页面文件只需要写 index，小程序会默认帮我们找到名称为 index 的四个文件。</strong>且小程序的默认首页就是第一个注册的页面。</p>
<p><strong>例如，我们在新建一个 welcome 页面，并将其第一个注册，放在 index 页面前面，发现默认页面就是 welcome 了</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824200448529.png" alt="image-20210824200448529"></p>
<h3 id="小程序必备语法"><a href="#小程序必备语法" class="headerlink" title="小程序必备语法"></a>小程序必备语法</h3><h4 id="1-如何显示一张图片"><a href="#1-如何显示一张图片" class="headerlink" title="1. 如何显示一张图片"></a>1. 如何显示一张图片</h4><p>**我们指知道，在 html 中，可以使用 img 标签来显示图片，在小程序中，我们使用的是<code>&lt;image&gt;&lt;/image&gt;</code>**标签。使用 src 属性引用图片。</p>
<h4 id="2-文本"><a href="#2-文本" class="headerlink" title="2. 文本"></a>2. 文本</h4><p>使用<code>&lt;text&gt;&lt;/text&gt;</code>标签包裹我们想要显示的文字。</p>
<h4 id="3-按钮"><a href="#3-按钮" class="headerlink" title="3. 按钮"></a>3. 按钮</h4><p>和 html 一样，都是使用<code>&lt;button&gt;&lt;/button&gt;</code>标签</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824205741605.png" alt="image-20210824205741605"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824205801133.png" alt="image-20210824205801133"></p>
<p><strong>我们发现：这个头像是椭圆形的，而实际上我们的头像图片是圆形的。为什么默认情况变成的椭圆形？思考一下</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824205924061.png" alt="image-20210824205924061"></p>
<h4 id="单位-rpx"><a href="#单位-rpx" class="headerlink" title="单位 rpx"></a>单位 rpx</h4><p>我们在微信小程序里面，设置样式的时候，推荐使用 rpx 单位，而不是 px 单位。</p>
<p>因为：<strong>单位：rpx 会自适应屏幕的尺寸等，给我们一种很舒服的视觉体验，换了机型会自适应大小</strong>。而使用 px 为单位，就会固定死大小，即使切换了机型，分辨率发生了改变，大小也不会改变。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 1. 显示图片的标签 --&gt;</span>
<span class="token comment">&lt;!-- 可以使用相对路径，也可以使用绝对路径 --&gt;</span>
<span class="token comment">&lt;!-- 单位：rpx 会自适应屏幕的尺寸等，给我们一种很舒服的视觉体验，换了机型会自适应大小 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/avatar/1.webp<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>220rpx<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>220rpx</span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 2. 显示文本的标签 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>你好：听雨少年！<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 直接书写文本，也可以正常显示，但是我们建议还是使用text标签进行包裹，遵守规范，而且没有标签包裹，我们也难以设置样式 --&gt;</span>
<span class="token comment">&lt;!-- 我也直接显示了！ --&gt;</span>
<span class="token comment">&lt;!-- 按钮标签 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>我是按钮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>当然，你也可以选择使用 px 为单位，但是我们需要在设置大小的时候，将数值设置为图片实际大小的 1/2。这是建立在以 iPhone6 机型为原型图的基础上。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824211637841.png" alt="image-20210824211637841"></p>
<p><strong>回到开始的问题：头像在默认情况下为什么变成椭圆形或者不是我们图片默认的形状？</strong></p>
<p>因为：image 标签（组件）有默认样式</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824212929910.png" alt="image-20210824212929910"></p>
<p><strong>图片建议使用 png 格式！！！</strong></p>
<h3 id="完成第一个页面布局"><a href="#完成第一个页面布局" class="headerlink" title="完成第一个页面布局"></a>完成第一个页面布局</h3><h4 id="配置小程序导航头部样式"><a href="#配置小程序导航头部样式" class="headerlink" title="配置小程序导航头部样式"></a>配置小程序导航头部样式</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824221823793.png" alt="image-20210824221823793"></p>
<p>我们觉得这种默认的样式很难看，可以在 app.json 文件里面配置这个头部的样式</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"window"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"navigationBarBackgroundColor"</span><span class="token operator">:</span> <span class="token string">"#b3d4db"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824221930523.png" alt="image-20210824221930523"></p>
<h4 id="页面样式"><a href="#页面样式" class="headerlink" title="页面样式"></a>页面样式</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210824222839536.png" alt="image-20210824222839536"></p>
<h4 id="页面样式代码"><a href="#页面样式代码" class="headerlink" title="页面样式代码"></a>页面样式代码</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--pages/welcome/welcome.wxml--&gt;</span>

<span class="token comment">&lt;!-- 使用view标签，作为最外层容器，包裹所有标签，view不是有具体含义的标签 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 1. 显示图片的标签 --&gt;</span>
  <span class="token comment">&lt;!-- 可以使用相对路径，也可以使用绝对路径 --&gt;</span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user-avatar<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/avatar/avatar.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 2. 显示文本的标签 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>motto<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>听雨少年<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 直接书写文本，也可以正常显示，但是我们建议还是使用text标签进行包裹，遵守规范，而且没有标签包裹，我们也难以设置样式 --&gt;</span>
  <span class="token comment">&lt;!-- 我也直接显示了！ --&gt;</span>
  <span class="token comment">&lt;!-- 按钮标签 --&gt;</span>
  <span class="token comment">&lt;!-- 官方的提供的按钮我们一般不推荐使用，因为样式等问题很难修正 --&gt;</span>
  <span class="token comment">&lt;!-- &lt;button&gt;我是按钮&lt;/button&gt; --&gt;</span>

  <span class="token comment">&lt;!-- 这里使用view模拟一个button组件 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-journey-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 设置样式模拟出我们喜欢的按钮样式 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>journey<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>开启小程序之旅<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* pages/welcome/welcome.wxss */</span>

<span class="token comment">/* 单位：rpx 会自适应屏幕的尺寸等，给我们一种很舒服的视觉体验，换了机型 会自适应大小 */</span>
<span class="token comment">/* 顶层容器page，设置背景色 */</span>
<span class="token selector">page</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #b3d4db<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 外层容器 */</span>
<span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 开启弹性布局 */</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token comment">/* 排列方向，垂直排列 */</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token comment">/* 在排列方向的侧轴上居中 */</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 设置头像样式 */</span>
<span class="token selector">.user-avatar</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 220rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 220rpx<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 50% 50%<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 160rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 昵称 */</span>
<span class="token selector">.motto</span> <span class="token punctuation">{</span>
  <span class="token comment">/* color:#666; */</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 36rpx<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 设置模拟的按钮外边框 */</span>
<span class="token selector">.btn-journey-container</span> <span class="token punctuation">{</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 150rpx<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1rpx solid #405f80<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 200rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 80rpx<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
  <span class="token comment">/* 文字居中 */</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 按钮文字 */</span>
<span class="token selector">.journey</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 24rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #405f80<span class="token punctuation">;</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> 80rpx<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* app.wxss */</span>
<span class="token selector">text</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="微信小程序入门-二"><a href="#微信小程序入门-二" class="headerlink" title="微信小程序入门(二)"></a>微信小程序入门(二)</h1><h2 id="安装组件库"><a href="#安装组件库" class="headerlink" title="安装组件库"></a>安装组件库</h2><p><strong>在微信小程序里面，现在也可以使用第三方的组件库。</strong></p>
<p><strong>这里使用的是 lin-ui 组件库。有需要的可以去百度官网了解一下。</strong></p>
<ol>
<li><p>在项目根目录下初始化 npm</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm init -y<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>安装 <strong>lin-ui</strong>组件库</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install lin-ui<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>在微信小程序的 <strong>工具</strong>选项下选择构建 npm</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826140635548.png" alt="image-20210826140635548"></p>
</li>
<li><p>构建完成够，项目下就又多出一个文件夹。我们使用组件的时候都是使用这个文件夹下的。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826140736290.png" alt="image-20210826140736290"></p>
</li>
<li><p>在每个页面使用自定义组件的时候，我们需要在页面的 json 配置文件中，进行配置，指定我们使用的组件名称，以及组件所在的位置。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826140906964.png" alt="image-20210826140906964"></p>
</li>
</ol>
<h2 id="组件库的使用"><a href="#组件库的使用" class="headerlink" title="组件库的使用"></a>组件库的使用</h2><h3 id="头像组件库"><a href="#头像组件库" class="headerlink" title="头像组件库"></a>头像组件库</h3><p><strong>这里简单使用一下头像组件库。</strong></p>
<pre class="line-numbers language-wxml" data-language="wxml"><code class="language-wxml">&lt;!-- 使用组件库 动态绑定用户的头像，昵称(绑定的语法后面再说) --&gt;
&lt;!-- 使用size属性可以指定大小 --&gt;
&lt;!-- shape属性可以指定头像的样式，圆的还是方的 --&gt;
&lt;!-- 使用placement 可以指定头像和昵称的排列位置，这里上下排列 --&gt;
&lt;m-avatar placement="bottom" size="190" shape="circle" open-data="{{['userAvatarUrl','userNickName']}}"/&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826142528576.png" alt="image-20210826142528576"></p>
<h2 id="pages-页面的开发"><a href="#pages-页面的开发" class="headerlink" title="pages 页面的开发"></a>pages 页面的开发</h2><h3 id="指定主页"><a href="#指定主页" class="headerlink" title="指定主页"></a>指定主页</h3><p><strong>每次开发新的页面，总是需要在注册页面的地方频繁切换第一个文件，来达到预览的效果。比较麻烦。</strong></p>
<h4 id="方式一："><a href="#方式一：" class="headerlink" title="方式一："></a>方式一：</h4><p><strong>在现在的小程序中，增加了新的功能，可以在 app.json 中，直接指定主页。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826143250347.png" alt="image-20210826143250347"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826143741895.png" alt="image-20210826143741895"></p>
<h4 id="方式二：指定编译模式"><a href="#方式二：指定编译模式" class="headerlink" title="方式二：指定编译模式"></a>方式二：指定编译模式</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826143942233.png" alt="image-20210826143942233"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826144021270.png" alt="image-20210826144021270"></p>
<p><strong>将页面指定为我们当前开发的页面即可。</strong></p>
<h3 id="制作轮播图"><a href="#制作轮播图" class="headerlink" title="制作轮播图"></a>制作轮播图</h3><h4 id="使用-swipe"><a href="#使用-swipe" class="headerlink" title="使用 swipe"></a>使用 swipe</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 使用官方提供的swiper组件 来做轮播图 --&gt;</span>
<span class="token comment">&lt;!-- swiper 滑块视图容器，这个容器不仅仅是用来滑动图片，可以做很多事情 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>swiper</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 一般为了让图片撑满容器，需要设置容器的大小，和图片的大小，swipe-item 可以不设置 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>swiper-item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/img1.jpg<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>swiper-item</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>swiper-item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/img2.webp<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>swiper-item</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>swiper-item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/img3.webp<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>swiper-item</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>swiper</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* 设置轮播图的大小 */</span>
<span class="token selector">swiper</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 460rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">image</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826153441612.png" alt="image-20210826153441612"></p>
<p><strong>这样就完成了轮播图最开始的状态。</strong></p>
<h4 id="轮播图的指示点和自动轮播"><a href="#轮播图的指示点和自动轮播" class="headerlink" title="轮播图的指示点和自动轮播"></a>轮播图的指示点和自动轮播</h4><p><strong>我们使用 swiper 的某些属性就可以完成这两个功能。</strong></p>
<p>indicator-dots=”true” 显示轮播图的指示点</p>
<p>但是，即使我们设置 indicator-dots=”false” 也就是设置属性值为 false</p>
<p>我们的轮播图小指示点 也不会消失，除非我们不设置这个属性，或者</p>
<p>我们设置属性值为 indicator-dots=”false“</p>
<p>那么问题来了：<strong>为什么我们设置属性值为 false 才能表示否定的概念呢？</strong></p>
<p>原因是，不加双花括号，我们小程序会把这个属性值当做普通的字符串，普通的字符串在 js 中我们知道会转为 true，这里也是一样。</p>
<p>双花括号里面写 false 才能表示 false</p>
<p>注意：关于双花括号的使用我们在后面会在说，<strong>实际上双花括号里面的数据会被当做 js 中的变量或者表达式进行运算。</strong></p>
<p>只写属性值也会默认表示设置这个属性值为 true。</p>
<h5 id="布尔属性赋值建议"><a href="#布尔属性赋值建议" class="headerlink" title="布尔属性赋值建议"></a>布尔属性赋值建议</h5><p>所以，我们在给布尔类型的属性赋值的时候，不管是 true 还是 false，建议都使用双花括号进行包裹。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826162313843.png" alt="image-20210826162313843"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826162335200.png" alt="image-20210826162335200"></p>
<h4 id="其他的-swiper-常用属性"><a href="#其他的-swiper-常用属性" class="headerlink" title="其他的 swiper 常用属性"></a>其他的 swiper 常用属性</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826163241249.png" alt="image-20210826163241249"></p>
<p><strong>这些属性在微信小程序的官网都是有说明的。想了解更多可以去官网自行阅读。</strong></p>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/swiper.html">微信小程序的 swiper 组件的使用</a></p>
<h3 id="单篇文章的制作"><a href="#单篇文章的制作" class="headerlink" title="单篇文章的制作"></a>单篇文章的制作</h3><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826172517962.png" alt="image-20210826172517962"></p>
<p><strong>我们要完成这样的一篇文章。我们分析一下整体的结构。</strong></p>
<ol>
<li>上面的轮播图我们已经制作完成了，那么就剩下文章的制作</li>
<li>这个文章从上到下，我们可以分为五个部分<ol>
<li>头像+日期部分</li>
<li>文章标题部分</li>
<li>文章图片</li>
<li>文章内容</li>
<li>浏览和收藏人数</li>
</ol>
</li>
<li>分为了五个部分，我们在开始制作这个文章模块。</li>
</ol>
<p><strong>先分析好我们制作页面的模块结构，在书写代码效率更高。</strong></p>
<h4 id="文章结构"><a href="#文章结构" class="headerlink" title="文章结构"></a>文章结构</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html">!-- 第一篇文章 --&gt;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第一部分 作者 日期 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-author-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 头像 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-author<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/avatar/1.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>2021 08 26<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第二部分 文章标题 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>2021 哈哈哈哈哈哈哈啊哈哈哈哈哈<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第三部分 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/post/cat.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第四部分 文章内容 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-content<span class="token punctuation">"</span></span>
    <span class="token punctuation">&gt;</span></span>滑块视图容器，这个容器不仅仅是用来滑动图片，可以做很多事情,滑块视图容器，这个容器不仅仅是用来滑动图片，可以做很多事情,滑块视图容器，这个容器不仅仅是用来滑动图片，可以做很多事情,滑块视图容器，这个容器不仅仅是用来滑动图片，可以做很多事情<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span>
  <span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第五部分 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/icon/chat.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>92<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/icon/view.png<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>102<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="文章样式"><a href="#文章样式" class="headerlink" title="文章样式"></a>文章样式</h4><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* 文章样式 */</span>
<span class="token selector">.post-container</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 弹性布局 */</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token comment">/* 上下边框线 */</span>
  <span class="token property">border-top</span><span class="token punctuation">:</span> 1rpx solid #ededed<span class="token punctuation">;</span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1rpx solid #ededed<span class="token punctuation">;</span>
  <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 作者 日期样式 */</span>
<span class="token selector">.post-author-date</span> <span class="token punctuation">{</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 10rpx 0 20rpx 10rpx<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token comment">/* flex 布局居中方案 */</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.post-author</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 60rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 60rpx<span class="token punctuation">;</span>
  <span class="token comment">/* 头像和文字居中 */</span>
  <span class="token comment">/* vertical-align: middle; */</span>
<span class="token punctuation">}</span>

<span class="token selector">.post-date</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 26rpx<span class="token punctuation">;</span>
  <span class="token comment">/* vertical-align: middle; */</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 文章标题 */</span>
<span class="token selector">.post-title</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 34rpx<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> 700<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 文章主图 */</span>
<span class="token selector">.post-image</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 340rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 文章内容 */</span>
<span class="token selector">.post-content</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">letter-spacing</span><span class="token punctuation">:</span> 2rpx<span class="token punctuation">;</span>
  <span class="token property">text-indent</span><span class="token punctuation">:</span> 2em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 文章模拟阅读量 */</span>
<span class="token selector">.post-like</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 26rpx<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.post-like-image</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 32rpx<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 32rpx<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 16rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.post-like-font</span> <span class="token punctuation">{</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 26rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="整体代码"><a href="#整体代码" class="headerlink" title="整体代码"></a>整体代码</h3><h4 id="页面结构"><a href="#页面结构" class="headerlink" title="页面结构"></a>页面结构</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--pages/posts/posts.wxml--&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 使用官方提供的swiper组件 来做轮播图 --&gt;</span>
  <span class="token comment">&lt;!-- swiper 滑块视图容器，这个容器不仅仅是用来滑动图片，可以做很多事情 --&gt;</span>
  <span class="token comment">&lt;!-- 
    indicator-dots="true" 显示轮播图的指示点
    但是，即使我们设置 indicator-dots="false" 也就是设置属性值为false
    我们的轮播图小指示点 也不会消失，除非我们不设置这个属性，或者
    我们设置属性值为 indicator-dots="{{false}}"
    那么问题来了：为什么我们设置属性值为 {{false}} 才能表示否定的概念呢？
    原因是，不加双花括号，我们小程序会把这个属性值当做普通的字符串，普通的字符串在js中我们知道会转为true，这里也是一样。
    双花括号里面写false 才能表示false
    注意：关于双花括号的使用我们在后面会在说，实际上双花括号里面的数据会被当做js中的变量或者表达式进行运算。
   --&gt;</span>
  <span class="token comment">&lt;!-- autoplay="true" 自动轮播 --&gt;</span>
  <span class="token comment">&lt;!-- indicator-active-color="#fff" 指示点激活的颜色 --&gt;</span>
  <span class="token comment">&lt;!-- circular="true"循环播放图片 --&gt;</span>
  <span class="token comment">&lt;!-- interval="2000" 图片切换间隔时长 字符串的数字内部会被转型 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>swiper</span>
    <span class="token attr-name">indicator-dots</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{true}}<span class="token punctuation">"</span></span>
    <span class="token attr-name">autoplay</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
    <span class="token attr-name">indicator-active-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#fff<span class="token punctuation">"</span></span>
    <span class="token attr-name">circular</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
    <span class="token attr-name">interval</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2000<span class="token punctuation">"</span></span>
  <span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 一般为了让图片撑满容器，需要设置容器的大小，和图片的大小，swipe-item 可以不设置 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>swiper-item</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/img1.jpg<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>swiper-item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>swiper-item</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/img2.webp<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>swiper-item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>swiper-item</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/img3.webp<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>swiper-item</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>swiper</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- pages --&gt;</span>

  <span class="token comment">&lt;!-- 第一篇文章 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 第一部分 作者 日期 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-author-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 头像 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-author<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/avatar/1.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>2021 08 26<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 第二部分 文章标题 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>2021 哈哈哈哈哈哈哈啊哈哈哈哈哈<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 第三部分 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/post/cat.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 第四部分 文章内容 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-content<span class="token punctuation">"</span></span>
      <span class="token punctuation">&gt;</span></span>滑块视图容器，这个容器不仅仅是用来滑动图片，可以做很多事情,滑块视图容器，这个容器不仅仅是用来滑动图片，可以做很多事情,滑块视图容器，这个容器不仅仅是用来滑动图片，可以做很多事情,滑块视图容器，这个容器不仅仅是用来滑动图片，可以做很多事情<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span>
    <span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 第五部分 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/icon/chat.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>92<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/icon/view.png<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>102<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="页面样式-1"><a href="#页面样式-1" class="headerlink" title="页面样式"></a>页面样式</h4><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* pages/posts/posts.wxss */</span>

<span class="token comment">/* 设置轮播图的大小 */</span>
<span class="token selector">swiper</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 460rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">swiper image</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 文章样式 */</span>
<span class="token selector">.post-container</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 弹性布局 */</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token comment">/* 上下边框线 */</span>
  <span class="token property">border-top</span><span class="token punctuation">:</span> 1rpx solid #ededed<span class="token punctuation">;</span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1rpx solid #ededed<span class="token punctuation">;</span>
  <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 作者 日期样式 */</span>
<span class="token selector">.post-author-date</span> <span class="token punctuation">{</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 10rpx 0 20rpx 10rpx<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token comment">/* flex 布局居中方案 */</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.post-author</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 60rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 60rpx<span class="token punctuation">;</span>
  <span class="token comment">/* 头像和文字居中 */</span>
  <span class="token comment">/* vertical-align: middle; */</span>
<span class="token punctuation">}</span>

<span class="token selector">.post-date</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 26rpx<span class="token punctuation">;</span>
  <span class="token comment">/* vertical-align: middle; */</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 文章标题 */</span>
<span class="token selector">.post-title</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 34rpx<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> 700<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 文章主图 */</span>
<span class="token selector">.post-image</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 340rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 文章内容 */</span>
<span class="token selector">.post-content</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">letter-spacing</span><span class="token punctuation">:</span> 2rpx<span class="token punctuation">;</span>
  <span class="token property">text-indent</span><span class="token punctuation">:</span> 2em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 文章模拟阅读量 */</span>
<span class="token selector">.post-like</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 26rpx<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.post-like-image</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 32rpx<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 32rpx<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 16rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.post-like-font</span> <span class="token punctuation">{</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 26rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="微信小程序入门-三"><a href="#微信小程序入门-三" class="headerlink" title="微信小程序入门(三)"></a>微信小程序入门(三)</h1><p><strong>前面我们制作了文章板块。</strong></p>
<p>我们当时制作的模拟用户收藏文章和浏览次数，使用的是 png 格式的图片。但是图片有一个非常不好的地方，就是放大会失贞，使用我们打算将其换为字体图标。</p>
<h3 id="字体图标的使用"><a href="#字体图标的使用" class="headerlink" title="字体图标的使用"></a>字体图标的使用</h3><p>在原生的微信小程序组件中，使用字体图标还是比较麻烦的。所以我们这里使用 <code>lin-ui</code>组件库的字体图标组件。</p>
<ul>
<li><p>在 pages.json 文件里面注册组件以后就可以直接使用</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>research<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>还可以修改图标的颜色，大小等</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#ccc<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>128<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>research<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<p><strong>所以这里我们就把上次的 png 做的图标替换为字体图标了。更加好看也方便。</strong></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#666<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>28<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>favor<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token comment">&lt;!-- &lt;image class="post-like-image" src="/images/icon/chat.png"&gt;&lt;/image&gt; --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>92<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- &lt;image class="post-like-image" src="/images/icon/view.png" /&gt; --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#666<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>32<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>eye<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>102<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826195011599.png" alt="image-20210826195011599"></p>
<h3 id="生成多篇文章"><a href="#生成多篇文章" class="headerlink" title="生成多篇文章"></a>生成多篇文章</h3><p>前面，我们完成了一篇文章的制作，这里我们多复制几次，假设有五篇文章，换一下内容和图片，日期头像等。（我们这里只是为了学习小程序的语法，暂时使用的都是假数据，死数据。实际上数据肯定不是这样写死在页面上的。）</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826200151890.png" alt="image-20210826200151890"></p>
<h3 id="数据来源"><a href="#数据来源" class="headerlink" title="数据来源"></a>数据来源</h3><p>实际上我们页面展示的数据，都是从服务器请求过来的。那么就涉及到数据的单向数据绑定和双向数据绑定了。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826200629606.png" alt="image-20210826200629606"></p>
<h4 id="单向数据绑定"><a href="#单向数据绑定" class="headerlink" title="单向数据绑定"></a>单向数据绑定</h4><p>单向数据绑定，就是通过 js 发起请求从服务器端获取的数据，我们通过某些手段将数据展示在 view（页面，视图）上，让用户看见，而不允许修改。这也是开发中最常见的。</p>
<h4 id="双向数据绑定"><a href="#双向数据绑定" class="headerlink" title="双向数据绑定"></a>双向数据绑定</h4><p>说白了，就是 js 向服务器请求的数据，在页面上展示的同时，用户也可以进行某些更改，然后同步修改了 js 里请求到的原生数据，二者可以相互影响。现在的小程序已经有（<strong>简易的</strong>）双向数据绑定的机制了。</p>
<p>小程序的双向数据绑定和前端三大框架比起来，应该算是很简单的了。当然在 vue/react 等框架中，如果对响应式原理不是很了解的话，出现了 bug 有时候也会很难受的。</p>
<h4 id="实现数据单向绑定"><a href="#实现数据单向绑定" class="headerlink" title="实现数据单向绑定"></a>实现数据单向绑定</h4><p><strong>小程序的生命周期放在后面再说。暂时先简单了解</strong></p>
<h5 id="onLoad-生命周期"><a href="#onLoad-生命周期" class="headerlink" title="onLoad 生命周期"></a>onLoad 生命周期</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
 * 生命周期函数--监听页面加载
 * 也可以叫做 钩子函数 hook function
 */</span>
<span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// onLoad函数，在小程序页面加载的时候，会自动进行回调这个函数。</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>可以发现页面加载的时候，输出了 1.</strong></p>
<h5 id="数据绑定方式一"><a href="#数据绑定方式一" class="headerlink" title="数据绑定方式一"></a>数据绑定方式一</h5><p>那么我们如何实现数据绑定呢？</p>
<p>在 js 文件中，还有一个 data 属性，data 属性是一个对象，在这个里面定义的变量，函数等，在 view 上是可以直接使用的。这里我们假设第一篇文章的标签是从服务器获取到的。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 页面的初始数据
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    titles<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"1-我是服务器请求到的标题！"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>在页面上进行使用该数据。语法就是前面说过的双花括号语法</strong></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-title<span class="token punctuation">"</span></span> <span class="token attr-name">user-select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>2021 {{titles[0]}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826202643202.png" alt="image-20210826202643202"></p>
<h5 id="数据绑定方式二-setData"><a href="#数据绑定方式二-setData" class="headerlink" title="数据绑定方式二 setData"></a>数据绑定方式二 setData</h5><p>我们也可以通过 setData 函数，隐式的定义数据</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// onLoad函数，在小程序页面加载的时候，会自动进行回调这个函数。</span>
    <span class="token comment">// console.log(1);</span>
    <span class="token comment">// 使用setData函数定义的数据，会隐式的放到data属性上，</span>
    <span class="token comment">// 也就是说 最终数据都会在data属性上</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      dates<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'2021 08 26'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>根据输出，可以看出最终数据是全都在 data 上定义了</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826203941487.png" alt="image-20210826203941487"></p>
<h4 id="数据定义"><a href="#数据定义" class="headerlink" title="数据定义"></a>数据定义</h4><p>实现数据绑定的方式有显示和隐式两种，那么我们实际开发需要将数据都显示的定义吗？</p>
<p>答案是 有必要的都显示定义。如果这个变量，数据会被 view 页面直接引用，那么就建议，显示的定义在 data 里面。</p>
<p>data 里面定义的变量是有初始值的。更多的情况下，我们可以把 setData 的作用理解为更新数据，而不是纯粹的为了定义数据。都在 data 里面显示的定义，也更加方便我们的阅读。</p>
<h4 id="小程序的生命周期"><a href="#小程序的生命周期" class="headerlink" title="小程序的生命周期"></a>小程序的生命周期</h4><p>生命周期就是页面的加载到卸载（消亡）。小程序的生命周期函数其实就是这个页面从加载到卸载的过程中，进行到某个阶段自动进行回调的函数。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"onLoad"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面初次渲染完成
   */</span>
  <span class="token function-variable function">onReady</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"onReady"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面显示
   */</span>
  <span class="token function-variable function">onShow</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"onShow"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826210356292.png" alt="image-20210826210356292"></p>
<p>可以发现实际的加载顺序是： <strong>onLoad -&gt; onShow -&gt; onReady</strong></p>
<p>onShow 是在 onReady 前面的，因为页面显示不代表数据渲染也完成了。</p>
<p>其中 onLoad 生命周期函数是最重要的，也是用的最多的。</p>
<p>而 <strong>onHide 和 onUnload</strong>两个生命周期函数，是条件触发，并不是说页面必须隐藏，必须卸载。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
 * 生命周期函数--监听页面隐藏
 */</span>
<span class="token function-variable function">onHide</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"onHide"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">/**
 * 生命周期函数--监听页面卸载
 */</span>
<span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"onUnload"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>页面的卸载我们暂时不好模拟。但是可以模拟隐藏。</p>
<p>点击这个小圆点</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826211351236.png" alt="image-20210826211351236"></p>
<p>就可以触发隐藏页面</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826211415177.png" alt="image-20210826211415177"></p>
<p>再次切回小程序，又会触发 onShow 事件。</p>
<h4 id="简单的数据绑定练习"><a href="#简单的数据绑定练习" class="headerlink" title="简单的数据绑定练习"></a>简单的数据绑定练习</h4><h5 id="模拟请求的数据"><a href="#模拟请求的数据" class="headerlink" title="模拟请求的数据"></a>模拟请求的数据</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 模拟从服务器请求到了数据
     */</span>
    <span class="token keyword">const</span> content <span class="token operator">=</span> <span class="token punctuation">{</span>
      date<span class="token operator">:</span> <span class="token string">"Sep 18 2021"</span><span class="token punctuation">,</span>
      title<span class="token operator">:</span> <span class="token string">"正是虾肥蟹壮时"</span><span class="token punctuation">,</span>
      imgSrc<span class="token operator">:</span> <span class="token string">"/images/post/sls.jpg"</span><span class="token punctuation">,</span>
      avatar<span class="token operator">:</span> <span class="token string">"/images/avatar/2.png"</span><span class="token punctuation">,</span>
      content<span class="token operator">:</span> <span class="token string">"菊黄蟹正肥，品尝秋之味。徐志摩把,“看初花的荻芦”和“到楼外楼吃蟹”,并列为秋天来杭州不能错过的风雅之事；用林妹妹的话讲是“螯封嫩玉双双满，..."</span><span class="token punctuation">,</span>
      reading<span class="token operator">:</span> <span class="token string">"112"</span><span class="token punctuation">,</span>
      collection<span class="token operator">:</span> <span class="token string">"96"</span><span class="token punctuation">,</span>
      author<span class="token operator">:</span> <span class="token string">"林白衣"</span>
      <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="数据绑定到-view"><a href="#数据绑定到-view" class="headerlink" title="数据绑定到 view"></a>数据绑定到 view</h5><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第一部分 作者 日期 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-author-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 头像 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-author<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{avatar}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{date}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第二部分 文章标题 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-title<span class="token punctuation">"</span></span> <span class="token attr-name">user-select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第三部分 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{imgSrc}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第四部分 文章内容 --&gt;</span>
  <span class="token comment">&lt;!-- user-select 方便用户复制 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{content}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第五部分 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#666<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>28<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>favor<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{collection}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#666<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>32<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>eye<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{reading}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826212734101.png" alt="image-20210826212734101"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826212748246.png" alt="image-20210826212748246"></p>
<h3 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h3><p>有些元素我们需要在某些条件先才进行显示或者不显示，这时候就用到了条件渲染。</p>
<p>进行条件显示的语法：</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>标签名</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>条件<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>

<span class="token comment">&lt;!--单个if条件判断--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--if-else条件判断--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{flag}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name"><span class="token namespace">wx:</span>else</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--if-else-if条件判断--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{score&gt;90}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name"><span class="token namespace">wx:</span>elif</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{score&gt;80}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name"><span class="token namespace">wx:</span>else</span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826215207794.png" alt="image-20210826215207794"></p>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/conditional.html">条件渲染的使用</a></p>
<h3 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h3><p>这里模拟一个数组，作为文章的数据。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 模拟从服务器请求到了数据
     */</span>
    <span class="token keyword">const</span> content <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
      date<span class="token operator">:</span> <span class="token string">"Sep 18 2021"</span><span class="token punctuation">,</span>
      title<span class="token operator">:</span> <span class="token string">"正是虾肥蟹壮时"</span><span class="token punctuation">,</span>
      imgSrc<span class="token operator">:</span> <span class="token string">"/images/post/sls.jpg"</span><span class="token punctuation">,</span>
      avatar<span class="token operator">:</span> <span class="token string">"/images/avatar/2.png"</span><span class="token punctuation">,</span>
      content<span class="token operator">:</span> <span class="token string">"菊黄蟹正肥，品尝秋之味。徐志摩把,“看初花的荻芦”和“到楼外楼吃蟹”,并列为秋天来杭州不能错过的风雅之事；用林妹妹的话讲是“螯封嫩玉双双满，..."</span><span class="token punctuation">,</span>
        reading<span class="token operator">:</span> <span class="token string">"112"</span><span class="token punctuation">,</span>
        collection<span class="token operator">:</span> <span class="token string">"96"</span><span class="token punctuation">,</span>
      author<span class="token operator">:</span> <span class="token string">"林白衣"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">"从视觉到触觉 这款VR手套能给你真实触感"</span><span class="token punctuation">,</span>
      content<span class="token operator">:</span> <span class="token string">"8月29日消息，据国外媒体VentureBeat报道，一家名为Dexta Robotics的公司最近发布了一款有望变革虚拟现实手部追踪与交互方式的新产品"</span><span class="token punctuation">,</span>
      imgSrc<span class="token operator">:</span> <span class="token string">"/images/post/vr.png"</span><span class="token punctuation">,</span>
      reading<span class="token operator">:</span> <span class="token number">102</span><span class="token punctuation">,</span>
      collection<span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span>
      author<span class="token operator">:</span> <span class="token string">"深白色"</span><span class="token punctuation">,</span>
      date<span class="token operator">:</span> <span class="token string">"Nov 20 2016"</span><span class="token punctuation">,</span>
      avatar<span class="token operator">:</span> <span class="token string">"/images/avatar/4.png"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      posts<span class="token operator">:</span> content
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>关于列表循环的更多语法在官网都有说明</strong></p>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/list.html">列表循环</a></p>
<p>我们这里只是简单的演示，列表循环可以循环数组，也可以循环对象。这里只演示数组循环。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 使用列表渲染来完成文章的制作 --&gt;</span>
<span class="token comment">&lt;!-- 列表渲染的语法： wx:for --&gt;</span>
<span class="token comment">&lt;!-- block  一般我们进行列表渲染的时候，都会在block标签上--&gt;</span>
<span class="token comment">&lt;!-- block 并不是一个组件，它仅仅是一个包装元素，不会在页面中做任何渲染，只接受控制属性。 --&gt;</span>
<span class="token comment">&lt;!-- block 标签没什么特别的含义，就是相当于一个括号，将多个需要循环的标签包裹起来 --&gt;</span>
<span class="token comment">&lt;!-- 循环取posts数组里面的每一项元素遍历 --&gt;</span>
<span class="token comment">&lt;!-- 如果没有指定每一项循环元素的名称，那么默认就是 item --&gt;</span>
<span class="token comment">&lt;!-- 如果需要修改循环元素的名称，那么我们可以通过 wx:for-item 属性指定，还可以指定数组当前下标的变量名：wx:for-index="index"  --&gt;</span>
<span class="token comment">&lt;!-- 默认数组的当前项的下标变量名默认为 index --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{posts}}<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>for-item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第二篇文章 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 第一部分 作者 日期 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-author-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 头像 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-author<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{item.avatar}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{item.date}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 第二部分 文章标题 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-title<span class="token punctuation">"</span></span> <span class="token attr-name">user-select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{item.title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 第三部分 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{item.imgSrc}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 第四部分 文章内容 --&gt;</span>
    <span class="token comment">&lt;!-- user-select 方便用户复制 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{item.content}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 第五部分 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#666<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>28<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>favor<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{item.collection}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#666<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>32<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>eye<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{item.reading}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>关于 block 标签也不需要想太多。进行列表循环的时候，不管那么多直接使用就可以了。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826221828245.png" alt="image-20210826221828245"></p>
<p><strong>列表循环最重要的作用就是用来展示一组数据。</strong></p>
<h3 id="页面的跳转"><a href="#页面的跳转" class="headerlink" title="页面的跳转"></a>页面的跳转</h3><p>我们两个页面都基本开发完毕了。接下来回到 welcome 页面，完成点击按钮实现跳转到 pages 页面的功能。</p>
<h4 id="什么是事件"><a href="#什么是事件" class="headerlink" title="什么是事件"></a>什么是事件</h4><p>都是学过 js 的兄弟，也就不多赘述了。</p>
<ul>
<li>事件是视图层到逻辑层的通讯方式。</li>
<li>事件可以将用户的行为反馈到逻辑层进行处理。</li>
<li>事件可以绑定在组件上，当达到触发事件，就会执行逻辑层中对应的事件处理函数。</li>
<li>事件对象可以携带额外信息，如 id, dataset, touches。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html">你想知道的事件都在这，dddd</a></p>
<h4 id="捕捉事件"><a href="#捕捉事件" class="headerlink" title="捕捉事件"></a>捕捉事件</h4><p>事件发生了，不进行捕获是没有任何意义的。当我们捕捉到事件以后，可以进行一系列我们需要的操作。</p>
<p>我们这里就要实现点击按钮了触发页面跳转的功能。</p>
<p>在移动端，也就是触摸设备上，点击按钮这种操作实际上就是<strong>tap（指触摸后马上离开，实际上就是点击后马上离开）事件</strong>，所以我们需要捕获的就是 tap 事件。</p>
<p><strong>捕获事件的语法：</strong></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 捕获事件： bind:事件名称="函数名称" --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-journey-container<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onTap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 设置样式模拟出我们喜欢的按钮样式 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>journey<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>开启小程序之旅<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>事件回调函数的定义和 onLoad 等生命周期函数同级。</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 定义捕获Tap事件后的回调函数</span>
  <span class="token function">onTap</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 捕获事件 并跳转页面</span>
    <span class="token comment">// 1. 捕获事件 在页面上通过bind进行捕获</span>

    <span class="token comment">// 2. 完成页面的跳转</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'页面跳转！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>当我们单击了按钮以后，就会触发 tap 事件，进而执行相应的回调函数。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210826223805413.png" alt="image-20210826223805413"></p>
<p><strong>实际的页面跳转我们在下面说。</strong></p>
<h4 id="事件捕获语法糖"><a href="#事件捕获语法糖" class="headerlink" title="事件捕获语法糖"></a>事件捕获语法糖</h4><p>实际上，我们事件捕获不一定非要写成 <strong>bind:事件</strong>，也可以省略中间的 <strong>:</strong>,但是，我们建议还是不要省略。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onTap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>不过还是看个人习惯了。后面我们还会看见捕获事件还可以使用 catch</strong></p>
<h3 id="路由系统"><a href="#路由系统" class="headerlink" title="路由系统"></a>路由系统</h3><p>如果我们想要进行页面的跳转，那么必然离不开小程序的路由系统。</p>
<h4 id="navigateTo-方法"><a href="#navigateTo-方法" class="headerlink" title="navigateTo 方法"></a>navigateTo 方法</h4><p>使用 wx.navigateTo({url: ‘url’}) 方法完成页面直接的跳转</p>
<ul>
<li><p>该方法接收的参数是一个对象，url 属性是跳转的路径</p>
</li>
<li><p><strong>navigateTo 方法的特点：</strong></p>
<ul>
<li>该方法跳转的页面，实际上是当前页面的子页面，我们可以从子页面返回当前页面。当然，有子页面，肯定还可以有子子页面，但是页面不能无限的多下去，页面栈最多只能开辟 10 个，所以最多可以有十个子页面。</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 进行页面跳转的时候，填写的页面文件相对整个项目的绝对路径</span>
  url<span class="token operator">:</span> <span class="token string">"/pages/posts/posts"</span><span class="token punctuation">,</span>
  <span class="token comment">// 也可以使用相对路径(可以看我们在app.json中配置的页面路径)</span>
  <span class="token comment">// url: '../posts/posts',</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827102022824.png" alt="image-20210827102022824"></p>
<h4 id="redirectTo-方法"><a href="#redirectTo-方法" class="headerlink" title="redirectTo 方法"></a>redirectTo 方法</h4><p>我们这里不希望从欢迎页面跳转到 pages 页面，还可以返回。也就是说欢迎页面我们只想作为一个过渡的页面，不让其和其他页面有什么必然的联系。</p>
<p>那么这里就可以使用 redirectTo 方法。使用方式和上面的一样。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">wx<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 进行页面跳转的时候，填写的页面文件相对整个项目的绝对路径</span>
  url<span class="token operator">:</span> <span class="token string">"/pages/posts/posts"</span><span class="token punctuation">,</span>
  <span class="token comment">// 也可以使用相对路径(可以看我们在app.json中配置的页面路径)</span>
  <span class="token comment">// url: '../posts/posts',</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827102417091.png" alt="image-20210827102417091"></p>
<p>页面跳转后，并没有可以返回父页面的小箭头了。但是这里有一个小房子一样的按钮。</p>
<p>点击这个小房子的按钮也会回到上个欢迎页面。是不是怀疑这个也能回到上个页面呢？</p>
<p>实际上，这个功能是现在新的小程序加进来的功能。这个小房子的按钮是<strong>回到首页用的</strong>，你的首页设置的是什么，就会回到那个页面。并不是所谓的一定回到上个页面。</p>
<h4 id="redirectTo-和-navigateTo-方法的区别"><a href="#redirectTo-和-navigateTo-方法的区别" class="headerlink" title="redirectTo 和 navigateTo 方法的区别"></a>redirectTo 和 navigateTo 方法的区别</h4><p><strong>navigateTo 方法</strong>会保留当前页面，也就是即使跳转到新的页面，当前页面也保留在页面栈中。</p>
<p>而 <strong>redirectTo</strong>方法会直接销毁当前页面，然后跳转到新的页面。</p>
<h5 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h5><p>这里我们可以通过前面提到的小程序的生命周期来进行验证。</p>
<p>我们在 welcome 页面的监听页面卸载的生命周期函数中写上输出语句进行验证。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"> wx<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 进行页面跳转的时候，填写的页面文件相对整个项目的绝对路径</span>
      url<span class="token operator">:</span> <span class="token string">'/pages/posts/posts'</span><span class="token punctuation">,</span>
      <span class="token comment">// 也可以使用相对路径(可以看我们在app.json中配置的页面路径)</span>
      <span class="token comment">// url: '../posts/posts',</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">/**
   * 生命周期函数--监听页面卸载
   */</span>
  <span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"welcome 页面被卸载！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果是 redirectTo 方法，我们可以发现，会调用 onUnload 方法。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827103300060.png" alt="image-20210827103300060"></p>
<p>而 navigateTo 方法则不会触发这个函数。说明页面被保留下来的。只是页面被隐藏了。</p>
<h3 id="catch-和-bind-事件的区别"><a href="#catch-和-bind-事件的区别" class="headerlink" title="catch 和 bind 事件的区别"></a>catch 和 bind 事件的区别</h3><p>bind 捕获的就是实实在在在自己身上发生的事件，而 catch 可以捕获子元素发生的事件，其实就是事件的冒泡。</p>
<p>使用 bind 来捕获事件，这个事件是可以向上冒泡的。但是一旦使用了 catch 来进行事件的捕获，这个事件捕获到以后就终止了，不会继续向外传递。</p>
<p><strong>这里使用三层的事件绑定进行测试</strong></p>
<p>先使用 catch-bind-bind</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827105756105.png" alt="image-20210827105756105"></p>
<ol>
<li><p>当我们点击按钮上的文字时</p>
<p>​ <img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827105316835.png" alt="image-20210827105316835"></p>
</li>
<li><p>点击按钮（不点文字）</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827105351066.png" alt="image-20210827105351066"></p>
</li>
</ol>
<p><strong>测试二：catch-catch-bind</strong></p>
<ol>
<li><p>点击按钮上的文字</p>
<p>​ <img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827105538207.png" alt="image-20210827105538207"></p>
</li>
<li><p>点击按钮 不点文字</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827105610098.png" alt="image-20210827105610098"></p>
</li>
</ol>
<p><strong>测试三：catch-catch-catch</strong></p>
<ol>
<li><p>点击按钮上的文字</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827105823566.png" alt="image-20210827105823566"></p>
</li>
<li><p>点击按钮 不点击文字</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827105851616.png" alt="image-20210827105851616"></p>
</li>
</ol>
<p><strong>综上：使用 catch 和 bind 都可以捕获事件，但是 catch 会阻止冒泡，导致父元素无法进行事件的捕获。</strong></p>
<h3 id="js-模块的导入导出"><a href="#js-模块的导入导出" class="headerlink" title="js 模块的导入导出"></a>js 模块的导入导出</h3><p>现在我们把模拟的文章请求数据从 posts.js 文件中抽离出去。这里简单模拟几篇数据，需要更多的数据可以自己随意书写。</p>
<p>在 ES6 中，一个 js 文件我们就可以视作为一个模块。</p>
<p><strong>导入导出的语法就不多说了。这玩意都是 js 基础。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827111737448.png" alt="image-20210827111737448"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827111819681.png"></p>
<h3 id="文章跳转"><a href="#文章跳转" class="headerlink" title="文章跳转"></a>文章跳转</h3><h4 id="从列表文章跳转到文章详情页"><a href="#从列表文章跳转到文章详情页" class="headerlink" title="从列表文章跳转到文章详情页"></a>从列表文章跳转到文章详情页</h4><p>很明显，我们实际上也不可能知道具体有多多少文章，所以实际上的文章详情页也只会有一个。具体显示什么内容肯定是根据实际的文字内容自动填充的。而我们要做的就是做好文章详情内容模板。</p>
<p><strong>很明显，这里肯定还是需要用到事件。我们需要监听用户的点击事件。</strong></p>
<p>这个事件应该作用域这篇文章的所有部分，只有点击到了文章上，就进行跳转。实际上这里的跳转不应该这么简单，比如我们点击头像了，可以进行头像图片的放大，或者说跳转到用户详情页，等等。</p>
<p>这里就不考虑那么多了。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827115046363.png" alt="image-20210827115046363"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827115056149.png" alt="image-20210827115056149"></p>
<p><strong>随意单击文章的任何地方都能够进行跳转</strong></p>
<p>因为这里我们去往的是文章详情页，所以应该使用 navigateTo 方法。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827115153119.png" alt="image-20210827115153119"></p>
<h3 id="关于列表渲染警告"><a href="#关于列表渲染警告" class="headerlink" title="关于列表渲染警告"></a>关于列表渲染警告</h3><p>前面我们发现，使用了列表渲染，一直提示警告。</p>
<img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827115330917.png" alt="image-20210827115330917">

<p>这里建议我们使用 wx:key 属性，可以提高列表渲染的性能。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210827115808352.png" alt="image-20210827115808352"></p>
<p>我这里的 postId 是在模拟的数据中添加的属性。key 绑定的值只要是唯一的就可以了。当然我们也不建议绑定文章数据在数组中的索引。那样其实也并不是合法的。</p>
<p>然后就是新的小程序这里绑定是不需要使用双花括号语法的，也不需要 item.postId 来绑定。因为这是在循环的那层标签上。</p>
<p>以前是可以使用双花括号语法进行绑定的，现在新版的小程序进行了修改。</p>
<h1 id="微信小程序入门-四-完成文章详情页"><a href="#微信小程序入门-四-完成文章详情页" class="headerlink" title="微信小程序入门(四)-完成文章详情页"></a>微信小程序入门(四)-完成文章详情页</h1><h3 id="制作静态页面"><a href="#制作静态页面" class="headerlink" title="制作静态页面"></a>制作静态页面</h3><p><strong>先有死数据制作出我们想要的效果</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828102541148.png" alt="image-20210828102541148"></p>
<p><strong>布局也比较简单，直接上代码</strong></p>
<h4 id="页面结构-1"><a href="#页面结构-1" class="headerlink" title="页面结构"></a>页面结构</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--pages/post-detail/post-detail.wxml--&gt;</span>

<span class="token comment">&lt;!-- 先静后动 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>head-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/post/bl.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 头像区域 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>author-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>avatar<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/avatar/1.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>author<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>听雨少年<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>const-text<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>发表于<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>16小时前<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 标题 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>你好！！！！ <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 图标 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tool<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>circle<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/icon/collection-anti.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>share-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/icon/share.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 水平线 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>horizon<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 文章文本 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>detail<span class="token punctuation">"</span></span>
    <span class="token punctuation">&gt;</span></span>哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span>
  <span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="页面样式-2"><a href="#页面样式-2" class="headerlink" title="页面样式"></a>页面样式</h4><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* pages/post-detail/post-detail.wxss */</span>

<span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 图片 */</span>
<span class="token selector">.head-image</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 460rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 头像区域 */</span>
<span class="token selector">.author-date</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 32rpx<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.avatar</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 64rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 64rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.author</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> 300<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.const-text</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 24rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.date</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 24rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 标题 */</span>
<span class="token selector">.title</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 36rpx<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #4b556c<span class="token punctuation">;</span>
  <span class="token property">letter-spacing</span><span class="token punctuation">:</span> 2px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 图标 */</span>
<span class="token selector">.tool</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token comment">/* 设置主轴 */</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token comment">/* 侧轴排列方式 */</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token comment">/* 垂直居中 主轴排列方式  */</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.circle</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 660rpx<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> flex-end<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.circle image</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 90rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 90rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.circle image:last-child</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.horizon</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 660rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #e5e5e5<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 文本 */</span>
<span class="token selector">.detail</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> 44rpx<span class="token punctuation">;</span>
  <span class="token property">letter-spacing</span><span class="token punctuation">:</span> 2px<span class="token punctuation">;</span>
  <span class="token property">text-indent</span><span class="token punctuation">:</span> 2em<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="页面跳转"><a href="#页面跳转" class="headerlink" title="页面跳转"></a>页面跳转</h3><h4 id="传递文章数据"><a href="#传递文章数据" class="headerlink" title="传递文章数据"></a>传递文章数据</h4><p>我们页面的布局制作好了。接下来就是点击哪一篇文章，就显示哪一篇文章的详情页。这时候跳转的时候我们就需要传递数据。</p>
<p>我们采用自定义属性来保存当前文章的文章号。</p>
<h4 id="自定义属性"><a href="#自定义属性" class="headerlink" title="自定义属性"></a>自定义属性</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828105003033.png" alt="image-20210828105003033"></p>
<h4 id="事件对象获取自定义属性"><a href="#事件对象获取自定义属性" class="headerlink" title="事件对象获取自定义属性"></a>事件对象获取自定义属性</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// event  事件</span>
  <span class="token function">onGoToDetail</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用事件对象 拿到我们当前文章的文字号</span>
    <span class="token comment">// 通过 currentTarget.dataset 可以拿到我们事件目标上自定义的 data-属性</span>
    <span class="token comment">// 我们可以通过这个对象拿到定义在事件对象上的属性 data- 后面的就是自定义的属性</span>
    <span class="token comment">// 小程序自定义的 data- 属性的规则</span>
    <span class="token comment">// data-id ---&gt; id</span>
    <span class="token comment">// data-Id ---&gt; id</span>
    <span class="token comment">// data-postId ---&gt; postid</span>
    <span class="token comment">// data-PostId ---&gt; postid</span>
    <span class="token comment">// data-post-id ---&gt; postId</span>
    <span class="token comment">// data-post-ID ---&gt; postId</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 跳转文章详情页</span>
      url<span class="token operator">:</span> <span class="token string">"/pages/post-detail/post-detail"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="页面通信"><a href="#页面通信" class="headerlink" title="页面通信"></a>页面通信</h4><p>页面跳转的时候，我们将文章号传递过去。一般都是通过 url 来传递参数。</p>
<p>url?参数 1=值 1</p>
<p>?后面的参数我们也叫查询参数，查询字符串。</p>
<p><strong>所以页面跳转的时候，我们将文章号传递过去</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 跳转文章详情页</span>
  url<span class="token operator">:</span>
    <span class="token string">"/pages/post-detail/post-detail?pid="</span> <span class="token operator">+</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>postId<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="参数的接收"><a href="#参数的接收" class="headerlink" title="参数的接收"></a>参数的接收</h5><p>传递到本页面的参数，我们可以通过生命周期函数中的 onLoad 函数里面的参数 options 来获取到查询字符串里面的值。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过监听页面加载的的函数的参数options，机也可以拿到我们传递过来本页面的参数</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828105721859.png" alt="image-20210828105721859"></p>
<h4 id="渲染指定文章详情页"><a href="#渲染指定文章详情页" class="headerlink" title="渲染指定文章详情页"></a>渲染指定文章详情页</h4><p>我们拿到前面传递过来的文章号，就可以再次模拟请求数据，然后进行数据的渲染。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// pages/post-detail/post-detail.js</span>

<span class="token comment">// 导入数据</span>
<span class="token keyword">import</span> postList <span class="token keyword">from</span> <span class="token string">"../../data/data.js"</span><span class="token punctuation">;</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">/**
   * 页面的初始数据
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    post<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过监听页面加载的的函数的参数options，机也可以拿到我们传递过来本页面的参数</span>
    <span class="token comment">// 注意：查询字符串（参数）的类型都是字符串类型</span>
    <span class="token comment">// console.log(options);</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>post<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token operator">...</span>postList<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> post<span class="token punctuation">.</span>postId <span class="token operator">===</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>pid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// console.log(post);</span>
    <span class="token comment">// 拿到我们指定的文章</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>post<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面初次渲染完成
   */</span>
  <span class="token function-variable function">onReady</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面显示
   */</span>
  <span class="token function-variable function">onShow</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面隐藏
   */</span>
  <span class="token function-variable function">onHide</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面卸载
   */</span>
  <span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 页面相关事件处理函数--监听用户下拉动作
   */</span>
  <span class="token function-variable function">onPullDownRefresh</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 页面上拉触底事件的处理函数
   */</span>
  <span class="token function-variable function">onReachBottom</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 用户点击右上角分享
   */</span>
  <span class="token function-variable function">onShareAppMessage</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="页面数据替换"><a href="#页面数据替换" class="headerlink" title="页面数据替换"></a>页面数据替换</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--pages/post-detail/post-detail.wxml--&gt;</span>

<span class="token comment">&lt;!-- 先静后动 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>head-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{imgSrc}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 头像区域 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>author-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>avatar<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{avatar}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>author<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{author}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>const-text<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>发表于<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{dateTime}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 标题 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{title}} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 图标 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tool<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>circle<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/icon/collection-anti.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>share-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/icon/share.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 水平线 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>horizon<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 文章文本 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>detail<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{detail}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828111416810.png" alt="image-20210828111416810"></p>
<h3 id="缓存机制-异步-API"><a href="#缓存机制-异步-API" class="headerlink" title="缓存机制/异步 API"></a>缓存机制/异步 API</h3><h4 id="app-js-的作用"><a href="#app-js-的作用" class="headerlink" title="app.js 的作用"></a>app.js 的作用</h4><p>接下来，我们想完成在文章详情页的收藏和取消收藏。并记录下是否收藏的状态。实际上用户收藏以后，应该是向服务器发起请求，将数据保存在服务器端。但是这里我们没有使用数据库，那么就需要考虑保存在本地的某个地方。比如：全局变量。当然这不是最好的。</p>
<p>而小程序的全局变量，是写在 app.js 中的。</p>
<h5 id="小程序的生命周期-1"><a href="#小程序的生命周期-1" class="headerlink" title="小程序的生命周期"></a>小程序的生命周期</h5><p>小程序的生命周期和页面的生命周期类似。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">/**
   * 小程序启动的生命周期
   */</span>
  <span class="token function">onLaunch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"小程序启动！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 小程序页面展示的时候
   */</span>
  <span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"onShow!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 小程序隐藏的时候执行
   */</span>
  <span class="token function">onHide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"小程序隐藏！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 小程序出现错误的时候执行
   */</span>
  <span class="token function">onError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"小程序报错！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="定义全局变量"><a href="#定义全局变量" class="headerlink" title="定义全局变量"></a>定义全局变量</h5><p>在 app.js 文件中，可以定义全局变量。和小程序的生命周期函数定义的位置是一样的。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"App.js name"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="在页面获取全局变量"><a href="#在页面获取全局变量" class="headerlink" title="在页面获取全局变量"></a>在页面获取全局变量</h5><p>定义的全局变量如何获取呢？</p>
<p>其实，在其他页面，可以通过小程序通过的 getApp()函数，来获取定义的全局变量的对象。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828163111487.png" alt="image-20210828163111487"></p>
<p><strong>所以我们在 app.js 中定义的全局变量，是可以在所有页面进行全局共享的。</strong></p>
<p>但是，并不是说全局的变量的数据就是一直不变的。当小程序重启了，数据又会回到最开始的状态。所以 <strong>不能把全局变量当做一个永久数据保存的地方。</strong></p>
<h4 id="小程序的缓存"><a href="#小程序的缓存" class="headerlink" title="小程序的缓存"></a>小程序的缓存</h4><p>很明显，用全局变量来记录用户是否收藏一篇文章并不是一个很好的方案。</p>
<p>那么，我们应该采取什么手段？</p>
<p>这里引入小程序的缓存来解决。</p>
<p>什么是小程序的缓存？其实和我们 js 中的 localstorage 很相似。</p>
<p>即使我们的小程序重启了，保存在缓存中的数据依然是有效的，不会被重置。而定义在 app.js 中的全局变量则在小程序重启后会被重置。</p>
<h5 id="同步缓存"><a href="#同步缓存" class="headerlink" title="同步缓存"></a>同步缓存</h5><p>通过小程序通过的 setStorageSync()的方法，可以同步设置或者更新缓存。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 同步设置（修改）缓存的方法</span>
    <span class="token comment">// 两个参数：键  值</span>
    wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 删除缓存</span>
    wx<span class="token punctuation">.</span><span class="token function">removeStorageSync</span><span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 清空所有缓存</span>
    wx<span class="token punctuation">.</span><span class="token function">clearStorageSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"你好！ "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取我们设置的缓存</span>
    <span class="token keyword">const</span> n <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>通过小程序的调试器是可以看见和管理我们的缓存的。即使程序重启缓存也不会消失 的。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828164843681.png" alt="image-20210828164843681"></p>
<p>通过这个按钮就可以清空缓存</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828164957922.png" alt="image-20210828164957922"></p>
<p>你也可以自己手动在这里新建缓存。</p>
<h5 id="异步缓存"><a href="#异步缓存" class="headerlink" title="异步缓存"></a>异步缓存</h5><p>异步设置缓存在设置缓存较多的时候，可以提升用户体验。以前我们设置或者删除缓存是通过回调函数来执行成功后的操作。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 异步设置缓存 参数是一个对象 key是键 data是数据 也就是设置的value</span>
wx<span class="token punctuation">.</span><span class="token function">setStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token string">"毛毛1"</span><span class="token punctuation">,</span>
  key<span class="token operator">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取缓存 参数也是对象</span>
wx<span class="token punctuation">.</span><span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 要获取的缓存的键名</span>
  key<span class="token operator">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span>
  <span class="token comment">// 获取成功后的回调函数</span>
  <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// post-detail.js? [sm]:50 {errMsg: "getStorage:ok", data: "毛毛1"}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 移除缓存</span>
wx<span class="token punctuation">.</span><span class="token function">removeStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  key<span class="token operator">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span>
  <span class="token comment">// 移除属性成功后的回调函数</span>
  <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 清空缓存</span>
wx<span class="token punctuation">.</span><span class="token function">clearStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 缓存清空成功后的回调</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>如果我们异步获取缓存的时候，不设置回调函数，可以得到一个 promise 对象的返回值。</strong></p>
<p><strong>如果对 promise 不了解的，可以先去了解一下。</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">wx<span class="token punctuation">.</span><span class="token function">setStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token string">"听雨少年"</span><span class="token punctuation">,</span>
  key<span class="token operator">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取缓存 无回调</span>
<span class="token keyword">const</span> res <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  key<span class="token operator">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res <span class="token keyword">instanceof</span> <span class="token class-name">Promise</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token comment">// 传统的promise 获取成功后的结果 ES6新增</span>
res<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {errMsg: "getStorage:ok", data: "听雨少年"}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>但是，这种操作 promise 对象有了更好的解决方案。可以使用 ES7 新增的 async 和 await 关键字。</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">async</span> <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
wx<span class="token punctuation">.</span><span class="token function">setStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      data<span class="token operator">:</span> <span class="token string">'听雨少年'</span><span class="token punctuation">,</span>
      key<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> wx<span class="token punctuation">.</span><span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      key<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// {errMsg: "getStorage:ok", data: "听雨少年"}</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="实现文章收藏功能"><a href="#实现文章收藏功能" class="headerlink" title="实现文章收藏功能"></a>实现文章收藏功能</h3><p>接下来我们要做的，就是完成文章的收藏功能。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828173659726.png" alt="image-20210828173659726"></p>
<h4 id="第一步：点击事件"><a href="#第一步：点击事件" class="headerlink" title="第一步：点击事件"></a>第一步：点击事件</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828212838805.png" alt="image-20210828212838805"></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 条件渲染：在收藏和未收藏的图标之间切换 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>
  <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{!collected}}<span class="token punctuation">"</span></span>
  <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onCollect<span class="token punctuation">"</span></span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/icon/collection-anti.png<span class="token punctuation">"</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name"><span class="token namespace">wx:</span>else</span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onCollect<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/icon/collection.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里用一个变量来控制收藏和未收藏的图片切换。</p>
<h4 id="第二步：收藏缓存"><a href="#第二步：收藏缓存" class="headerlink" title="第二步：收藏缓存"></a>第二步：收藏缓存</h4><p>如果想要完成小程序刷新后还可以记录好文章是否收藏的状态，我们需要将当前的文章状态保存到缓存中。</p>
<p>如何完成所有文章都可以互不影响的缓存呢？</p>
<p>这里采用的方式是：记录一个对象，将每篇文章的 id 作为属性，是否收藏了这篇文章作为这个属性的值。</p>
<p>比如：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">post_collection <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// id:true/false</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token number">6</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="第三步：实现"><a href="#第三步：实现" class="headerlink" title="第三步：实现"></a>第三步：实现</h4><h5 id="定义数据"><a href="#定义数据" class="headerlink" title="定义数据"></a>定义数据</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 页面的初始数据
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    post<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 记录当前文章的id</span>
    _pid<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token comment">// 当前文章是否收藏</span>
    collected<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token comment">// 所有文章是否收藏的缓存对象</span>
    _postsCollected<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="页面初始化"><a href="#页面初始化" class="headerlink" title="页面初始化"></a>页面初始化</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token keyword">async</span> <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>post<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>postList<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">post</span> <span class="token operator">=&gt;</span> post<span class="token punctuation">.</span>postId <span class="token operator">===</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>pid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// 记录文章id</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid <span class="token operator">=</span> post<span class="token punctuation">.</span>postId<span class="token punctuation">;</span>

    <span class="token comment">// console.log(post);</span>
    <span class="token comment">// 拿到我们指定的文章</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>post<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 读取缓存，拿到文章是否收藏的状态</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> postsCollected <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> wx<span class="token punctuation">.</span><span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      key<span class="token operator">:</span> <span class="token string">'post_collected'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 记录所有文章的缓存状态的对象</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_postsCollected <span class="token operator">=</span> postsCollected<span class="token punctuation">;</span>
    <span class="token comment">// 拿到当前文章的收藏状态 取不到则表示这篇文章未收藏</span>
    <span class="token keyword">const</span> collected <span class="token operator">=</span> postsCollected<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>postsCollected<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>collected<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> collected <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="图片收藏切换函数"><a href="#图片收藏切换函数" class="headerlink" title="图片收藏切换函数"></a>图片收藏切换函数</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 文章收藏点击事件的回调
   * @param {*} event  事件对象
   */</span>
  <span class="token keyword">async</span> <span class="token function">onCollect</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 假设文章未收藏</span>
    <span class="token comment">// 点击后 未收藏 -&gt; 收藏</span>
    <span class="token comment">// 将是否收藏的状态保存到缓存中</span>
    <span class="token comment">// 记录那篇文章是否被收藏，还可以同时进行记录多篇文章</span>
    <span class="token comment">// const { data: postCollected = {} } = await wx.getStorage({</span>
    <span class="token comment">//   key: 'post_collected',</span>
    <span class="token comment">// })</span>
    <span class="token keyword">const</span> postCollected <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_postsCollected<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>postCollected<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 当前文章的收藏状态 取不到则肯定没有收藏过</span>
    <span class="token keyword">const</span> collected <span class="token operator">=</span> postCollected<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">// 用文章id的值作为实际存储对象的属性，属性值是是否收藏</span>
    postCollected<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">!</span>collected<span class="token punctuation">;</span>
    wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'post_collected'</span><span class="token punctuation">,</span> postCollected<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 这里直接取反就可以了 上面的执行完毕这里可以直接取反了</span>
      collected<span class="token operator">:</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="功能实现"><a href="#功能实现" class="headerlink" title="功能实现"></a>功能实现</h5><p>通过上面的方式，我们其实就已经实现了将收藏状态进行了本地存储，即使退出去，重新加载也会记录下以前的状态。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828214652277.png" alt="image-20210828214652277"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828214704873.png" alt="image-20210828214704873"></p>
<p><strong>但是，这里还是有一个 bug。</strong></p>
<h5 id="缓存的-bug"><a href="#缓存的-bug" class="headerlink" title="缓存的 bug"></a>缓存的 bug</h5><p>这里这样做实际上是有一些 bug 的。</p>
<p>因为如果是用户第一次访问，那么也就没有缓存。那么我们在加载的时候，是取不到缓存中的值的。那么系统肯定是会在控制台报错的，这个问题还是有点头疼。我也没想到让我满意的解决方法。虽然这个问题不影响我们使用。<strong>回头在想想。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828215450477.png" alt="image-20210828215450477"></p>
<h4 id="优化用户收藏体验"><a href="#优化用户收藏体验" class="headerlink" title="优化用户收藏体验"></a>优化用户收藏体验</h4><h5 id="再次完善页面"><a href="#再次完善页面" class="headerlink" title="再次完善页面"></a>再次完善页面</h5><p>这里将字体修改一下，在全局的样式中进行更改。看起来舒服点。</p>
<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* app.wxss */</span>
<span class="token selector">text</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 24rpx<span class="token punctuation">;</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">"MicroSoft Yahei"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828215900962.png" alt="image-20210828215900962"></p>
<h5 id="弹框提示是否收藏成功"><a href="#弹框提示是否收藏成功" class="headerlink" title="弹框提示是否收藏成功"></a>弹框提示是否收藏成功</h5><p>我们可以使用小程序原生提供的某些 API，组件。在用户点击收藏或者取消收藏的时候提示用户收藏成功还是取消收藏了。</p>
<p>只需要在点击事件的执行函数中，调用小程序提供好的弹框组件即可。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 使用小程序默认的API 弹框组件来提示用户是收藏文章 还是取消收藏</span>
wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 提示文字</span>
  title<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected <span class="token operator">?</span> <span class="token string">"收藏文章成功！"</span> <span class="token operator">:</span> <span class="token string">"取消收藏成功！"</span><span class="token punctuation">,</span>
  <span class="token comment">// 提示框停留时间</span>
  duration<span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
  <span class="token comment">// 图标属性 icon: "success"/"error"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828220949620.png" alt="image-20210828220949620"></p>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/interaction/wx.showToast.html">没错，我就是你想要的提示框</a></p>
<h4 id="使用模态对话框"><a href="#使用模态对话框" class="headerlink" title="使用模态对话框"></a>使用模态对话框</h4><p>上面我们使用弹框来提示用户是否收藏成功，其实这种轻提示也是非常好的。这里我的想法是使用模态对话框来进行一次练习。实际上这种方式没有上面的那种方式好，这里仅仅作为一波小练习而已。</p>
<h5 id="模态对话框的基本使用"><a href="#模态对话框的基本使用" class="headerlink" title="模态对话框的基本使用"></a>模态对话框的基本使用</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 模态对话框 showModel</span>
wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">"是否收藏文章"</span><span class="token punctuation">,</span>
  <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 不管取消还是确定，都会执行这个回调函数，因为这个函数的执行时机就是 接口调用成功的回调函数 也就是出现了这个模态框，就一定会被执行的函数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>confirm<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// res.confirm 为 true 时，表示用户点击了确定按钮</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>cancel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// res.cancel  为 true 时，表示用户点击了取消</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="模态对话框的改进"><a href="#模态对话框的改进" class="headerlink" title="模态对话框的改进"></a>模态对话框的改进</h5><p>如果我们使用上面的这种方式，那么就需要将其他的代码全都放到 success 这个回调函数中执行。很明显这不是我们想要的。这种写法会导致代码看起来很臃肿。那么我们可以如何做呢？</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> res <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">"是否收藏文章"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Promise对象</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果我们调用模态框的时候，不传递回调函数 success，就可以得到这个函数的返回值，是一个 Promise 的对象。</p>
<p>很明显，可以使用<strong>async 和 await</strong>关键字了来完成异步调用了。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 文章收藏点击事件的回调
   * @param {*} event  事件对象
   */</span>
  <span class="token keyword">async</span> <span class="token function">onCollect</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected<span class="token operator">?</span><span class="token string">"取消收藏？"</span><span class="token operator">:</span><span class="token string">"收藏文章？"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// console.log(res);</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>confirm<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 收藏文章</span>
      <span class="token keyword">const</span> postCollected <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_postsCollected<span class="token punctuation">;</span>
      <span class="token comment">// console.log(postCollected);</span>

      <span class="token comment">// 当前文章的收藏状态 取不到则肯定没有收藏过</span>
      <span class="token keyword">const</span> collected <span class="token operator">=</span> postCollected<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token comment">// 用文章id的值作为实际存储对象的属性，属性值是是否收藏</span>
      postCollected<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">!</span>collected<span class="token punctuation">;</span>
      wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'post_collected'</span><span class="token punctuation">,</span> postCollected<span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// 这里直接取反就可以了 上面的执行完毕这里可以直接取反了</span>
        collected<span class="token operator">:</span> <span class="token operator">!</span>collected
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828225352701.png" alt="image-20210828225352701"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828225404289.png" alt="image-20210828225404289"></p>
<p><strong>实际上想要达到的效果都是一样的。但是为了用户体验，我们还是采取最开始的弹框方式。</strong></p>
<h3 id="文章分享"><a href="#文章分享" class="headerlink" title="文章分享"></a>文章分享</h3><h4 id="注册事件"><a href="#注册事件" class="headerlink" title="注册事件"></a>注册事件</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 点击触发文章分享事件 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>
  <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onShare<span class="token punctuation">"</span></span>
  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>share-image<span class="token punctuation">"</span></span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/icon/share.png<span class="token punctuation">"</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828225930257.png" alt="image-20210828225930257"></p>
<h4 id="功能的完成"><a href="#功能的完成" class="headerlink" title="功能的完成"></a>功能的完成</h4><p>完成文章的分享，我们实际上还是调用微信小程序提供好的内置组件。具体的更多的使用方式可以参考官方文档。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 完成文章分享的回调函数
   * @param {*} event
   */</span>
  <span class="token function">onShare</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 调用小程序原生的组件 实现分享</span>
    wx<span class="token punctuation">.</span><span class="token function">showActionSheet</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 分享的方式(具体分享以后做什么，我们并没有做)</span>
      itemList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"分享到QQ"</span><span class="token punctuation">,</span> <span class="token string">"分享到微信"</span><span class="token punctuation">,</span> <span class="token string">"分享到微博"</span><span class="token punctuation">,</span> <span class="token string">"分享到朋友圈"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// 通过 res.tapIndex 可以拿到我们点击了哪一个数组元素的索引</span>
        <span class="token comment">// 想做其他事情可以做</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>tapIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828230806200.png" alt="image-20210828230806200"></p>
<h4 id="内置的分享"><a href="#内置的分享" class="headerlink" title="内置的分享"></a>内置的分享</h4><p>实际上，我们想要分享微信小程序，也不需要自己写功能。小程序已经内置了分享功能。<strong>点击这三个点的按钮就可以看见。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210828230931461.png" alt="image-20210828230931461"></p>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/interaction/wx.showActionSheet.html">更多分享用法请参考</a></p>
<h1 id="微信小程序入门-五"><a href="#微信小程序入门-五" class="headerlink" title="微信小程序入门(五)"></a>微信小程序入门(五)</h1><h3 id="音乐播放功能"><a href="#音乐播放功能" class="headerlink" title="音乐播放功能"></a>音乐播放功能</h3><h4 id="制作样式"><a href="#制作样式" class="headerlink" title="制作样式"></a>制作样式</h4><p>静态样式没啥好说的，基本上有手就行了。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>head-image-audio<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>head-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{imgSrc}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 实现音乐播放  --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>audio<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/music/music-start.png<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* 大图+音乐播放 */</span>
<span class="token selector">.head-image-audio</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 460rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 图片 */</span>
<span class="token selector">.head-image</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 音乐播放 */</span>
<span class="token selector">.audio</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 102rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 110rpx<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token comment">/* 居中 */</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> 0.6<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210829110147532.png" alt="image-20210829110147532"></p>
<p>我们想要实现的功能就是点击以后实现音乐的播放。</p>
<h4 id="背景音频播放"><a href="#背景音频播放" class="headerlink" title="背景音频播放"></a>背景音频播放</h4><p>这里也需要了解一下官方提供的关于背景音频播放的 API 组件。</p>
<h5 id="绑定事件"><a href="#绑定事件" class="headerlink" title="绑定事件"></a>绑定事件</h5><p>老规矩，肯定还是需要在图片上绑定点击事件。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 实现音乐播放  --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onMusic<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>audio<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/music/music-start.png<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="功能测试"><a href="#功能测试" class="headerlink" title="功能测试"></a>功能测试</h5><p>这里先简单的使用一下背景音频。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 音乐播放功能
   * @param {*} event
   */</span>
  <span class="token function">onMusic</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取全局唯一的背景音频管理器。 小程序切入后台，如果音频处于播放状态，可以继续播放。但是后台状态不能通过调用API操纵音频的播放状态</span>
    <span class="token keyword">const</span> mgr <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getBackgroundAudioManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 赋值音乐播放的链接</span>
    mgr<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>music<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
    <span class="token comment">// 音乐播放的标题</span>
    mgr<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>music<span class="token punctuation">.</span>title<span class="token punctuation">;</span>
   <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210829112622826.png" alt="image-20210829112622826"></p>
<p>咳咳，很明显，没什么大毛病。用起来也不难。</p>
<h5 id="控制台报错"><a href="#控制台报错" class="headerlink" title="控制台报错"></a>控制台报错</h5><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210829112702351.png" alt="image-20210829112702351"></p>
<p>虽然使用没什么问题，但是控制台给我们了报错提示。这时候，我们去这个地址看看。</p>
<p>为了能够转后台以后可以继续播放音频。我们就在 app.json 文件中配置一下。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210829112917612.png" alt="image-20210829112917612"></p>
<p><strong>当我们在 app.json 中配置了这个属性，并且数组里面只有一个值 audio 时</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"requiredBackgroundModes"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"audio"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>音乐播放的同时，切后台音乐也会一直播放。</strong></p>
<p><span style="color:red">而只使用 location 这个值，只有在小程序没有退出的时候才会一直播放，一旦切后台，音乐就会停止。&nbsp;</span></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"requiredBackgroundModes"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"location"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>我们这里就把两个值都加上吧。</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"requiredBackgroundModes"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"audio"</span><span class="token punctuation">,</span><span class="token string">"location"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="切换音乐播放图标"><a href="#切换音乐播放图标" class="headerlink" title="切换音乐播放图标"></a>切换音乐播放图标</h4><p>因为需要进行音乐播放与停止的切换，所以图标也需要更改。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 实现音乐播放  --&gt;</span>
<span class="token comment">&lt;!-- 播放和暂停图标的切换 条件渲染 --&gt;</span>
<span class="token comment">&lt;!-- 当然这里用三元表达式就不需要使用两个标签了 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>
  <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{!isPlaying}}<span class="token punctuation">"</span></span>
  <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onMusicStart<span class="token punctuation">"</span></span>
  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>audio<span class="token punctuation">"</span></span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/music/music-start.png<span class="token punctuation">"</span></span>
<span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>
  <span class="token attr-name"><span class="token namespace">wx:</span>else</span>
  <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onMusicStop<span class="token punctuation">"</span></span>
  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>audio<span class="token punctuation">"</span></span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/music/music-stop.png<span class="token punctuation">"</span></span>
<span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 音乐播放开始功能
   * @param {*} event
   */</span>
  <span class="token function">onMusicStart</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取全局唯一的背景音频管理器。 小程序切入后台，如果音频处于播放状态，可以继续播放。但是后台状态不能通过调用API操纵音频的播放状态</span>
    <span class="token keyword">const</span> mgr <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getBackgroundAudioManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 赋值音乐播放的链接</span>
    mgr<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>music<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
    <span class="token comment">// 音乐播放的标题</span>
    mgr<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>music<span class="token punctuation">.</span>title<span class="token punctuation">;</span>
    <span class="token comment">// 播放时使用的图片</span>
    mgr<span class="token punctuation">.</span>coverImgUrl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>music<span class="token punctuation">.</span>coverImg<span class="token punctuation">;</span>
    <span class="token comment">// 切换当前音乐的播放状态为 播放中</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      isPlaying<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 音乐暂停的事件处理
   * @param {*} event
   */</span>
  <span class="token function">onMusicStop</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> mgr <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getBackgroundAudioManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 音乐停止</span>
    mgr<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 音乐状态的切换</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      isPlaying<span class="token operator">:</span><span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>说实话，这样的确达到了音乐的停止和播放之间状态的切换。但是，你会发现每次切换播放和暂停音乐以后，音乐需要重新播放、并且，如果在音乐播放的时候，我们点击下面的控制面板，可以发现，音乐暂停了，但是图标不会自动切换。问题还是很多。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210829141418289.png" alt="image-20210829141418289"></p>
<h4 id="同步音乐控制开关与图标的状态"><a href="#同步音乐控制开关与图标的状态" class="headerlink" title="同步音乐控制开关与图标的状态"></a>同步音乐控制开关与图标的状态</h4><h5 id="背景音频对象的播放-暂停事件回调"><a href="#背景音频对象的播放-暂停事件回调" class="headerlink" title="背景音频对象的播放/暂停事件回调"></a>背景音频对象的播放/暂停事件回调</h5><p>很明显，想要达到我们需要的某些状态，肯定是需要使用音频对象提供的某些回调函数。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210829142040225.png" alt="image-20210829142040225"></p>
<p>所以我们通过这两个事件，来根据音乐的播放和暂停调用不同的函数。</p>
<h5 id="进一步优化"><a href="#进一步优化" class="headerlink" title="进一步优化"></a>进一步优化</h5><p>因为我们会在很多地方都使用到这个背景音频的对象，所以我们将其放到 data 数据源中，并且在页面加载的时候进行获取，同时在 onLoad 中监听音乐的播放和暂停两个事件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 页面的初始数据
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    post<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 记录当前文章的id</span>
    _pid<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token comment">// 当前文章是否收藏</span>
    collected<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token comment">// 所有文章是否收藏的缓存对象</span>
    _postsCollected<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 音乐是否播放中</span>
    isPlaying<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token comment">// 背景音频对象</span>
    _mgr<span class="token operator">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token keyword">async</span> <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过监听页面加载的的函数的参数options，机也可以拿到我们传递过来本页面的参数</span>
    <span class="token comment">// 注意：查询字符串（参数）的类型都是字符串类型</span>
    <span class="token comment">// console.log(options);</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>post<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>postList<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">post</span> <span class="token operator">=&gt;</span> post<span class="token punctuation">.</span>postId <span class="token operator">===</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>pid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// 记录文章id</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid <span class="token operator">=</span> post<span class="token punctuation">.</span>postId<span class="token punctuation">;</span>

    <span class="token comment">// console.log(post);</span>
    <span class="token comment">// 拿到我们指定的文章</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>post<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 读取缓存，拿到文章是否收藏的状态</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> postsCollected <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> wx<span class="token punctuation">.</span><span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      key<span class="token operator">:</span> <span class="token string">'post_collected'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 记录所有文章的缓存状态的对象</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_postsCollected <span class="token operator">=</span> postsCollected<span class="token punctuation">;</span>
    <span class="token comment">// 拿到当前文章的收藏状态 取不到则表示这篇文章未收藏</span>
    <span class="token keyword">const</span> collected <span class="token operator">=</span> postsCollected<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">// console.log(postsCollected);</span>
    <span class="token comment">// console.log(collected);</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> collected <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token keyword">const</span> mgr <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getBackgroundAudioManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_mgr <span class="token operator">=</span> mgr<span class="token punctuation">;</span>
    <span class="token comment">// 监听背景音乐的播放和停止</span>
    <span class="token comment">// mgr.onPlay(()=&gt;{</span>
    <span class="token comment">//   // 音乐播放</span>
    <span class="token comment">//   this.onMusicStart();</span>
    <span class="token comment">// });</span>
    mgr<span class="token punctuation">.</span><span class="token function">onPlay</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>onMusicStart<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 音乐暂停的回调处理</span>
    mgr<span class="token punctuation">.</span><span class="token function">onPause</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>onMusicStop<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 文章收藏点击事件的回调
   * @param {*} event  事件对象
   */</span>
  <span class="token keyword">async</span> <span class="token function">onCollect</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">const</span> postCollected <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_postsCollected<span class="token punctuation">;</span>


    <span class="token comment">// 当前文章的收藏状态 取不到则肯定没有收藏过</span>
    <span class="token keyword">const</span> collected <span class="token operator">=</span> postCollected<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">// 用文章id的值作为实际存储对象的属性，属性值是是否收藏</span>
    postCollected<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">!</span>collected<span class="token punctuation">;</span>
    wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'post_collected'</span><span class="token punctuation">,</span> postCollected<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 这里直接取反就可以了 上面的执行完毕这里可以直接取反了</span>
      collected<span class="token operator">:</span> <span class="token operator">!</span>collected
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 使用小程序默认的API 弹框组件来提示用户是收藏文章 还是取消收藏</span>
    wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 提示文字</span>
      title<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected <span class="token operator">?</span> <span class="token string">"收藏文章成功！"</span> <span class="token operator">:</span> <span class="token string">"取消收藏成功！"</span><span class="token punctuation">,</span>
      <span class="token comment">// 提示框停留时间</span>
      duration<span class="token operator">:</span> <span class="token number">2000</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>


  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 完成文章分享的回调函数
   * @param {*} event
   */</span>
  <span class="token function">onShare</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 调用小程序原生的组件 实现分享</span>
    wx<span class="token punctuation">.</span><span class="token function">showActionSheet</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 分享的方式(具体分享以后做什么，我们并没有做)</span>
      itemList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"分享到QQ"</span><span class="token punctuation">,</span> <span class="token string">"分享到微信"</span><span class="token punctuation">,</span> <span class="token string">"分享到微博"</span><span class="token punctuation">,</span> <span class="token string">"分享到朋友圈"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 通过 res.tapIndex 可以拿到我们点击了哪一个数组元素的索引</span>
        <span class="token comment">// 想做其他事情可以做</span>
        <span class="token comment">// console.log(res.tapIndex);</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 音乐播放开始功能
   * @param {*} event
   */</span>
  <span class="token function">onMusicStart</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> mgr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_mgr<span class="token punctuation">;</span>
    <span class="token comment">// 赋值音乐播放的链接</span>
    mgr<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>music<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
    <span class="token comment">// 音乐播放的标题</span>
    mgr<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>music<span class="token punctuation">.</span>title<span class="token punctuation">;</span>
    <span class="token comment">// 播放时使用的图片</span>
    mgr<span class="token punctuation">.</span>coverImgUrl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>music<span class="token punctuation">.</span>coverImg<span class="token punctuation">;</span>
    <span class="token comment">// 切换当前音乐的播放状态为 播放中</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      isPlaying<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 音乐暂停的事件处理
   * @param {*} event
   */</span>
  <span class="token function">onMusicStop</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> mgr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_mgr<span class="token punctuation">;</span>
    <span class="token comment">// 音乐停止</span>
    mgr<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 暂停播放</span>
    <span class="token comment">// mgr.pause();</span>
    <span class="token comment">// 音乐状态的切换</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      isPlaying<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210829144141275.png" alt="image-20210829144141275"></p>
<p>这样就可以完成音乐的停止和播放之间的切换了。</p>
<p>但是，这样做我们音乐就直接停止了，用户点击的是暂停按钮，按理说我们要做的应该是让音乐暂停，而不是直接终止。</p>
<p>很显然，用户点击控制面板的暂停，应该就是让音乐暂停，而不是直接停止。</p>
<p><strong>所以说，我们要做的，应该是点击我们自己的按钮，实现的是音乐的播放和停止，而用户点击下面的控制面板，应该是在播放和暂停之间切换。</strong></p>
<h5 id="再一次优化音乐的暂停和停止"><a href="#再一次优化音乐的暂停和停止" class="headerlink" title="再一次优化音乐的暂停和停止"></a>再一次优化音乐的暂停和停止</h5><p>话都说的这么明白了，接下来不用我说，有手就行了。</p>
<p>这里将音乐停止的函数进行改进。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 音乐暂停的事件处理
   * @param {*} isStop 停止音乐
   */</span>
  <span class="token function">onMusicStop</span><span class="token punctuation">(</span><span class="token parameter">isStop <span class="token operator">=</span> <span class="token boolean">true</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// const mgr = wx.getBackgroundAudioManager();</span>
    <span class="token keyword">const</span> mgr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_mgr<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isStop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 音乐停止</span>
      mgr<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 暂停播放</span>
      mgr<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 音乐状态的切换</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      isPlaying<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">async</span> <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 省略 。。。</span>
      <span class="token keyword">const</span> mgr <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getBackgroundAudioManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_mgr <span class="token operator">=</span> mgr<span class="token punctuation">;</span>
      mgr<span class="token punctuation">.</span><span class="token function">onPlay</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>onMusicStart<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 音乐暂停的回调处理</span>
      mgr<span class="token punctuation">.</span><span class="token function">onPause</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onMusicStop</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这就达到了我们想要的效果。点击下面的控制面板，音乐暂停；点击上面图片按钮，音乐由播放转为停止。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210829145522243.png" alt="image-20210829145522243"></p>
<h4 id="音乐播放状态的初始化问题"><a href="#音乐播放状态的初始化问题" class="headerlink" title="音乐播放状态的初始化问题"></a>音乐播放状态的初始化问题</h4><p>当我们解决了上面的问题之后，接下来其实很有其他问题。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210829150048411.png" alt="image-20210829150048411"></p>
<p>当我们点击返回按钮，此时音乐还是处于播放状态，因为我们没有停止播放。再次进行本页面的时候，这个音乐还是播放中，但是我们的图标和下面音乐的状态对不上了。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210829151024017.png" alt="image-20210829151024017"></p>
<p>原因当然很明显，是我们的状态问题，每次我们页面的加载时，状态都被重置为 false。</p>
<p>这里我们可以采用全局变量的方式，来记录音乐的播放与否。没必要使用缓存，因为缓存是持久化的。实际上程序退出了就没必要管音乐的事情了。</p>
<h5 id="在优化"><a href="#在优化" class="headerlink" title="在优化"></a>在优化</h5><p>这思路就很简单了。搞一个全局变量，每次在音乐状态切换的同时，我们全局的状态跟着改变。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// app.js</span>

<span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 记录音乐的播放状态</span>
  gIsPlayingMusic<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// // pages/post-detail/post-detail.js</span>

<span class="token comment">// 全局的小程序对象，用来获取我们的全局变量</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取全局记录的播放状态</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      isPlaying<span class="token operator">:</span> app<span class="token punctuation">.</span>gIsPlayingMusic<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 音乐播放开始功能
   * @param {*} event
   */</span>
  <span class="token function">onMusicStart</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 改变全局的音乐播放状态</span>
    app<span class="token punctuation">.</span>gIsPlayingMusic <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 音乐暂停的事件处理
   * @param {*} isStop 停止音乐
   */</span>
  <span class="token function">onMusicStop</span><span class="token punctuation">(</span><span class="token parameter">isStop <span class="token operator">=</span> <span class="token boolean">true</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 改变全局的音乐播放状态</span>
    app<span class="token punctuation">.</span>gIsPlayingMusic <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>其它代码都不在赘述。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210829152951445.png" alt="image-20210829152951445"></p>
<h4 id="分析其它问题"><a href="#分析其它问题" class="headerlink" title="分析其它问题"></a>分析其它问题</h4><h5 id="不是问题也是问题的问题"><a href="#不是问题也是问题的问题" class="headerlink" title="不是问题也是问题的问题"></a>不是问题也是问题的问题</h5><p>老实说，改了这么多，还是有一些小的 bug。刚解决一个又来一个。</p>
<p>这个问题说是问题，也可以说不是问题。</p>
<p>就是我们发现，我们当前文章的歌曲在播放，然后我们退出去进入其他页面，按理说其他页面的歌曲和我们这个是不一样的歌曲，应该是不应该让音乐按钮显示播放状态的，但是我们每次获取的状态都是全局的，所以导致只要有音乐在播放，进去其他文章也都是会显示播放状态。</p>
<p>这个问题你说是问题，其实也没错，本来就是 bug。你要是说不是问题，也没毛病，本来就是有音乐就是在播放中。</p>
<p><strong>这里我理解呢是 bug。就简单的解决一下。</strong></p>
<p>思路还是那么明显，搞个全局变量就完事。弄一个全局变量记录当前音乐播放是属于那篇文章的。这样在赋值播放状态的时候，我们就可以根据文章的 id 号是否相同，来解决这个问题。</p>
<h5 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// app.js</span>

  <span class="token comment">// 记录音乐的播放状态</span>
  gIsPlayingMusic<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// 记录播放的音乐是属于那篇文章的 默认是-1</span>
  gIsPlayingPostId<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="文章音乐播放状态"><a href="#文章音乐播放状态" class="headerlink" title="文章音乐播放状态"></a>文章音乐播放状态</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 当前文章的音乐播放状态
   *
   * @returns 只有音乐所属的文章号是当前所在的文章页面，且音乐一直处于播放状态， 返回true
   */</span>
  <span class="token function">currentPostMusicIsPlaying</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>app<span class="token punctuation">.</span>gIsPlayingMusic <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid <span class="token operator">===</span> app<span class="token punctuation">.</span>gIsPlayingPostId<span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="文章音乐暂停和停止"><a href="#文章音乐暂停和停止" class="headerlink" title="文章音乐暂停和停止"></a>文章音乐暂停和停止</h5><p>音乐暂停的逻辑不需要改变，音乐停止的逻辑进行修改</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 音乐暂停的事件处理
   * @param {*} isStop 停止音乐
   */</span>
  <span class="token function">onMusicStop</span><span class="token punctuation">(</span><span class="token parameter">isStop <span class="token operator">=</span> <span class="token boolean">true</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> mgr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_mgr<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isStop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 音乐停止</span>
      mgr<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 音乐停止，重置全局音乐的文章id</span>
      app<span class="token punctuation">.</span>gIsPlayingPostId <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 暂停播放</span>
      mgr<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 音乐状态的切换</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      isPlaying<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 改变全局的音乐播放状态</span>
    app<span class="token punctuation">.</span>gIsPlayingMusic <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="onLoad-初始化的时候赋值"><a href="#onLoad-初始化的时候赋值" class="headerlink" title="onLoad 初始化的时候赋值"></a>onLoad 初始化的时候赋值</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token comment">// 音乐播放状态 只有音乐所属的文章号是当前所在的文章页面，且音乐一直处于播放状态，我们才重置音乐的播放状态为true</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      isPlaying<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">currentPostMusicIsPlaying</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210829162601019.png" alt="image-20210829162601019"></p>
<h4 id="还未解决的-bug"><a href="#还未解决的-bug" class="headerlink" title="还未解决的 bug"></a>还未解决的 bug</h4><p><strong>解决了很多问题。但是还是存在一些问题。</strong></p>
<h5 id="音乐播放完毕，图标不同步"><a href="#音乐播放完毕，图标不同步" class="headerlink" title="音乐播放完毕，图标不同步"></a>音乐播放完毕，图标不同步</h5><p>当我们音乐播放完毕后，上面的图标并没有同步的进行状态的切换，音乐都播放完了，按理说状态应该是未播放。</p>
<h5 id="音乐播放时进入其他文章"><a href="#音乐播放时进入其他文章" class="headerlink" title="音乐播放时进入其他文章"></a>音乐播放时进入其他文章</h5><p>表面上，我们解决了这些问题，但是进去其他页面的时候，如果我们点击了音乐的暂停，这很 ok。如果暂停后再次点击播放，播放的音乐就变成当前文章的背景音乐了。我觉得这也不是很合理的。</p>
<p><strong>bug 很多。头疼。</strong></p>
<h1 id="微信小程序入门-六-自定义组件"><a href="#微信小程序入门-六-自定义组件" class="headerlink" title="微信小程序入门(六)-自定义组件"></a>微信小程序入门(六)-自定义组件</h1><h3 id="完善文章轮播图"><a href="#完善文章轮播图" class="headerlink" title="完善文章轮播图"></a>完善文章轮播图</h3><h4 id="轮播图文章跳转"><a href="#轮播图文章跳转" class="headerlink" title="轮播图文章跳转"></a>轮播图文章跳转</h4><p>前面我们的轮播图只能简单的动起来。</p>
<p>现在打算实现点击轮播图上的图片，跳转到对应的文章详情页去。只要在图片上绑定文章的 id 号即可。用到的函数还是我们之前用来进行文章详情页跳转的函数。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830155819318.png" alt="image-20210830155819318"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830155923444.png" alt="image-20210830155923444"></p>
<h3 id="生成-tabBar-选项卡"><a href="#生成-tabBar-选项卡" class="headerlink" title="生成 tabBar 选项卡"></a>生成 tabBar 选项卡</h3><h4 id="配置生成"><a href="#配置生成" class="headerlink" title="配置生成"></a>配置生成</h4><p>小程序提供的有 tabBar 的选项卡。我们只需要在 app.json 中配置这个选项，即可生成。</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"tabBar"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"list"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
          <span class="token comment">// tabbar的标题</span>
        <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"阅读"</span><span class="token punctuation">,</span>
          <span class="token comment">// 点击这个bar后去往的页面路径（必填）</span>
        <span class="token property">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/posts/posts"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"电影"</span><span class="token punctuation">,</span>
        <span class="token property">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/movies/movies"</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830161307756.png" alt="image-20210830161307756"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830161329755.png" alt="image-20210830161329755"></p>
<h4 id="tabBar-的其他配置"><a href="#tabBar-的其他配置" class="headerlink" title="tabBar 的其他配置"></a>tabBar 的其他配置</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830162513452.png" alt="image-20210830162513452"></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"tabBar"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置边框线的颜色为白色 这样舒服点</span>
    <span class="token property">"borderStyle"</span><span class="token operator">:</span> <span class="token string">"white"</span><span class="token punctuation">,</span>
    <span class="token comment">// bar的位置 可以在顶端</span>
    <span class="token property">"position"</span><span class="token operator">:</span> <span class="token string">"bottom"</span><span class="token punctuation">,</span>
    <span class="token comment">// bar未选中时文字的颜色</span>
    <span class="token property">"color"</span><span class="token operator">:</span> <span class="token string">"#999"</span><span class="token punctuation">,</span>
    <span class="token comment">// 选中当前bar，文字的颜色</span>
    <span class="token property">"selectedColor"</span><span class="token operator">:</span> <span class="token string">"#333"</span><span class="token punctuation">,</span>
    <span class="token property">"list"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"阅读"</span><span class="token punctuation">,</span>
        <span class="token property">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/posts/posts"</span><span class="token punctuation">,</span>
          <span class="token comment">// 未选中时的图标</span>
        <span class="token property">"iconPath"</span><span class="token operator">:</span> <span class="token string">"/images/tab/yuedu.png"</span><span class="token punctuation">,</span>
          <span class="token comment">// 选中时的图标</span>
        <span class="token property">"selectedIconPath"</span><span class="token operator">:</span> <span class="token string">"/images/tab/yuedu_hl.png"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"电影"</span><span class="token punctuation">,</span>
        <span class="token property">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/movies/movies"</span><span class="token punctuation">,</span>
        <span class="token property">"iconPath"</span><span class="token operator">:</span> <span class="token string">"/images/tab/dianying.png"</span><span class="token punctuation">,</span>
        <span class="token property">"selectedIconPath"</span><span class="token operator">:</span> <span class="token string">"/images/tab/dianying_hl.png"</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830162740174.png" alt="image-20210830162740174"></p>
<h4 id="页面跳转-1"><a href="#页面跳转-1" class="headerlink" title="页面跳转"></a>页面跳转</h4><p>如果想要让一个普通页面，跳转到一个带有 bar 选项卡的页面，我们之前的逻辑是不行的了。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830162924013.png" alt="image-20210830162924013"></p>
<p><strong>回顾一下，之前我们在这的跳转方式是点击按钮，进行页面的重定向，跳转到文章页面。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830163045023.png" alt="image-20210830163045023"></p>
<p><strong>这种方式现在是不能满足我们的要求了。</strong></p>
<h4 id="switchTab-方法的使用"><a href="#switchTab-方法的使用" class="headerlink" title="switchTab 方法的使用"></a>switchTab 方法的使用</h4><p>使用 switchTab 方法，就可以从普通页面跳转到选项卡页面。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830163310415.png" alt="image-20210830163310415"></p>
<h2 id="自定义组件"><a href="#自定义组件" class="headerlink" title="自定义组件"></a>自定义组件</h2><p>要说精髓，小程序的精髓应该就是在自定义组件这里了。</p>
<h3 id="做一个自己的自定义组件"><a href="#做一个自己的自定义组件" class="headerlink" title="做一个自己的自定义组件"></a>做一个自己的自定义组件</h3><h4 id="新建一个自定义组件"><a href="#新建一个自定义组件" class="headerlink" title="新建一个自定义组件"></a>新建一个自定义组件</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830165112837.png" alt="image-20210830165112837"></p>
<p>右键点击 post 文件夹，然后点新建 Component，就可以建好自定义组件的文件了。</p>
<p>一般来说，我们习惯性的让自定义组件的文件名都是 index。</p>
<p><strong>这里我们就先做一个文章的自定义组件，重构一下之前的那个文章页面。</strong></p>
<h4 id="注册自定义组件"><a href="#注册自定义组件" class="headerlink" title="注册自定义组件"></a>注册自定义组件</h4><p>很明显，就跟我们前面使用第三方的自定义组件库一样，使用组件之前都是需要进行自定义的。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830165856693.png" alt="image-20210830165856693"></p>
<h4 id="组件的自定义属性"><a href="#组件的自定义属性" class="headerlink" title="组件的自定义属性"></a>组件的自定义属性</h4><h5 id="常规写法"><a href="#常规写法" class="headerlink" title="常规写法"></a>常规写法</h5><p>在我们组件的 js 文件的 properties 属性上，我们可以<strong>进行自定义属性的注册</strong>。到时候使用组件的时候就可以给该属性赋值，就和<strong>使用 image 标签</strong>的时候，给 src 属性赋值类似的操作。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 组件的属性列表
   */</span>
  properties<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 自定义一个属性 属性名称</span>
    text<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 属性值的类型</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token comment">// 属性的默认值</span>
      value<span class="token operator">:</span> <span class="token string">"我是默认值"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830170751026.png" alt="image-20210830170751026"></p>
<p><strong>如果不给属性赋值，那么就是我们定义好的该属性的默认值</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830170935499.png" alt="image-20210830170935499"></p>
<h5 id="简写（语法糖）"><a href="#简写（语法糖）" class="headerlink" title="简写（语法糖）"></a>简写（语法糖）</h5><p>很多时候，我们觉得上面那种定义属性的方式比较麻烦。那么可以采取下面这种方式。在<strong>没有默认值</strong>的情况下很适用。</p>
<p><strong>这种方式定义的属性，如果属性没有传参，那么默认值就是当前属性的类型的默认值。</strong>比如 Number 的默认值是 0。String 的默认值是空字符串</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
 * 组件的属性列表
 */</span>
properties<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// 自定义一个属性 属性名称 类型</span>
  text<span class="token operator">:</span> String<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>以前，普通的页面只有 data 里面的变量才能做数据绑定（setData 定义的数据最后也会出现在 data 里面）</strong>，但是，在自定义组件里，组件的属性 properties 和 data 里面出现的变量，都可以进行数据绑定。</p>
<h4 id="自定义属性可以接收一个-Object-对象"><a href="#自定义属性可以接收一个-Object-对象" class="headerlink" title="自定义属性可以接收一个 Object 对象"></a>自定义属性可以接收一个 Object 对象</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830171959559.png" alt="image-20210830171959559"></p>
<p>前面，我们进行文章列表的遍历，来渲染整个文章页面（除去轮播图）。</p>
<p>我们可以发现，每篇文章的结构实际上都是相同的。<strong>唯一不同的，只是数据而已。</strong></p>
<p>所以我们可以考虑用自定义组件来代替这个文章的结构，将结构隐藏到组件中，使页面看起来更加清爽，而且还可以达到复用的效果。</p>
<h5 id="封装文章组件结构-样式"><a href="#封装文章组件结构-样式" class="headerlink" title="封装文章组件结构/样式"></a>封装文章组件结构/样式</h5><p>我们将文章的结构和样式，都直接封装到这个自定义组件里面。</p>
<h6 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h6><p><strong>结构还会进行二次更改。</strong></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--components/post/index.wxml--&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>
  <span class="token attr-name">data-post-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{item.postId}}<span class="token punctuation">"</span></span>
  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-container<span class="token punctuation">"</span></span>
  <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onGoToDetail<span class="token punctuation">"</span></span>
<span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第一部分 作者 日期 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-author-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 头像 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-author<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{item.avatar}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{item.date}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第二部分 文章标题 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-title<span class="token punctuation">"</span></span> <span class="token attr-name">user-select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{item.title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第三部分 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{item.imgSrc}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第四部分 文章内容 --&gt;</span>
  <span class="token comment">&lt;!-- user-select 方便用户复制 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{item.content}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第五部分 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#666<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>28<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>favor<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{item.collection}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#666<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>32<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>eye<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{item.reading}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="样式"><a href="#样式" class="headerlink" title="样式"></a>样式</h6><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* components/post/index.wxss */</span>

<span class="token comment">/* 文章样式 */</span>
<span class="token selector">.post-container</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 弹性布局 */</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token comment">/* 上下边框线 */</span>
  <span class="token property">border-top</span><span class="token punctuation">:</span> 1rpx solid #ededed<span class="token punctuation">;</span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1rpx solid #ededed<span class="token punctuation">;</span>
  <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 作者 日期样式 */</span>
<span class="token selector">.post-author-date</span> <span class="token punctuation">{</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 10rpx 0 20rpx 10rpx<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token comment">/* flex 布局居中方案 */</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.post-author</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 60rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 60rpx<span class="token punctuation">;</span>
  <span class="token comment">/* 头像和文字居中 */</span>
  <span class="token comment">/* vertical-align: middle; */</span>
<span class="token punctuation">}</span>

<span class="token selector">.post-date</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 26rpx<span class="token punctuation">;</span>
  <span class="token comment">/* vertical-align: middle; */</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 文章标题 */</span>
<span class="token selector">.post-title</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 34rpx<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> 700<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 文章主图 */</span>
<span class="token selector">.post-image</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 340rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 文章内容 */</span>
<span class="token selector">.post-content</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">letter-spacing</span><span class="token punctuation">:</span> 2rpx<span class="token punctuation">;</span>
  <span class="token property">text-indent</span><span class="token punctuation">:</span> 2em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 文章模拟阅读量 */</span>
<span class="token selector">.post-like</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 26rpx<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.post-like-image</span> <span class="token punctuation">{</span>
  <span class="token comment">/* height: 32rpx;
  width: 32rpx; */</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 16rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.post-like-font</span> <span class="token punctuation">{</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 26rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="自定义属性：Object-类型"><a href="#自定义属性：Object-类型" class="headerlink" title="自定义属性：Object 类型"></a>自定义属性：Object 类型</h5><p>很明显，我们一篇文章会用到很多数据，所有使用文本进行传递是不可靠的。</p>
<p>这里采用传递文章对象，这个对象里面包含所有的当前文章的信息。</p>
<p><strong>那么我们就需要定义一个属性，且该属性的类型是对象类型。</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 组件的属性列表
   */</span>
  properties<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 自定义一个属性 属性名称</span>
    postData<span class="token operator">:</span>Object
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="组件结构调整"><a href="#组件结构调整" class="headerlink" title="组件结构调整"></a>组件结构调整</h5><p>将进行数据绑定的地方进行修改。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--components/post/index.wxml--&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>
  <span class="token attr-name">data-post-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{postData.postId}}<span class="token punctuation">"</span></span>
  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-container<span class="token punctuation">"</span></span>
  <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onGoToDetail<span class="token punctuation">"</span></span>
<span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第一部分 作者 日期 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-author-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 头像 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-author<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{postData.avatar}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-date<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{postData.date}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第二部分 文章标题 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-title<span class="token punctuation">"</span></span> <span class="token attr-name">user-select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{postData.title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第三部分 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{postData.imgSrc}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第四部分 文章内容 --&gt;</span>
  <span class="token comment">&lt;!-- user-select 方便用户复制 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{postData.content}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 第五部分 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#666<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>28<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>favor<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{postData.collection}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#666<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>32<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>eye<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-image<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-like-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{postData.reading}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="使用文章自定义组件"><a href="#使用文章自定义组件" class="headerlink" title="使用文章自定义组件"></a>使用文章自定义组件</h5><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{posts}}<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>postId<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>for-item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>post</span> <span class="token attr-name">post-data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{post}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>post</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830174933350.png" alt="image-20210830174933350"></p>
<p><strong>可以看见，文章被成功的渲染出来了。</strong></p>
<h4 id="自定义组件的事件"><a href="#自定义组件的事件" class="headerlink" title="自定义组件的事件"></a>自定义组件的事件</h4><p>这里，我们简单的把当时进行点击文章，调整到对应的文章详情页的方法代码，抽离到自定义组件中。</p>
<p>组件使用到的放到，都需要在 methods 属性里面进行定义。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830175752019.png" alt="image-20210830175752019"></p>
<h3 id="自定义组件-movie-list"><a href="#自定义组件-movie-list" class="headerlink" title="自定义组件-movie-list"></a>自定义组件-movie-list</h3><p><strong>这里将自定义一个展示电影列表的自定义组件。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830202641102.png" alt="image-20210830202641102"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830180105559.png" alt="image-20210830180105559"></p>
<p>组件建立好了以后就<strong>在电影页面 movies</strong>里面进行组件的注册。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830180350540.png" alt="image-20210830180350540"></p>
<p><strong>测试</strong>：发现正常引入</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830180548725.png" alt="image-20210830180548725"></p>
<h3 id="组件的嵌套"><a href="#组件的嵌套" class="headerlink" title="组件的嵌套"></a>组件的嵌套</h3><p>我们可以发现，<strong>每个电影实际上也是结构相同，只是数据不同而已</strong>。所以我们可以把电影也抽成一个组件。</p>
<h4 id="电影组件-movie"><a href="#电影组件-movie" class="headerlink" title="电影组件-movie"></a>电影组件-movie</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830181255465.png" alt="image-20210830181255465"></p>
<h4 id="组件的制作"><a href="#组件的制作" class="headerlink" title="组件的制作"></a>组件的制作</h4><p>我们前面说过，开发页面的时候，可以先用假数据模拟，然后等静态页面制作好了以后，再将假数据替换为我们实际从服务器请求的数据。</p>
<p><strong>组件的</strong>开发也是一样，先用假数据，然后在替换为实际使用组件时，外界传递进来的数据。</p>
<p><strong>在 movie-list 组件</strong>内部，我们会使用 <strong>movie</strong>组件，那么这就构成了组件之间的相互嵌套。</p>
<h5 id="组件嵌套的使用"><a href="#组件嵌套的使用" class="headerlink" title="组件嵌套的使用"></a>组件嵌套的使用</h5><h6 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h6><p>在 movie-list 组件内组成 movie 组件</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830181601571.png" alt="image-20210830181601571"></p>
<h6 id="使用-movie-组件"><a href="#使用-movie-组件" class="headerlink" title="使用 movie 组件"></a>使用 movie 组件</h6><p>在组件内部使用其他组件，也是和普通标签一样使用。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830181747226.png" alt="image-20210830181747226"></p>
<h4 id="movie-组件的制作"><a href="#movie-组件的制作" class="headerlink" title="movie 组件的制作"></a>movie 组件的制作</h4><h5 id="静态模板的制作"><a href="#静态模板的制作" class="headerlink" title="静态模板的制作"></a>静态模板的制作</h5><p>这一步，比较简单，没什么好说的。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--components/movie/index.wxml--&gt;</span>
<span class="token comment">&lt;!-- 电影容器 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 电影海报 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>poster<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/images/img1.jpg<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 电影标题 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>小米手机哈哈哈哈哈哈哈<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="静态模板的-css"><a href="#静态模板的-css" class="headerlink" title="静态模板的 css"></a>静态模板的 css</h5><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* components/movie/index.wxss */</span>

<span class="token comment">/* 容器 */</span>
<span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 200rpx<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 电影海报 */</span>
<span class="token selector">.poster</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 270rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 22rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 标题 */</span>
<span class="token selector">.title</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 标题字数过长 多出的隐藏 */</span>
  <span class="token property">white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>
  <span class="token property">text-overflow</span><span class="token punctuation">:</span> ellipsis<span class="token punctuation">;</span>
  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
  <span class="token property">word-break</span><span class="token punctuation">:</span> break-all<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="静态模板效果"><a href="#静态模板效果" class="headerlink" title="静态模板效果"></a>静态模板效果</h5><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830204133639.png" alt="image-20210830204133639"></p>
<h5 id="使用-lin-ui-的评分组件"><a href="#使用-lin-ui-的评分组件" class="headerlink" title="使用 lin-ui 的评分组件"></a>使用 lin-ui 的评分组件</h5><p>这个评分的组件，我们自己制作的话是比较麻烦的，所以直接使用第三方提供好的。（<strong>如果想要自己实现其实也不是很难，只实现整数性质的平分还是比较容易的。</strong>）</p>
<h6 id="l-rate-评分组件的注册"><a href="#l-rate-评分组件的注册" class="headerlink" title="l-rate 评分组件的注册"></a>l-rate 评分组件的注册</h6><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830204453700.png" alt="image-20210830204453700"></p>
<h5 id="使用-l-rate-继续完成-movie-组件"><a href="#使用-l-rate-继续完成-movie-组件" class="headerlink" title="使用 l-rate 继续完成 movie 组件"></a>使用 l-rate 继续完成 movie 组件</h5><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830210043421.png" alt="image-20210830210043421"></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>rate-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 评分 --&gt;</span>
  <span class="token comment">&lt;!-- score属性 显示点亮多少星星 可以是小数 --&gt;</span>
  <span class="token comment">&lt;!-- 星星的大小 size 进行设置 --&gt;</span>
  <span class="token comment">&lt;!-- 使用count属性可以修改星星的数量（默认是五个星） --&gt;</span>
  <span class="token comment">&lt;!-- 设置禁用点击 disabled="true" --&gt;</span>
  <span class="token comment">&lt;!-- 使用active-color属性 可以修改点亮的星星的颜色 --&gt;</span>
  <span class="token comment">&lt;!-- 使用 inActive-color 属性 可以修改未选中的星星颜色 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-rate</span> <span class="token attr-name">disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{true}}<span class="token punctuation">"</span></span> <span class="token attr-name">score</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>3.6<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>22<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token comment">&lt;!-- 显示评分 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>score<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>3.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* 评分容器 */</span>
<span class="token selector">.rate-container</span> <span class="token punctuation">{</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 6rpx<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token comment">/* 基线对齐 */</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> baseline<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.score</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 16rpx<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 24rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="movie-list-组件的制作"><a href="#movie-list-组件的制作" class="headerlink" title="movie-list 组件的制作"></a>movie-list 组件的制作</h4><p>通过开始的图片我们看见了，一个 movie-list 组件里面是有三个电影组件的。</p>
<p>所以接下来我们要利用制作好的 movie 组件来制作我们的 movie-list 组件了。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--components/movie-list/index.wxml--&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>正在热映<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>more-text<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>更多 &gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 组件的嵌套 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>movie-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>movie</span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>movie</span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>movie</span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* components/movie-list/index.wxss */</span>
<span class="token comment">/* 组件容器 */</span>
<span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 36rpx 28rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 标题容器 */</span>
<span class="token selector">.title-container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token comment">/* 主轴排列方式 两端对齐*/</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 26rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.more-text</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #1f4ba5<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 海报组件容器 */</span>
<span class="token selector">.movie-container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>静态的制作都是挺简单的，先用死数据，制作好样式，后期在替换就完事。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830212121035.png" alt="image-20210830212121035"></p>
<h5 id="使用多个-movie-list-组件"><a href="#使用多个-movie-list-组件" class="headerlink" title="使用多个 movie-list 组件"></a>使用多个 movie-list 组件</h5><p>效果看起来也还可以。但是样式还需要进行调整。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830212302788.png" alt="image-20210830212302788"></p>
<h5 id="设置组件的样式"><a href="#设置组件的样式" class="headerlink" title="设置组件的样式"></a>设置组件的样式</h5><p>我们在使用 movie-list 组件的时候，感觉这个样式并不完美，想要给这个组件加一些样式，但是，遇见了一些问题，就是给这个组件设置的样式都不生效。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830213440059.png" alt="image-20210830213440059"></p>
<p>直接用组件的名称设置样式，或者给组件添加 class 类名设置样式，都不生效。</p>
<p>这是为什么呢？</p>
<h5 id="解决-movie-list-样式不生效"><a href="#解决-movie-list-样式不生效" class="headerlink" title="解决 movie-list 样式不生效"></a>解决 movie-list 样式不生效</h5><p>想要解决样式不生效的问题，我们这里需要使用组件的<strong>外部样式类</strong>。</p>
<p><strong>之所以使用外部样式，是因为我们使用的组件，并不知道我们实际上会设置什么样式，所以定义好类名交给我们外部进行设置，到时候通过外部样式的入口进行传递给组件引用，完成样式的设置。</strong></p>
<p>外部样式类的使用也比较简单。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830215344883.png" alt="image-20210830215344883"></p>
<p>很明显，可以看见第一个设置外部样式的颜色发生了改变。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830215541605.png" alt="image-20210830215541605"></p>
<p><strong>这种直接给自定义组件设置样式不生效的问题，是由小程序内部的机制引起的。这时候我们就需要考虑使用外部样式类了。</strong></p>
<h4 id="movie-list-组件的优化"><a href="#movie-list-组件的优化" class="headerlink" title="movie-list 组件的优化"></a>movie-list 组件的优化</h4><h5 id="动态标题"><a href="#动态标题" class="headerlink" title="动态标题"></a>动态标题</h5><p>前面我们将所有的数据都是按照死数据来定死的。实际上这肯定是不合理的。这里进行标题的动态赋值。</p>
<p>我们在组件的 js 文件中设置这个属性。让外界动态的传参。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830220442697.png" alt="image-20210830220442697"></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 组件的属性列表
   */</span>
  properties<span class="token operator">:</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span>String
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210830220715789.png" alt="image-20210830220715789"></p>
<h3 id="小程序请求服务端数据"><a href="#小程序请求服务端数据" class="headerlink" title="小程序请求服务端数据"></a>小程序请求服务端数据</h3><h4 id="发起请求-wx-request-方法"><a href="#发起请求-wx-request-方法" class="headerlink" title="发起请求 wx.request 方法"></a>发起请求 wx.request 方法</h4><p>常规用法，请求地址加上回调函数</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 请求服务器数据 获取正在热映的电影</span>
wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 请求地址</span>
  url<span class="token operator">:</span> <span class="token string">"url"</span><span class="token punctuation">,</span>
  <span class="token comment">// 请求方式 默认就是get请求</span>
  method<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
  <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="获取请求数据"><a href="#获取请求数据" class="headerlink" title="获取请求数据"></a>获取请求数据</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 别忘了获取全局app</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">/**
   * 页面的初始数据
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 正在热映的电影数据</span>
    inTheaters<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// 即将上映的电影数据</span>
    comingSoon<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// top250</span>
    top250<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 请求服务器数据 获取正在热映的电影</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 请求地址</span>
      url<span class="token operator">:</span> app<span class="token punctuation">.</span>gBaseUrl<span class="token operator">+</span><span class="token string">'in_theaters'</span><span class="token punctuation">,</span>
      method<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
      <span class="token comment">// 参数 在get请求中为查询字符串</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 电影的起始索引</span>
        start<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token comment">// 电影的总条数</span>
        count<span class="token operator">:</span> <span class="token number">3</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span> <span class="token comment">// 使用箭头函数解决this指向问题</span>
        <span class="token comment">// 电影数据</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>subjects<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          inTheaters<span class="token operator">:</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>subjects
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 即将上映的数据</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 请求地址</span>
      url<span class="token operator">:</span> app<span class="token punctuation">.</span>gBaseUrl<span class="token operator">+</span><span class="token string">'coming_soon'</span><span class="token punctuation">,</span>
      method<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        start<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        count<span class="token operator">:</span> <span class="token number">3</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token comment">// console.log(res);</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          comingSoon<span class="token operator">:</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>subjects
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// top250</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 请求地址</span>
      url<span class="token operator">:</span> app<span class="token punctuation">.</span>gBaseUrl<span class="token operator">+</span><span class="token string">'top250'</span><span class="token punctuation">,</span>
      method<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        start<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        count<span class="token operator">:</span> <span class="token number">3</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          top250<span class="token operator">:</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>subjects
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="将数据绑定到-movie-list-组件"><a href="#将数据绑定到-movie-list-组件" class="headerlink" title="将数据绑定到 movie-list 组件"></a>将数据绑定到 movie-list 组件</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--pages/movies/movies.wxml--&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>movie-list</span> <span class="token attr-name">movies</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{inTheaters}}<span class="token punctuation">"</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>正在热映<span class="token punctuation">"</span></span> <span class="token attr-name">l-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>movie-list<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>movie-list</span> <span class="token attr-name">movies</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{comingSoon}}<span class="token punctuation">"</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>正在上映<span class="token punctuation">"</span></span> <span class="token attr-name">l-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>movie-list<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>movie-list</span> <span class="token attr-name">movies</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{top250}}<span class="token punctuation">"</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>豆瓣Top250<span class="token punctuation">"</span></span> <span class="token attr-name">l-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>movie-list<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="movie-list-组件数据的替换"><a href="#movie-list-组件数据的替换" class="headerlink" title="movie-list 组件数据的替换"></a>movie-list 组件数据的替换</h4><p>现在，数据已经传递进来了，我们要做的就是动态替换实际的电影列表数据，并将<strong>每个电影的数据传递给电影组件</strong>。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210831083904536.png" alt="image-20210831083904536"></p>
<h4 id="movie-组件的数据替换"><a href="#movie-组件的数据替换" class="headerlink" title="movie 组件的数据替换"></a>movie 组件的数据替换</h4><p>接下来将 movie 组件的死数据替换为真实数据即可。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210831084105206.png" alt="image-20210831084105206"></p>
<h4 id="效果-1"><a href="#效果-1" class="headerlink" title="效果"></a>效果</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210831084148756.png" alt="image-20210831084148756"></p>
<p>有些图片加载不出来，和星星显示有误很正常，毕竟不是我们自己写的服务端数据。肯定会出现数据图片等有问题的错误。</p>
<h1 id="微信小程序入门-七-–入门篇完结"><a href="#微信小程序入门-七-–入门篇完结" class="headerlink" title="微信小程序入门(七)–入门篇完结"></a>微信小程序入门(七)–入门篇完结</h1><h3 id="实现电影页面按钮的更多功能"><a href="#实现电影页面按钮的更多功能" class="headerlink" title="实现电影页面按钮的更多功能"></a>实现电影页面按钮的更多功能</h3><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901094428669.png" alt="image-20210901094428669"></p>
<p>点击更多按钮，进入电影的更多页面。</p>
<p><strong>所以我们接下来就先获取到请求的数据，来构建更多电影页面。</strong></p>
<h4 id="获取数据"><a href="#获取数据" class="headerlink" title="获取数据"></a>获取数据</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901105620511.png" alt="image-20210901105620511"></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 页面的初始数据
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 电影集合</span>
    movies<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 请求服务器数据 获取正在热映的电影</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 请求地址</span>
      url<span class="token operator">:</span> app<span class="token punctuation">.</span>gBaseUrl <span class="token operator">+</span> <span class="token string">'in_theaters'</span><span class="token punctuation">,</span>
      method<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
      <span class="token comment">// 参数 在get请求中为查询字符串</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 电影的起始索引</span>
        start<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token comment">// 电影的总条数</span>
        count<span class="token operator">:</span> <span class="token number">12</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 使用箭头函数解决this指向问题</span>
        <span class="token comment">// 电影数据</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>subjects<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          movies<span class="token operator">:</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>subjects
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901132458764.png" alt="image-20210901132458764"></p>
<h4 id="more-movie-页面布局"><a href="#more-movie-页面布局" class="headerlink" title="more-movie 页面布局"></a>more-movie 页面布局</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901134323343.png" alt="image-20210901134323343"></p>
<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* pages/more-movie/more-movie.wxss */</span>
<span class="token comment">/* 容器 */</span>
<span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token comment">/* 排列不下的时候，自动换行 */</span>
  <span class="token property">flex-wrap</span><span class="token punctuation">:</span> wrap<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 30rpx 28rpx<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.movie</span> <span class="token punctuation">{</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 26rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>这里，我们可以发现，并没有用外部样式类来设置组件的样式，而是直接给组件添加样式类，设置的样式也生效。这里的生效原因应该是这个组件被 view 标签进行了包裹，所以设置的样式才会生效，如果没有被其他标签包裹，而是一个单独的标签，应该是设置样式不会生效，除非使用外部样式类。</strong></p>
<p>像下面这种就不会生效。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>movie</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>movie<span class="token punctuation">"</span></span> <span class="token attr-name">movie</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{movie}}<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="movies-页面更多按钮绑定事件"><a href="#movies-页面更多按钮绑定事件" class="headerlink" title="movies 页面更多按钮绑定事件"></a>movies 页面更多按钮绑定事件</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901135014871.png" alt="image-20210901135014871"></p>
<p>在每个电影列表上都绑定好当前所属的列表类型。用自定义属性进行绑定。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901135603377.png" alt="image-20210901135603377"></p>
<h5 id="更多按钮的事件"><a href="#更多按钮的事件" class="headerlink" title="更多按钮的事件"></a>更多按钮的事件</h5><p>通过 event 事件属性取到我们在当前元素上自定义的属性，进行页面跳转的时候，将电影类型一并传过去，方法更多电影页面发起请求。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 页面跳转
   * @param {*} event
   */</span>
  <span class="token function">onGoToMore</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 类型</span>
    <span class="token keyword">const</span> type <span class="token operator">=</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>type<span class="token punctuation">;</span>
    <span class="token comment">// 跳转到更多页面 以子页面的形式打开</span>
    wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token operator">:</span> <span class="token string">"/pages/more-movie/more-movie?type="</span><span class="token operator">+</span>type
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="更多页面-onLoad-的更改"><a href="#更多页面-onLoad-的更改" class="headerlink" title="更多页面 onLoad 的更改"></a>更多页面 onLoad 的更改</h5><p>需要请求的具体电影列表，通过 type 属性进行接收。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取电影列表类型</span>
    <span class="token keyword">const</span> type <span class="token operator">=</span> options<span class="token punctuation">.</span>type<span class="token punctuation">;</span>
    <span class="token comment">// 请求服务器数据 获取正在热映的电影</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 请求地址</span>
      url<span class="token operator">:</span> app<span class="token punctuation">.</span>gBaseUrl <span class="token operator">+</span> type<span class="token punctuation">,</span>
      method<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
      <span class="token comment">// 参数 在get请求中为查询字符串</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 电影的起始索引</span>
        start<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token comment">// 电影的总条数</span>
        count<span class="token operator">:</span> <span class="token number">12</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 使用箭头函数解决this指向问题</span>
        <span class="token comment">// 电影数据</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>subjects<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          movies<span class="token operator">:</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>subjects
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="实现-movies-电影页面的搜索功能"><a href="#实现-movies-电影页面的搜索功能" class="headerlink" title="实现 movies 电影页面的搜索功能"></a>实现 movies 电影页面的搜索功能</h4><p>直接使用<strong>lin-ui</strong>小程序组件库进行开发。方便快捷，没什么写的必要。</p>
<h5 id="注册组件"><a href="#注册组件" class="headerlink" title="注册组件"></a>注册组件</h5><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"usingComponents"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"movie-list"</span><span class="token operator">:</span> <span class="token string">"/components/movie-list/index"</span><span class="token punctuation">,</span>
    <span class="token property">"l-search-bar"</span><span class="token operator">:</span> <span class="token string">"/miniprogram_npm/lin-ui/search-bar/index"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h5><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 搜索栏 --&gt;</span>
<span class="token comment">&lt;!-- bg-color属性 更改背景颜色 --&gt;</span>
<span class="token comment">&lt;!-- 我们这里使用该组件提供好的外部样式类，进行样式的更改，修改高度 --&gt;</span>
<span class="token comment">&lt;!-- 这些东西官网都有说明 --&gt;</span>
<span class="token comment">&lt;!-- 使用show-cancel属性 可以取消 右侧的取消按钮及其事件 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-search-bar</span> <span class="token attr-name">l-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ex-search-bar<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>请输入您想看的电影<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* 外部样式类 */</span>
<span class="token selector">.ex-search-bar</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 可能发生了样式冲突，所以我们需要提高优先级 */</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 90rpx <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901141433978.png" alt="image-20210901141433978"></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901141517765.png" alt="image-20210901141517765"></p>
<h2 id="上滑加载更多电影数据"><a href="#上滑加载更多电影数据" class="headerlink" title="上滑加载更多电影数据"></a>上滑加载更多电影数据</h2><p>我们每次请求的数据，默认的条数都是 12 条，所以用户可能一会就滑到了最底部，其实，小程序的生命周期里面，提供的有关于滑到到页面底部的回调函数。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901142611984.png" alt="image-20210901142611984"></p>
<p>可以看见，只要你滑动到最底部，我们在这个函数里面写的代码就会被打印。说明该函数的确是执行了。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901142725171.png" alt="image-20210901142725171"></p>
<p><strong>所以我们可以在这个函数里面书写继续发起请求电影列表的代码。</strong></p>
<h5 id="加载更多电影数据"><a href="#加载更多电影数据" class="headerlink" title="加载更多电影数据"></a>加载更多电影数据</h5><p>将前面我们在 onLoad 方法里面拿到的 type 值，也就是电影列表的类型进行保存。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901144912320.png" alt="image-20210901144912320"></p>
<p><strong>发起请求获取数据</strong></p>
<p>代码逻辑都写在页面上啦触底事件的生命周期函数中。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 页面上拉触底事件的处理函数
   */</span>
  <span class="token function-variable function">onReachBottom</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 请求服务器数据 获取正在热映的电影</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 请求地址</span>
      url<span class="token operator">:</span> app<span class="token punctuation">.</span>gBaseUrl <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_type<span class="token punctuation">,</span>
      method<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
      <span class="token comment">// 参数 在get请求中为查询字符串</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 电影的起始索引</span>
        start<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>movies<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
        <span class="token comment">// 电影的总条数</span>
        count<span class="token operator">:</span> <span class="token number">12</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 使用箭头函数解决this指向问题</span>
        <span class="token comment">// 电影数据</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token comment">// 追加数据</span>
          movies<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>movies<span class="token punctuation">,</span> <span class="token operator">...</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>subjects<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="提示用户数据请求中"><a href="#提示用户数据请求中" class="headerlink" title="提示用户数据请求中"></a>提示用户数据请求中</h3><p>我们在发起请求获取新的电影数据的时候，很可能出现用户多次发起请求，但是此时网络情况并不好，这时候页面的刷新就比较慢，<strong>这时候我们就需要提醒用户页面数据正在刷新。用小程序的内置组件就可以完成这种轻提示。</strong></p>
<p>我们的目的就是，数据请求过程中，页面还没刷新完毕的时候，提示用户正在加载，一旦数据请求成功并且页面开始刷新了，就不应该还继续提示用户正在加载数据。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901150131517.png" alt="image-20210901150131517"></p>
<p>只需要添加显示和隐藏加载动画的提示框即可。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 页面上拉触底事件的处理函数
   */</span>
  <span class="token function-variable function">onReachBottom</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 请求数据前 提示用户正在加载数据 刷新页面 显示加载动画</span>
    wx<span class="token punctuation">.</span><span class="token function">showNavigationBarLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 请求服务器数据 获取正在热映的电影</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 请求地址</span>
      url<span class="token operator">:</span> app<span class="token punctuation">.</span>gBaseUrl <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_type<span class="token punctuation">,</span>
      method<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
      <span class="token comment">// 参数 在get请求中为查询字符串</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 电影的起始索引</span>
        start<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>movies<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
        <span class="token comment">// 电影的总条数</span>
        count<span class="token operator">:</span> <span class="token number">12</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 使用箭头函数解决this指向问题</span>
        <span class="token comment">// 电影数据</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token comment">// 追加数据</span>
          movies<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>movies<span class="token punctuation">,</span> <span class="token operator">...</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>subjects<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 电影数据请求完毕了，隐藏正在加载的提示框动画</span>
        wx<span class="token punctuation">.</span><span class="token function">hideNavigationBarLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901150318850.png" alt="image-20210901150318850"></p>
<h2 id="下拉刷新数据"><a href="#下拉刷新数据" class="headerlink" title="下拉刷新数据"></a>下拉刷新数据</h2><h3 id="开启页面的下拉刷新"><a href="#开启页面的下拉刷新" class="headerlink" title="开启页面的下拉刷新"></a>开启页面的下拉刷新</h3><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"usingComponents"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"movie"</span><span class="token operator">:</span> <span class="token string">"/components/movie/index"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 开启下拉刷新</span>
  <span class="token property">"enablePullDownRefresh"</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果在 app.json 里面配置这个的话，那么在所有的页面都可以进行下来是刷新了。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901152450885.png" alt="image-20210901152450885"></p>
<h3 id="监听用户下拉动作"><a href="#监听用户下拉动作" class="headerlink" title="监听用户下拉动作"></a>监听用户下拉动作</h3><p>小程序默认给我们提供好的有小程序页面监听下拉动作的函数。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901153626697.png" alt="image-20210901153626697"></p>
<h3 id="实现下拉刷新"><a href="#实现下拉刷新" class="headerlink" title="实现下拉刷新"></a>实现下拉刷新</h3><p>这个就比较简单了，直接一段代码搞定。获取数据以后，调用 wx.stopPullDownRefresh()方法，停止下拉的动作。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 页面相关事件处理函数--监听用户下拉动作
   */</span>
  <span class="token function-variable function">onPullDownRefresh</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 用户进行下拉以后，我们就刷新数据</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token operator">:</span> app<span class="token punctuation">.</span>gBaseUrl <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_type<span class="token punctuation">,</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        start<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        count<span class="token operator">:</span> <span class="token number">12</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          movies<span class="token operator">:</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>subjects
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment">// 关闭我们的下拉刷新动画</span>
        wx<span class="token punctuation">.</span><span class="token function">stopPullDownRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="增强阅读页面效果"><a href="#增强阅读页面效果" class="headerlink" title="增强阅读页面效果"></a>增强阅读页面效果</h2><h3 id="配置标题与动态配置标题"><a href="#配置标题与动态配置标题" class="headerlink" title="配置标题与动态配置标题"></a>配置标题与动态配置标题</h3><h4 id="配置标题"><a href="#配置标题" class="headerlink" title="配置标题"></a>配置标题</h4><p><strong>使用小程序全局的 window 对象里面的 navigationBarTitleText 属性，</strong>设置导航栏的标题。</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"光与影"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>但是这样配置的标题是死标题，而且，还不能动态的改变，对于组件来说，这样配置无疑是没什么用的。我们应该让这个标题是动态的。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901161053852.png" alt="image-20210901161053852"></p>
<h4 id="动态配置标题"><a href="#动态配置标题" class="headerlink" title="动态配置标题"></a>动态配置标题</h4><p>很明显，动态配置标题是不可获取的，对于这种常用的功能，小程序基本都帮我们提供好了。</p>
<p><strong>使用小程序的 wx.setNavigationBarTitle</strong>方法就可以动态的设置我们想设置的标题了。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901161503637.png" alt="image-20210901161503637"></p>
<p>我们将这部分动态设置标题的代码写在 onReady 生命周期中，页面只有第一次加载才需要设置标题的。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 生命周期函数--监听页面初次渲染完成
   */</span>
  <span class="token function-variable function">onReady</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> title <span class="token operator">=</span> <span class="token string">"电影"</span><span class="token punctuation">;</span>
    <span class="token comment">// 根据类型渲染不同的标题</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">"in_theaters"</span><span class="token operator">:</span>
        title <span class="token operator">=</span> <span class="token string">"正在热映"</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">"coming_soon"</span><span class="token operator">:</span>
        title <span class="token operator">=</span> <span class="token string">"即将上映"</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">"top250"</span><span class="token operator">:</span>
        title <span class="token operator">=</span> <span class="token string">"Top250"</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    wx<span class="token punctuation">.</span><span class="token function">setNavigationBarTitle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      title
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="电影详情页"><a href="#电影详情页" class="headerlink" title="电影详情页"></a>电影详情页</h2><h3 id="组件的独立性"><a href="#组件的独立性" class="headerlink" title="组件的独立性"></a>组件的独立性</h3><h4 id="对-post-组件进行改进"><a href="#对-post-组件进行改进" class="headerlink" title="对 post 组件进行改进"></a>对 post 组件进行改进</h4><p>开始，我们是将点击文章，去文章详情页的点击事件的回调函数，直接写死在了组件上，这肯定是不合理的。因为不可能每个人用组件，点击之后的操作都是同样的。所以回调函数的执行应该让外界传递。提高组件的复用性，让组件与事件的具体执行操作独立开来。这就是组件的独立性。</p>
<h5 id="发射事件"><a href="#发射事件" class="headerlink" title="发射事件"></a>发射事件</h5><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901172629488.png" alt="image-20210901172629488"></p>
<p>当然，携带的参数也不一定非要通过当前事件的目标对象身上的属性来获取，毕竟我们组件上其实已经有这一篇文章的全部信息了。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901173604854.png" alt="image-20210901173604854"></p>
<h5 id="接收事件"><a href="#接收事件" class="headerlink" title="接收事件"></a>接收事件</h5><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901172743182.png" alt="image-20210901172743182"></p>
<p>这种做功能一样还是正常实现，但是提高了组件的可复用性。</p>
<h4 id="文章页面问题修正"><a href="#文章页面问题修正" class="headerlink" title="文章页面问题修正"></a>文章页面问题修正</h4><p>虽然我们上面那种做法，提高了组件的复用性。但是现在带来了新的问题，那就是我们点击图片是无法完成跳转了。</p>
<h5 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h5><p>最简单的方式当然是直接在写一个方法，按照之前的逻辑就完事。简单易懂。</p>
<h5 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h5><p>我们可以还是在一个方法里面实现点击上面轮播图实现正常跳转。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// event  事件</span>
  <span class="token function">onGoToDetail</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// console.log(event.type); // 可以获取触发的事件类型</span>
    <span class="token keyword">let</span> pid <span class="token operator">=</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>postId<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>pid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 没有获取到，说明是点击文章进行跳转的</span>
      pid <span class="token operator">=</span> event<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>pid<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 跳转文章详情页 event.detail.pid 可以拿到我们组件发射事件时携带的参数</span>
      url<span class="token operator">:</span> <span class="token string">"/pages/post-detail/post-detail?pid="</span> <span class="token operator">+</span> pid<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="电影详情页的制作"><a href="#电影详情页的制作" class="headerlink" title="电影详情页的制作"></a>电影详情页的制作</h3><h4 id="给自定义组件-movie-绑定事件"><a href="#给自定义组件-movie-绑定事件" class="headerlink" title="给自定义组件 movie 绑定事件"></a>给自定义组件 movie 绑定事件</h4><p>为了开发方便，这里我是讲业务代码封装了一部分在组件上，实际上一个好的组件不应该这样，这里是因为这是我们自己写的业务组件，纯粹是为了自己方便，所以可以这样做。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901191651266.png" alt="image-20210901191651266"></p>
<p>在点击每个电影，都可以去往电影详情页。而且携带了当前电影的 id 号。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901191749501.png" alt="image-20210901191749501"></p>
<h4 id="根据-id-请求电影数据"><a href="#根据-id-请求电影数据" class="headerlink" title="根据 id 请求电影数据"></a>根据 id 请求电影数据</h4><p>根据 mid，向服务器发起请求，获取当前电影的详情数据。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901192622268.png" alt="image-20210901192622268"></p>
<h4 id="绑定数据"><a href="#绑定数据" class="headerlink" title="绑定数据"></a>绑定数据</h4><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901192823290.png" alt="image-20210901192823290"></p>
<h4 id="详情页的制作"><a href="#详情页的制作" class="headerlink" title="详情页的制作"></a>详情页的制作</h4><h5 id="详情页头部区域"><a href="#详情页头部区域" class="headerlink" title="详情页头部区域"></a>详情页头部区域</h5><p>前面我们已经获取到每个电影详情页的电影详情数据。接下来开始电影详情的头部制作。</p>
<p><strong>骨架</strong></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--pages/movie-detail/movie-detail.wxml--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 头部大图(做模糊效果) --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>head-img<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{movie.images.large}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 头部标题，副标题 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>head-image-hover<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>main-title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{movie.title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sub-title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{movie.countries[0] + " · " +movie.year}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 多少人想看，多少人喜欢 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>like<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>highlight-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{movie.wish_count}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>plain-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>人喜欢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>highlight-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{movie.comments_count}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>plain-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>条评论<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 电影海报 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>movie-image<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{movie.images.large}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>样式</strong></p>
<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* pages/movie-detail/movie-detail.wxss */</span>

<span class="token comment">/* 容器 */</span>
<span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 头部海报 做模糊效果图 */</span>
<span class="token selector">.head-img</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 320rpx<span class="token punctuation">;</span>
  <span class="token comment">/* 模糊效果 */</span>
  <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token function">blur</span><span class="token punctuation">(</span>18px<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 标题 */</span>
<span class="token selector">.head-image-hover</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 320rpx<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.main-title</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 38rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
  <span class="token property">letter-spacing</span><span class="token punctuation">:</span> 2px<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 50rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.sub-title</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.like</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 数字高亮 */</span>
<span class="token selector">.highlight-font</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #f21146<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 22rpx<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> 600<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.plain-font</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 22rpx<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 电影海报 */</span>
<span class="token selector">.movie-image</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 160rpx<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 238rpx<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 175rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>效果</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901205540785.png" alt="image-20210901205540785"></p>
<p>没错，是我要的。</p>
<h5 id="头部电影海报-预览"><a href="#头部电影海报-预览" class="headerlink" title="头部电影海报(预览)"></a>头部电影海报(预览)</h5><p>做小程序的海报放大方式，也就是我们所说的预览。小程序原生给我们提供的有这种方法。</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901211056877.png" alt="image-20210901211056877"></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 图片预览
   * @param {*} event
   */</span>
  <span class="token function">onViewPost</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    wx<span class="token operator">:</span> wx<span class="token punctuation">.</span><span class="token function">previewImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 预览的图片，可以有多个 值是src的值 也就是链接地址</span>
      urls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>movie<span class="token punctuation">.</span>images<span class="token punctuation">.</span>large<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// 当前预览的第一张图片</span>
      current<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>movie<span class="token punctuation">.</span>images<span class="token punctuation">.</span>large
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>大部分功能基本上小程序都内置过了。想要做什么效果，建议第一件事是去文档查一下有没有。</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901211352153.png" alt="image-20210901211352153"></p>
<h4 id="图片的-mode-模式"><a href="#图片的-mode-模式" class="headerlink" title="图片的 mode 模式"></a>图片的 mode 模式</h4><p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/image.html">图片的 mode 模式，懂的都懂</a></p>
<p>默认不设置的模式：</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901212027581.png" alt="image-20210901212027581"></p>
<p>设置 mode<strong>模式为 aspectFill</strong>时：</p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901212121039.png" alt="image-20210901212121039"></p>
<p>很明显，可以看出图片没有被拉伸。</p>
<p><strong>当然，mode 模式的值很多，可以去官网多看看</strong></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901212313363.png" alt="image-20210901212313363"></p>
<h4 id="电影详情页建议简介部分"><a href="#电影详情页建议简介部分" class="headerlink" title="电影详情页建议简介部分"></a>电影详情页建议简介部分</h4><h5 id="数据的预处理"><a href="#数据的预处理" class="headerlink" title="数据的预处理"></a>数据的预处理</h5><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901213932843.png" alt="image-20210901213932843"></p>
<p>可以看见，我们获取到数据，很多都是数组，不便于页面的数据展示，所以需要对数据进行预处理。</p>
<h5 id="封装一个工具函数"><a href="#封装一个工具函数" class="headerlink" title="封装一个工具函数"></a>封装一个工具函数</h5><p>该函数用来处理导演和演员数组，拼接元素的 name 属性。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
 * 将数组元素里面的name属性转为字符串拼接
 * @param {*} casts 数组 可以拼接演员和导演数组的name
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">convertToCastString</span><span class="token punctuation">(</span><span class="token parameter">casts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  casts<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    names<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> names<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">" / "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="数据的处理"><a href="#数据的处理" class="headerlink" title="数据的处理"></a>数据的处理</h5><p>对数据进行预处理，方便页面进行更好的展示</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// pages/movie-detail/movie-detail.js</span>
<span class="token comment">// 导入util工具</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> convertToCastString <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../../utils/util.js"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">/**
   * 页面的初始数据
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 电影详情数据</span>
    movie<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 获取电影详细数据</span>
      url<span class="token operator">:</span> app<span class="token punctuation">.</span>gBaseUrl <span class="token operator">+</span> <span class="token string">"subject/"</span> <span class="token operator">+</span> options<span class="token punctuation">.</span>mid<span class="token punctuation">,</span>
      method<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 电影数据预处理</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">processMovieData</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 数据绑定 方法处理好数据以后，内部绑定</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 图片预览
   * @param {*} event
   */</span>
  <span class="token function">onViewPost</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    wx<span class="token operator">:</span> wx<span class="token punctuation">.</span><span class="token function">previewImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 预览的图片，可以有多个 值是src的值 也就是链接地址</span>
      urls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>movie<span class="token punctuation">.</span>image<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// 当前预览的第一张图片</span>
      current<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>movie<span class="token punctuation">.</span>image<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 对请求的电影数据进行预处理
   * @param {*} movie 电影数据
   */</span>
  <span class="token function">processMovieData</span><span class="token punctuation">(</span><span class="token parameter">movie</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 处理后的数据</span>
    <span class="token keyword">const</span> movieData <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 处理导演和演员数组</span>
    movieData<span class="token punctuation">.</span>directorsStr <span class="token operator">=</span> <span class="token function">convertToCastString</span><span class="token punctuation">(</span>movie<span class="token punctuation">.</span>directors<span class="token punctuation">)</span><span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>castsStr <span class="token operator">=</span> <span class="token function">convertToCastString</span><span class="token punctuation">(</span>movie<span class="token punctuation">.</span>casts<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 图片处理一下</span>
    movieData<span class="token punctuation">.</span>image <span class="token operator">=</span> movie<span class="token punctuation">.</span>images<span class="token punctuation">.</span>large<span class="token punctuation">;</span>
    <span class="token comment">// 标题处理</span>
    movieData<span class="token punctuation">.</span>title <span class="token operator">=</span> movie<span class="token punctuation">.</span>title<span class="token punctuation">;</span>
    <span class="token comment">// 副标题</span>
    movieData<span class="token punctuation">.</span>sub_title <span class="token operator">=</span> movie<span class="token punctuation">.</span>countries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">" · "</span> <span class="token operator">+</span> movie<span class="token punctuation">.</span>year<span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>wishCount <span class="token operator">=</span> movie<span class="token punctuation">.</span>wish_count<span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>commentsCount <span class="token operator">=</span> movie<span class="token punctuation">.</span>comments_count<span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>originalTitle <span class="token operator">=</span> movie<span class="token punctuation">.</span>original_title<span class="token punctuation">;</span>
    <span class="token comment">// 评分</span>
    movieData<span class="token punctuation">.</span>score <span class="token operator">=</span> movie<span class="token punctuation">.</span>rating<span class="token punctuation">.</span>stars <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>average <span class="token operator">=</span> movie<span class="token punctuation">.</span>rating<span class="token punctuation">.</span>average<span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>genresStr <span class="token operator">=</span> movie<span class="token punctuation">.</span>genres<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">" / "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 数据绑定</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      movie<span class="token operator">:</span> movieData<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="页面数据展示"><a href="#页面数据展示" class="headerlink" title="页面数据展示"></a>页面数据展示</h5><p>这里只截取了其中的电影简介部分。也就是我们当前写的这一部分。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 电影简介 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>summary<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 起始标题 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orgin-title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{movie.originalTitle}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>flex-row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mark<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>评分<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- lin-ui的评分组件 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>score-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-rate</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>22<span class="token punctuation">"</span></span> <span class="token attr-name">disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{true}}<span class="token punctuation">"</span></span> <span class="token attr-name">score</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{movie.score}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>l-rate</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>average<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{movie.average}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>flex-row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mark<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>导演<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 导演可能有多个，需要进行数据处理 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{movie.directorsStr}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>flex-row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mark<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>影人<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 影人也需要进行数据处理，也是数组 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{movie.castsStr}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>flex-row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mark<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>类型<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 一般类型也是数组，都需要进行对原始处理 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{movie.genresStr}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 分割线 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="电影简介的样式书写"><a href="#电影简介的样式书写" class="headerlink" title="电影简介的样式书写"></a>电影简介的样式书写</h5><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* 电影简介 */</span>
<span class="token selector">.summary</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #777<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.orginal-title</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #1f3463<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 24rpx<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.flex-row</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> baseline<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.score-container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> baseline<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.average</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.mark</span> <span class="token punctuation">{</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token comment">/* 不换行 */</span>
  <span class="token property">white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 水平线 */</span>
<span class="token selector">.hr</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 50rpx<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #d9d9d9<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="效果-2"><a href="#效果-2" class="headerlink" title="效果"></a>效果</h5><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901223856720.png" alt="image-20210901223856720"></p>
<h4 id="电影剧情简介"><a href="#电影剧情简介" class="headerlink" title="电影剧情简介"></a>电影剧情简介</h4><p>没啥好说的，都简单了</p>
<h5 id="结构-1"><a href="#结构-1" class="headerlink" title="结构"></a>结构</h5><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 剧情简介 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>synopsis<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>synopsis-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>剧情简介<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>summary-content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{movie.summary}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="样式-1"><a href="#样式-1" class="headerlink" title="样式"></a>样式</h5><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* 剧情简介样式 */</span>
<span class="token selector">.synopsis</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 50rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.synopsis-font</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 32rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.summary-content</span> <span class="token punctuation">{</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">letter-spacing</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">text-indent</span><span class="token punctuation">:</span> 2em<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="影人部分制作"><a href="#影人部分制作" class="headerlink" title="影人部分制作"></a>影人部分制作</h4><p>这个部分其实有点难。<strong>好好看好好学</strong></p>
<h5 id="增加的数据预处理部分"><a href="#增加的数据预处理部分" class="headerlink" title="增加的数据预处理部分"></a>增加的数据预处理部分</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
 * 将数组元素里面的name属性转为字符串拼接
 * @param {*} casts 数组 可以拼接演员和导演数组的name
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">convertToCastString</span><span class="token punctuation">(</span><span class="token parameter">casts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  casts<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    names<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> names<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">" / "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
 * 整合影人的信息 图片和名字
 * @param {*} casts
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">convertToCastInfos</span><span class="token punctuation">(</span><span class="token parameter">casts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> castsArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  casts<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    castsArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      img<span class="token operator">:</span> item<span class="token punctuation">.</span>avatars<span class="token operator">?.</span>large<span class="token punctuation">,</span>
      name<span class="token operator">:</span> item<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> castsArray<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
   * 对请求的电影数据进行预处理
   * @param {*} movie 电影数据
   */</span>
  <span class="token function">processMovieData</span><span class="token punctuation">(</span><span class="token parameter">movie</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 处理后的数据</span>
    <span class="token keyword">const</span> movieData <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 处理导演和演员数组</span>
    movieData<span class="token punctuation">.</span>directorsStr <span class="token operator">=</span> <span class="token function">convertToCastString</span><span class="token punctuation">(</span>movie<span class="token punctuation">.</span>directors<span class="token punctuation">)</span><span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>castsStr <span class="token operator">=</span> <span class="token function">convertToCastString</span><span class="token punctuation">(</span>movie<span class="token punctuation">.</span>casts<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 图片处理一下</span>
    movieData<span class="token punctuation">.</span>image <span class="token operator">=</span> movie<span class="token punctuation">.</span>images<span class="token punctuation">.</span>large<span class="token punctuation">;</span>
    <span class="token comment">// 标题处理</span>
    movieData<span class="token punctuation">.</span>title <span class="token operator">=</span> movie<span class="token punctuation">.</span>title<span class="token punctuation">;</span>
    <span class="token comment">// 副标题</span>
    movieData<span class="token punctuation">.</span>sub_title <span class="token operator">=</span> movie<span class="token punctuation">.</span>countries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">" · "</span> <span class="token operator">+</span> movie<span class="token punctuation">.</span>year<span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>wishCount <span class="token operator">=</span> movie<span class="token punctuation">.</span>wish_count<span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>commentsCount <span class="token operator">=</span> movie<span class="token punctuation">.</span>comments_count<span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>originalTitle <span class="token operator">=</span> movie<span class="token punctuation">.</span>original_title<span class="token punctuation">;</span>
    <span class="token comment">// 评分</span>
    movieData<span class="token punctuation">.</span>score <span class="token operator">=</span> movie<span class="token punctuation">.</span>rating<span class="token punctuation">.</span>stars <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>average <span class="token operator">=</span> movie<span class="token punctuation">.</span>rating<span class="token punctuation">.</span>average<span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>genresStr <span class="token operator">=</span> movie<span class="token punctuation">.</span>genres<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">" / "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>summary <span class="token operator">=</span> movie<span class="token punctuation">.</span>summary<span class="token punctuation">;</span>
    <span class="token comment">// 处理影人数据</span>
    movieData<span class="token punctuation">.</span>castsInfo <span class="token operator">=</span> <span class="token function">convertToCastInfos</span><span class="token punctuation">(</span>movie<span class="token punctuation">.</span>casts<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 数据绑定</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      movie<span class="token operator">:</span> movieData
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="结构-2"><a href="#结构-2" class="headerlink" title="结构"></a>结构</h5><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 影人简介 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>casts<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 标题 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>影人<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>casts-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 列表循环 展示影人数据 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{movie.castsInfo}}<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-img<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{item.img}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{item.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 模拟多个影人数据，让一个影人出现三次，做图片的滑动效果 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-img<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{item.img}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{item.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-img<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{item.img}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{item.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="样式-2"><a href="#样式-2" class="headerlink" title="样式"></a>样式</h5><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* 影人简介布局 */</span>
<span class="token selector">.casts</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 50rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.casts-container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.cast-container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 60rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.cast-img</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 170rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 210rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 12rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.cast-font</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="滑动效果"><a href="#滑动效果" class="headerlink" title="滑动效果"></a>滑动效果</h4><h5 id="小程序的滑动组件"><a href="#小程序的滑动组件" class="headerlink" title="小程序的滑动组件"></a>小程序的滑动组件</h5><p>小程序提供的内置组件里面有 scroll-view 组件，可以用来替换 view 组件。</p>
<p>提供这个标签，可以进行横向的滑动，做成可滚动的视图区域。</p>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/scroll-view.html">你想要的 scroll-view 这都有</a></p>
<p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901232227835.png" alt="image-20210901232227835"></p>
<h5 id="效果-3"><a href="#效果-3" class="headerlink" title="效果"></a>效果</h5><p><img src="https://gitee.com/maolovecoding/picture/raw/master/images/web/wei_chat/image-20210901232321718.png" alt="image-20210901232321718"></p>
<h3 id="电影详情页完整代码"><a href="#电影详情页完整代码" class="headerlink" title="电影详情页完整代码"></a>电影详情页完整代码</h3><h4 id="结构-3"><a href="#结构-3" class="headerlink" title="结构"></a>结构</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--pages/movie-detail/movie-detail.wxml--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 头部大图(做模糊效果) --&gt;</span>
  <span class="token comment">&lt;!-- 图片的填充模式，默认的填充模式，在我们不知道图片比例的情况下，一般设置宽高撑满，容易出现变形。拉伸 --&gt;</span>
  <span class="token comment">&lt;!-- mode="aspectFill" 设置这个值，会保持原来图片的比例进行缩放，可以保证某一个方向是完整的，另一个方向被裁减 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aspectFill<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>head-img<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{movie.image}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 头部标题，副标题 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>head-image-hover<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>main-title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{movie.title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sub-title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{movie.sub_title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 多少人想看，多少人喜欢 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>like<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>highlight-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{movie.wishCount}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>plain-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>人喜欢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>highlight-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{movie.commentsCount}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>plain-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>条评论<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 电影海报 --&gt;</span>
    <span class="token comment">&lt;!-- 点击图片实现放大效果 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>
      <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onViewPost<span class="token punctuation">"</span></span>
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>movie-image<span class="token punctuation">"</span></span>
      <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{movie.image}}<span class="token punctuation">"</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 电影简介 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>summary<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 起始标题 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orgin-title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{movie.originalTitle}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>flex-row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mark<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>评分<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- lin-ui的评分组件 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>score-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-rate</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>22<span class="token punctuation">"</span></span> <span class="token attr-name">disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{true}}<span class="token punctuation">"</span></span> <span class="token attr-name">score</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{movie.score}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>l-rate</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>average<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{movie.average}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>flex-row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mark<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>导演<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 导演可能有多个，需要进行数据处理 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{movie.directorsStr}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>flex-row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mark<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>影人<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 影人也需要进行数据处理，也是数组 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{movie.castsStr}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>flex-row<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mark<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>类型<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 一般类型也是数组，都需要进行对原始处理 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{movie.genresStr}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 分割线 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 剧情简介 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>synopsis<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>synopsis-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>剧情简介<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>summary-content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{{movie.summary}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 影人简介 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>casts<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 标题 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-font<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>影人<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- scroll-x="{{true}}" 表示进行横向滚动 --&gt;</span>
    <span class="token comment">&lt;!-- enable-flex = {{true}} 表示重新支持flex布局，scroll-view组件默认是不支持flex布局的，需要开启 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scroll-view</span>
      <span class="token attr-name">enable-flex</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{true}}<span class="token punctuation">"</span></span>
      <span class="token attr-name">scroll-x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{true}}<span class="token punctuation">"</span></span>
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>casts-container<span class="token punctuation">"</span></span>
    <span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 列表循环 展示影人数据 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{movie.castsInfo}}<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-img<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{item.img}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{item.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 模拟多个影人数据，让一个影人出现三次，做图片的滑动效果 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-img<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{item.img}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{item.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cast-img<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{{item.img}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{item.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scroll-view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="样式-3"><a href="#样式-3" class="headerlink" title="样式"></a>样式</h4><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token comment">/* pages/movie-detail/movie-detail.wxss */</span>

<span class="token comment">/* 容器 */</span>
<span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 头部海报 做模糊效果图 */</span>
<span class="token selector">.head-img</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 320rpx<span class="token punctuation">;</span>
  <span class="token comment">/* 模糊效果 */</span>
  <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token function">blur</span><span class="token punctuation">(</span>18px<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 标题 */</span>
<span class="token selector">.head-image-hover</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 320rpx<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.main-title</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 38rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
  <span class="token property">letter-spacing</span><span class="token punctuation">:</span> 2px<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 50rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.sub-title</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 28rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.like</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 数字高亮 */</span>
<span class="token selector">.highlight-font</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #f21146<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 22rpx<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> 600<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.plain-font</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 22rpx<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 电影海报 */</span>
<span class="token selector">.movie-image</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 160rpx<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 238rpx<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 175rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 电影简介 */</span>
<span class="token selector">.summary</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #777<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.orginal-title</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #1f3463<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 24rpx<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.flex-row</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> baseline<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.score-container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> baseline<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.average</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.mark</span> <span class="token punctuation">{</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 30rpx<span class="token punctuation">;</span>
  <span class="token comment">/* 不换行 */</span>
  <span class="token property">white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 水平线 */</span>
<span class="token selector">.hr</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 50rpx<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #d9d9d9<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 剧情简介样式 */</span>
<span class="token selector">.synopsis</span> <span class="token punctuation">{</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 50rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.synopsis-font</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 32rpx<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.summary-content</span> <span class="token punctuation">{</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">letter-spacing</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token property">text-indent</span><span class="token punctuation">:</span> 2em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 影人简介布局 */</span>
<span class="token selector">.casts</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 50rpx<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.casts-container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
  <span class="token comment">/* margin-bottom: 50rpx; */</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 300rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.cast-container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.cast-img</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 170rpx<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 210rpx<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 12rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.cast-font</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 40rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="行为"><a href="#行为" class="headerlink" title="行为"></a>行为</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// pages/movie-detail/movie-detail.js</span>
<span class="token comment">// 导入util工具</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> convertToCastString<span class="token punctuation">,</span> convertToCastInfos <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../../utils/util.js"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">/**
   * 页面的初始数据
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 电影详情数据</span>
    movie<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 获取电影详细数据</span>
      url<span class="token operator">:</span> app<span class="token punctuation">.</span>gBaseUrl <span class="token operator">+</span> <span class="token string">"subject/"</span> <span class="token operator">+</span> options<span class="token punctuation">.</span>mid<span class="token punctuation">,</span>
      method<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 电影数据预处理</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">processMovieData</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 数据绑定 方法处理好数据以后，内部绑定</span>
        <span class="token comment">// this.setData({</span>
        <span class="token comment">//   movie: res.data</span>
        <span class="token comment">// })</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 图片预览
   * @param {*} event
   */</span>
  <span class="token function">onViewPost</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    wx<span class="token operator">:</span> wx<span class="token punctuation">.</span><span class="token function">previewImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 预览的图片，可以有多个 值是src的值 也就是链接地址</span>
      urls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>movie<span class="token punctuation">.</span>image<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// 当前预览的第一张图片</span>
      current<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>movie<span class="token punctuation">.</span>image<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 对请求的电影数据进行预处理
   * @param {*} movie 电影数据
   */</span>
  <span class="token function">processMovieData</span><span class="token punctuation">(</span><span class="token parameter">movie</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 处理后的数据</span>
    <span class="token keyword">const</span> movieData <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 处理导演和演员数组</span>
    movieData<span class="token punctuation">.</span>directorsStr <span class="token operator">=</span> <span class="token function">convertToCastString</span><span class="token punctuation">(</span>movie<span class="token punctuation">.</span>directors<span class="token punctuation">)</span><span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>castsStr <span class="token operator">=</span> <span class="token function">convertToCastString</span><span class="token punctuation">(</span>movie<span class="token punctuation">.</span>casts<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 图片处理一下</span>
    movieData<span class="token punctuation">.</span>image <span class="token operator">=</span> movie<span class="token punctuation">.</span>images<span class="token punctuation">.</span>large<span class="token punctuation">;</span>
    <span class="token comment">// 标题处理</span>
    movieData<span class="token punctuation">.</span>title <span class="token operator">=</span> movie<span class="token punctuation">.</span>title<span class="token punctuation">;</span>
    <span class="token comment">// 副标题</span>
    movieData<span class="token punctuation">.</span>sub_title <span class="token operator">=</span> movie<span class="token punctuation">.</span>countries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">" · "</span> <span class="token operator">+</span> movie<span class="token punctuation">.</span>year<span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>wishCount <span class="token operator">=</span> movie<span class="token punctuation">.</span>wish_count<span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>commentsCount <span class="token operator">=</span> movie<span class="token punctuation">.</span>comments_count<span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>originalTitle <span class="token operator">=</span> movie<span class="token punctuation">.</span>original_title<span class="token punctuation">;</span>
    <span class="token comment">// 评分</span>
    movieData<span class="token punctuation">.</span>score <span class="token operator">=</span> movie<span class="token punctuation">.</span>rating<span class="token punctuation">.</span>stars <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>average <span class="token operator">=</span> movie<span class="token punctuation">.</span>rating<span class="token punctuation">.</span>average<span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>genresStr <span class="token operator">=</span> movie<span class="token punctuation">.</span>genres<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">" / "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    movieData<span class="token punctuation">.</span>summary <span class="token operator">=</span> movie<span class="token punctuation">.</span>summary<span class="token punctuation">;</span>
    <span class="token comment">// 处理影人数据</span>
    movieData<span class="token punctuation">.</span>castsInfo <span class="token operator">=</span> <span class="token function">convertToCastInfos</span><span class="token punctuation">(</span>movie<span class="token punctuation">.</span>casts<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 数据绑定</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      movie<span class="token operator">:</span> movieData<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">/**
   * 生命周期函数--监听页面初次渲染完成
   */</span>
  <span class="token function-variable function">onReady</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面显示
   */</span>
  <span class="token function-variable function">onShow</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面隐藏
   */</span>
  <span class="token function-variable function">onHide</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面卸载
   */</span>
  <span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 页面相关事件处理函数--监听用户下拉动作
   */</span>
  <span class="token function-variable function">onPullDownRefresh</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 页面上拉触底事件的处理函数
   */</span>
  <span class="token function-variable function">onReachBottom</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 用户点击右上角分享
   */</span>
  <span class="token function-variable function">onShareAppMessage</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="入门篇完结"><a href="#入门篇完结" class="headerlink" title="入门篇完结"></a>入门篇完结</h3><p>小程序相对于 vue 或者 react 来说还是比较简单的。入门容易。</p>
<h3 id="完整项目代码"><a href="#完整项目代码" class="headerlink" title="完整项目代码"></a>完整项目代码</h3><p><strong>完整项目代码放在 csdn 博客上，也可以去我的 github 上下载。</strong></p>
<h3 id="github-地址"><a href="#github-地址" class="headerlink" title="github 地址"></a>github 地址</h3><p><a target="_blank" rel="noopener" href="https://github.com/maolovecoding/first_mini_program">first_mini_program</a></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">毛毛</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://maolovecoding.github.io/2021/11/02/src/wechat/wei-xin-xiao-cheng-xu-ru-men/">https://maolovecoding.github.io/2021/11/02/src/wechat/wei-xin-xiao-cheng-xu-ru-men/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">毛毛</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/JavaScript/">
                                    <span class="chip bg-color">JavaScript</span>
                                </a>
                            
                                <a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/">
                                    <span class="chip bg-color">微信小程序</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2021/11/02/src/vue/vue3-chu-ti-yan/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/14.jpg" class="responsive-img" alt="vue3-初体验">
                        
                        <span class="card-title">vue3-初体验</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-11-02
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/vue/" class="post-category">
                                    vue
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/vue3/">
                        <span class="chip bg-color">vue3</span>
                    </a>
                    
                    <a href="/tags/ts/">
                        <span class="chip bg-color">ts</span>
                    </a>
                    
                    <a href="/tags/webpack/">
                        <span class="chip bg-color">webpack</span>
                    </a>
                    
                    <a href="/tags/compositionAPI/">
                        <span class="chip bg-color">compositionAPI</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/10/31/src/java/jpa-de-xue-xi/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/photo1/1.jpg" class="responsive-img" alt="Jpa的学习">
                        
                        <span class="card-title">Jpa的学习</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-10-31
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Java/" class="post-category">
                                    Java
                                </a>
                            
                            <a href="/categories/Java/Spring-Data/" class="post-category">
                                    Spring Data
                                </a>
                            
                            <a href="/categories/Java/Spring-Data/JPA/" class="post-category">
                                    JPA
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Spring-Data/">
                        <span class="chip bg-color">Spring Data</span>
                    </a>
                    
                    <a href="/tags/JPA/">
                        <span class="chip bg-color">JPA</span>
                    </a>
                    
                    <a href="/tags/java/">
                        <span class="chip bg-color">java</span>
                    </a>
                    
                    <a href="/tags/SpringBoot/">
                        <span class="chip bg-color">SpringBoot</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('60')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 毛毛的博客<br />'
            + '文章作者: 毛毛<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('2'),
            headingSelector: 'h2, h3, h4, H5, H6'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4, H5, H6').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
  
  <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

  
  <div class="container row center-align"
    style="margin-bottom: 0px !important;">
    <div class="col s12 m8 l8 copy-right">
      Copyright&nbsp;&copy;
      
      <span id="year">2019-2021</span>
      
      <span id="year">2019</span>
      <a href="/about" target="_blank">毛毛</a>
      <!-- |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
      |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a> -->
      <br>
      
      
      
      
      
      
      <span id="busuanzi_container_site_pv">
        |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
          class="white-color"></span>&nbsp;次
      </span>
      
      
      <span id="busuanzi_container_site_uv">
        |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
          class="white-color"></span>&nbsp;人
      </span>
      
      <br>
      
      <br>
      
    </div>
    <div class="col s12 m4 l4 social-link social-statis">
  <!-- https://github.com/maolovecoding -->
    <a href="https://github.com/maolovecoding/" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto: 1339065735@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>


<!-- 

 -->


    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1339065735" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1339065735" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>

<!-- 
 -->

<!--  -->


    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
  </div>
</footer>

<div class="progress-bar"></div>

    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
